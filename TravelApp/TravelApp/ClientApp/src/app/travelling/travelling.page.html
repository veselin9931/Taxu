<ion-content padding *ngIf="orderStatus == 'Waiting' || orderStatus == 'Completed' || orderStatus == null">
    <ion-header>
        <ion-toolbar>
            <ion-buttons slot="start">
                <ion-menu-button></ion-menu-button>
            </ion-buttons>


            <ion-title>
                <ion-label>TaxiMi</ion-label>
            </ion-title>

            <ion-buttons slot="end">
                <ion-icon id="toolbarIcon" name="language-outline"></ion-icon>
            </ion-buttons>
        </ion-toolbar>
    </ion-header>
    <div class="row mt-2">
        <div class="col">
            <ion-text>
                <div class="row">
                    <form [formGroup]="form" novalidate class="col">
                        <ion-text class="text-center" color="light">
                            <hr>
                            <h5 class="text">Additional options</h5>
                          </ion-text>
                        <div class="form-group col mt-1">
                            <ion-list *ngIf="isCompleted == false">
                                <ion-item>
                                    <ion-label color="light" class="fonted">With pets</ion-label>
                                    <ion-checkbox  color="light" slot="start" formControlName="withPets"
                                        [disabled]="this.form.value.withPets == true" class="form-group"></ion-checkbox>
                                </ion-item>

                                <ion-item>
                                    <ion-label color="light" class="fonted">With stroller</ion-label>
                                    <ion-checkbox color="light" slot="start" formControlName="withStroller"
                                        [disabled]="this.form.value.withStroller == true" class="form-group">
                                    </ion-checkbox>
                                </ion-item>

                                <ion-item>
                                    <ion-label color="light" class="fonted">Special needs</ion-label>
                                    <ion-checkbox color="light" slot="start" formControlName="special"
                                        [disabled]="this.form.value.special == true" class="form-group"></ion-checkbox>
                                </ion-item>
                            </ion-list>
                        </div>

                        <div class="form-group col mt-5">
                            <ion-input formControlName="location" type="text" class="form-control"
                                placeholder="Choose starting location" (click)="locationMap()"
                                [ngClass]="{ 'is-invalid': isSubmitted && f.location.errors }"></ion-input>
                            <div *ngIf="isSubmitted && f.location.errors" class="invalid-feedback">
                                <div *ngIf="f.location.errors.required" class="fonted">Please choose starting point.</div>
                            </div>
                        </div>

                        <div class="form-group col mt-3">
                            <ion-input formControlName="destination" type="text" class="form-control"
                                placeholder="Choose destination" (click)="destinationMap()"
                                [ngClass]="{ 'is-invalid': isSubmitted && f.destination.errors }"></ion-input>
                            <div *ngIf="isSubmitted && f.destination.errors" class="invalid-feedback">
                                <div *ngIf="f.destination.errors.required" class="fonted">Please choose endpoint.</div>
                            </div>
                        </div>


                        <div *ngIf="orderStatus == 'Waiting'" class="form-group col mt-3">
                            <ion-label><i>Increase amount</i></ion-label>
                            <ion-select ngModel (ngModelChange)="selector($event)" formControlName="increasePrice"
                                placeholder="Select amount you want to increase">
                                <ion-select-option value="1">1</ion-select-option>
                                <ion-select-option value="2">2</ion-select-option>
                                <ion-select-option value="3">3</ion-select-option>
                                <ion-select-option value="4">4</ion-select-option>
                                <ion-select-option value="5">5</ion-select-option>
                                <ion-select-option value="6">6</ion-select-option>
                                <ion-select-option value="7">7</ion-select-option>
                                <ion-select-option value="8">8</ion-select-option>
                                <ion-select-option value="9">9</ion-select-option>
                                <ion-select-option value="10">10</ion-select-option>

                            </ion-select>

                        </div>

                            <div class="row text-center">
                                <div class="col-md-12">
                                   
                                    <ion-button *ngIf="isCompleted == false" (click)="onSubmit()" class="fonted" color="light"> 
                                        Find
                                    </ion-button>
                                </div>
                                <div class="col-md-12">
                                    <ion-button *ngIf="isCompleted == true" class="fonted" color="light"> Cost: {{orderTotalPrice}}$</ion-button>
                                </div>
                                <div class="col-md-12">
                                    <ion-button  *ngIf="isCompleted == true" class="fonted" (click)="cancelOrder()"
                                        color="danger">Cancel</ion-button>
                                </div>
                            </div>
                    </form>

                    <div *ngIf="isCompleted == true" class="blink_me col-md-12 mt-3 text-center fonted">
                        <ion-button type="submit" color="light">Looking for a driver</ion-button>
                    </div>
                </div>
            </ion-text>
        </div>
    </div>
</ion-content>



<ion-content padding class="noScroll" *ngIf="orderStatus == 'Accepted' && order != null">
    <ion-header>
        <ion-toolbar>
            <ion-buttons slot="start">
                <ion-menu-button></ion-menu-button>
            </ion-buttons>


            <ion-title>
                <ion-label class="blink_me">Waiting for the car</ion-label>
            </ion-title>

            <ion-buttons slot="end">
                <ion-icon id="toolbarIcon" name="language-outline"></ion-icon>
            </ion-buttons>
        </ion-toolbar>
    </ion-header>
    <div #map id="map"></div>
</ion-content>

<ion-footer class="ion-no-border" *ngIf="orderStatus == 'Accepted' && order != null">
    <ion-toolbar class="text-center">
        <ion-text class="textTravel">
            Your driver {{firstName}} {{lastName}}
            will arrive with {{carColor}} {{carModel}} in about {{estimatedDuration}}

        </ion-text>
    </ion-toolbar>
</ion-footer>

<ion-footer class="ion-no-border" *ngIf="orderStatus == 'Accepted' && order != null">
    <ion-toolbar class="text-center">
        <ion-title class="fonted">Your destination</ion-title>
        <ion-label class="fonted">{{destination}}</ion-label>
        <ion-toolbar class="text-center">
            <ion-button class="fonted" (click)="addToFavourite()" type="submit" color="light">
                Add to favourites
            </ion-button>
            <ion-button (click)="chat()" class="fonted" (click)="clearMessages()" type="submit" color="light">
                Chat</ion-button>
                <br />
        <ion-label class="blink_me fonted" *ngIf="messages.length != 0  && chatStyle == 'none'">You have new message.</ion-label>
        </ion-toolbar>
        
    </ion-toolbar>

    <div id="chat" style="display: none;" class="row chat">
            
        <div class="col">
          <ion-card>
              
              <div class="msg-box">
                <ul *ngIf="this.msgInboxArray.length == 0" class="text-center mr-5">
                    <li class="fonted">No messages for now</li>
                  </ul>
                <ul *ngFor="let mObj of msgInboxArray">
                  <li class="fonted" [ngClass]="mObj.user === msgDto.user ? 'in-msg' : 'ex-msg'">
                    {{mObj.user}}:  
                    {{mObj.text}}
                </li>
                  
                </ul>
              </div>
          </ion-card>
    
          <ion-card class="type">
            <ion-item >
              <ion-input  [(ngModel)]="msgDto.text" placeholder="Type your message...">
    
              </ion-input>
                <ion-icon (click)="send()" name="send-outline"></ion-icon>
           
            </ion-item>
          </ion-card>
        </div>
        
      </div>
</ion-footer>