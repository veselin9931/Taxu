(self.webpackChunkcsharpcornerauthor=self.webpackChunkcsharpcornerauthor||[]).push([[54],{54:function(e,t,o){"use strict";o.r(t),o.d(t,{CarRegisterPageModule:function(){return J},HttpLoaderFactory:function(){return U}});var i=o(8583),r=o(3679),n=o(7823),c=o(4481),s=o(4762),l=o(1841),a=o(4426),u=o(2340),d=o(6522),g=o(3018),p=o(1799),Z=o(5056),f=o(292),h=o(7800);function m(e,t){1&e&&(g.TgZ(0,"div"),g._uU(1),g.ALo(2,"translate"),g.qZA()),2&e&&(g.xp6(1),g.hij("",g.lcZ(2,1,"The field is required"),"!"))}function v(e,t){if(1&e&&(g.TgZ(0,"div",35),g.YNc(1,m,3,3,"div",36),g.qZA()),2&e){const e=g.oxw();g.xp6(1),g.Q6J("ngIf",e.f.model.errors.required)}}function A(e,t){1&e&&(g.TgZ(0,"div"),g._uU(1),g.ALo(2,"translate"),g.qZA()),2&e&&(g.xp6(1),g.hij("",g.lcZ(2,1,"The field is required"),"!"))}function q(e,t){if(1&e&&(g.TgZ(0,"div",35),g.YNc(1,A,3,3,"div",36),g.qZA()),2&e){const e=g.oxw();g.xp6(1),g.Q6J("ngIf",e.f.color.errors.required)}}function b(e,t){1&e&&(g.TgZ(0,"div"),g._uU(1),g.ALo(2,"translate"),g.qZA()),2&e&&(g.xp6(1),g.hij("",g.lcZ(2,1,"The field is required"),"!"))}function T(e,t){if(1&e&&(g.TgZ(0,"div",35),g.YNc(1,b,3,3,"div",36),g.qZA()),2&e){const e=g.oxw();g.xp6(1),g.Q6J("ngIf",e.f.capacity.errors.required)}}function x(e,t){1&e&&(g.TgZ(0,"div"),g._uU(1),g.ALo(2,"translate"),g.qZA()),2&e&&(g.xp6(1),g.hij("",g.lcZ(2,1,"The field is required"),"!"))}function C(e,t){if(1&e&&(g.TgZ(0,"div",35),g.YNc(1,x,3,3,"div",36),g.qZA()),2&e){const e=g.oxw();g.xp6(1),g.Q6J("ngIf",e.f.registrationNumber.errors.required)}}function y(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"ion-item"),g.TgZ(1,"a",37),g.TgZ(2,"p"),g._UZ(3,"img",38),g.qZA(),g.TgZ(4,"div",39),g._UZ(5,"h5",40),g.TgZ(6,"button",41),g.NdJ("click",function(){g.CHM(e);const o=t.$implicit;return g.oxw().removePicture(o.id)}),g._uU(7),g.ALo(8,"translate"),g.qZA(),g.qZA(),g.qZA(),g.qZA()}if(2&e){const e=t.$implicit;g.xp6(3),g.s9C("src",e.path,g.LSH),g.xp6(4),g.hij(" ",g.lcZ(8,2,"Delete"),"")}}const k=function(e){return{"is-invalid":e}},N=[{path:"",component:(()=>{class e{constructor(e,t,o,i,r,n,c,s,l){this.route=e,this.formBuilder=t,this.driverService=o,this.accountService=i,this.location=r,this.imageService=n,this.alertController=c,this.popoverController=s,this.translate=l,this.submitted=!1,this.loading=!1,this.folderName="driverFacePic",this.imgType="carImg",this.translate.setDefaultLang(this.accountService.userValue.choosenLanguage),this.userId=this.accountService.userValue.id}ngOnInit(){this.getDocs(),this.form=this.formBuilder.group({model:["",r.kI.required],registrationNumber:["",r.kI.required],color:["",r.kI.required],capacity:["",r.kI.required],driverId:[""],type:[""]});const e=(new a.su).configureLogging(a.in.Information).withUrl(`${u.N.signalRUrl}/orderHub`).build();e.start().then(function(){console.log("signalR Connected in menu")}).catch(function(t){console.log("Reconnecting in 1 sec."),setTimeout(()=>e.start(),1e3)}),e.on("OnUpload",e=>{this.getDocs()})}ionViewDidEnter(){}get f(){return this.form.controls}getDocs(){this.imageService.getUserCarPictures(this.userId).subscribe(e=>{this.pics=e,console.log(this.pics)})}removePicture(e){this.picDelete(e)}onSubmit(){this.submitted=!0,this.form.valid&&(4!=this.pics.length?this.notEnoughImages():this.accountService.getById(this.userId).subscribe(e=>{this.form.value.driverId=e.driverId,this.form.value.type=+this.form.value.type,this.driverService.createCar(this.form.value).subscribe(t=>{this.clearForm(),this.driverService.getDriverCars(e.driverId).subscribe(e=>{this.route.navigateByUrl("menu/verifying")})})}))}upload(e){if(0===e.length)return;let t=e[0];const o=new FormData;o.append("file",t,t.name),this.imageService.upload(o,this.folderName,this.userId,this.imgType).subscribe(e=>{switch(e.type===l.dt.UploadProgress?this.progress=Math.round(100*e.loaded/e.total):e.type===l.dt.Response&&(this.message="Documents uploaded successfully."),e.type){case l.dt.Sent:console.log("Request has been made!");break;case l.dt.ResponseHeader:console.log("Response header has been received!");break;case l.dt.UploadProgress:this.progress=Math.round(e.loaded/e.total*100);break;case l.dt.Response:setTimeout(()=>{this.progress=0},1500)}})}goBack(){this.location.back()}openLanguagePopover(e){return(0,s.mG)(this,void 0,void 0,function*(){const t=yield this.popoverController.create({component:d.m,event:e});yield t.present()})}notEnoughImages(){return(0,s.mG)(this,void 0,void 0,function*(){this.translate.get(["You have to upload 4 document pictures."]).subscribe(e=>(0,s.mG)(this,void 0,void 0,function*(){const t=yield this.alertController.create({header:e["You have to upload 4 document pictures."],buttons:[{text:"Ok",role:"Ok"}]});yield t.present()}))})}picDelete(e){return(0,s.mG)(this,void 0,void 0,function*(){this.translate.get(["Delete the picture?","Yes","No"]).subscribe(t=>(0,s.mG)(this,void 0,void 0,function*(){const o=yield this.alertController.create({header:t["Delete the picture?"],buttons:[{text:t.Yes,handler:()=>{this.imageService.removeDocument(e).subscribe(e=>{console.log("Image removed sucessfully")})}},{text:t.No,role:"no"}]});yield o.present()}))})}clearForm(){this.form.reset({model:"",tehnicalReview:"",registrationNumber:"",color:"",capacity:""})}}return e.\u0275fac=function(t){return new(t||e)(g.Y36(c.F0),g.Y36(r.qu),g.Y36(p.F),g.Y36(Z.B),g.Y36(i.Ye),g.Y36(f.A),g.Y36(n.Br),g.Y36(n.Dh),g.Y36(h.sK))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-car-register"]],decls:97,vars:60,consts:[["slot","start"],["slot","end"],["id","toolbarIcon","name","language-outline",3,"click"],["padding","",1,"background"],[1,"row","mt-2"],[1,"col"],[1,"row"],[1,"col","text-center"],["color","dark",1,"centered"],[1,"text"],["novalidate","",1,"col-md-6","mt-1",3,"formGroup"],[1,"form-group","col","text-center"],["formControlName","model","type","text",1,"form-control",3,"placeholder","ngClass"],["class","invalid-feedback",4,"ngIf"],["formControlName","type","id","exampleFormControlSelect1",1,"form-control"],["value","","disabled","","selected","","hidden",""],["value","1"],["value","2"],["formControlName","color","type","text",1,"form-control",3,"placeholder","ngClass"],["formControlName","capacity","type","number",1,"form-control",3,"placeholder","ngClass"],["formControlName","registrationNumber","type","text",1,"form-control",3,"placeholder","ngClass"],[1,"text","mb-3"],[1,"input-group","text-left"],[1,"input-group","mb-1"],["type","text",1,"form-control"],[1,"input-group-append"],["type","file","placeholder","Choose file",2,"display","none",3,"change"],["file1",""],["name","add-outline","color","dark",3,"click"],["file2",""],["file3",""],["file4",""],[4,"ngFor","ngForOf"],[1,"col-md-12","mt-3"],["type","submit",1,"btn","btn-info",3,"click"],[1,"invalid-feedback"],[4,"ngIf"],[1,"text","list-group-item","list-group-item-action","flex-column","align-items-start"],[3,"src"],[1,"text-center"],[1,"mb-1","fonted"],[1,"btn","btn-danger",3,"click"]],template:function(e,t){if(1&e){const e=g.EpF();g.TgZ(0,"ion-header"),g.TgZ(1,"ion-toolbar"),g.TgZ(2,"ion-buttons",0),g._UZ(3,"ion-menu-button"),g.qZA(),g.TgZ(4,"ion-title"),g.TgZ(5,"ion-label"),g._uU(6,"Cyber"),g.qZA(),g.qZA(),g.TgZ(7,"ion-buttons",1),g.TgZ(8,"ion-icon",2),g.NdJ("click",function(e){return t.openLanguagePopover(e)}),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(9,"ion-content",3),g.TgZ(10,"div",4),g.TgZ(11,"div",5),g.TgZ(12,"div",6),g.TgZ(13,"div",7),g.TgZ(14,"ion-text",8),g.TgZ(15,"h3",9),g._uU(16),g.ALo(17,"translate"),g.qZA(),g._UZ(18,"hr"),g.qZA(),g.TgZ(19,"form",10),g.TgZ(20,"div",11),g._UZ(21,"ion-input",12),g.ALo(22,"translate"),g.YNc(23,v,2,1,"div",13),g.qZA(),g.TgZ(24,"div",11),g.TgZ(25,"select",14),g.TgZ(26,"option",15),g._uU(27),g.ALo(28,"translate"),g.qZA(),g.TgZ(29,"option",16),g._uU(30),g.ALo(31,"translate"),g.qZA(),g.TgZ(32,"option",17),g._uU(33),g.ALo(34,"translate"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(35,"div",11),g._UZ(36,"ion-input",18),g.ALo(37,"translate"),g.YNc(38,q,2,1,"div",13),g.qZA(),g.TgZ(39,"div",11),g._UZ(40,"ion-input",19),g.ALo(41,"translate"),g.YNc(42,T,2,1,"div",13),g.qZA(),g.TgZ(43,"div",11),g._UZ(44,"ion-input",20),g.ALo(45,"translate"),g.YNc(46,C,2,1,"div",13),g.qZA(),g.TgZ(47,"h5",21),g._uU(48),g.ALo(49,"translate"),g.qZA(),g.TgZ(50,"div",22),g.TgZ(51,"div",23),g.TgZ(52,"label",24),g._uU(53),g.ALo(54,"translate"),g.qZA(),g.TgZ(55,"div",25),g.TgZ(56,"span"),g.TgZ(57,"input",26,27),g.NdJ("change",function(){g.CHM(e);const o=g.MAs(58);return t.upload(o.files)}),g.qZA(),g.TgZ(59,"label"),g.TgZ(60,"ion-icon",28),g.NdJ("click",function(){return g.CHM(e),g.MAs(58).click()}),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(61,"div",23),g.TgZ(62,"label",24),g._uU(63),g.ALo(64,"translate"),g.qZA(),g.TgZ(65,"div",25),g.TgZ(66,"span"),g.TgZ(67,"input",26,29),g.NdJ("change",function(){g.CHM(e);const o=g.MAs(68);return t.upload(o.files)}),g.qZA(),g.TgZ(69,"label"),g.TgZ(70,"ion-icon",28),g.NdJ("click",function(){return g.CHM(e),g.MAs(68).click()}),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(71,"div",23),g.TgZ(72,"label",24),g._uU(73),g.ALo(74,"translate"),g.qZA(),g.TgZ(75,"div",25),g.TgZ(76,"span"),g.TgZ(77,"input",26,30),g.NdJ("change",function(){g.CHM(e);const o=g.MAs(78);return t.upload(o.files)}),g.qZA(),g.TgZ(79,"label"),g.TgZ(80,"ion-icon",28),g.NdJ("click",function(){return g.CHM(e),g.MAs(78).click()}),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(81,"div",23),g.TgZ(82,"label",24),g._uU(83),g.ALo(84,"translate"),g.qZA(),g.TgZ(85,"div",25),g.TgZ(86,"span"),g.TgZ(87,"input",26,31),g.NdJ("change",function(){g.CHM(e);const o=g.MAs(88);return t.upload(o.files)}),g.qZA(),g.TgZ(89,"label"),g.TgZ(90,"ion-icon",28),g.NdJ("click",function(){return g.CHM(e),g.MAs(88).click()}),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(91,"ion-list"),g.YNc(92,y,9,4,"ion-item",32),g.qZA(),g.TgZ(93,"div",33),g.TgZ(94,"button",34),g.NdJ("click",function(){return t.onSubmit()}),g._uU(95),g.ALo(96,"translate"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA()}2&e&&(g.xp6(16),g.Oqu(g.lcZ(17,24,"Car information")),g.xp6(3),g.Q6J("formGroup",t.form),g.xp6(2),g.Q6J("placeholder",g.lcZ(22,26,"Model"))("ngClass",g.VKq(52,k,t.submitted&&t.f.model.errors)),g.xp6(2),g.Q6J("ngIf",t.submitted&&t.f.model.errors),g.xp6(4),g.Oqu(g.lcZ(28,28,"Click to choose car type")),g.xp6(3),g.Oqu(g.lcZ(31,30,"Normal")),g.xp6(3),g.Oqu(g.lcZ(34,32,"Comfort")),g.xp6(3),g.Q6J("placeholder",g.lcZ(37,34,"Color"))("ngClass",g.VKq(54,k,t.submitted&&t.f.color.errors)),g.xp6(2),g.Q6J("ngIf",t.submitted&&t.f.color.errors),g.xp6(2),g.Q6J("placeholder",g.lcZ(41,36,"Capacity"))("ngClass",g.VKq(56,k,t.submitted&&t.f.capacity.errors)),g.xp6(2),g.Q6J("ngIf",t.submitted&&t.f.capacity.errors),g.xp6(2),g.Q6J("placeholder",g.lcZ(45,38,"Registration Number"))("ngClass",g.VKq(58,k,t.submitted&&t.f.registrationNumber.errors)),g.xp6(2),g.Q6J("ngIf",t.submitted&&t.f.registrationNumber.errors),g.xp6(2),g.hij("",g.lcZ(49,40,"Please upload pictures of the following documents"),":"),g.xp6(5),g.hij("1. ",g.lcZ(54,42,"Front car picture"),""),g.xp6(10),g.hij("2. ",g.lcZ(64,44,"Rear car picture"),""),g.xp6(10),g.hij("3. ",g.lcZ(74,46,"Car insurance picture"),""),g.xp6(10),g.hij("4. ",g.lcZ(84,48,"Technical review picture"),""),g.xp6(9),g.Q6J("ngForOf",t.pics),g.xp6(3),g.Oqu(g.lcZ(96,50,"Submit")))},directives:[n.Gu,n.sr,n.Sm,n.fG,n.wd,n.Q$,n.gu,n.W2,n.yW,r.Y7,r.JL,r.sg,n.pK,n.j9,r.JJ,r.u,i.mk,i.O5,r.EJ,r.YN,r.$B,n.as,n.q_,i.sg,n.Ie],pipes:[h.X$],styles:["ion-content[_ngcontent-%COMP%]{--ion-background-color:#e9e9e9}ion-toolbar[_ngcontent-%COMP%]{--ion-background-color:#eee}ion-title[_ngcontent-%COMP%]{text-align:center}#toolbarIcon[_ngcontent-%COMP%]{font-size:1.7em}.text[_ngcontent-%COMP%]{font-family:Open Sans Light}.centered[_ngcontent-%COMP%]{text-align:center}hr[_ngcontent-%COMP%]{width:70%!important}label[_ngcontent-%COMP%]{border:1px solid #ccc;padding:8px 15px;cursor:pointer}.backIcon[_ngcontent-%COMP%]{font-size:150%}.back[_ngcontent-%COMP%], .backIcon[_ngcontent-%COMP%]{color:#ffae00}"]}),e})()}];let _=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.oAB({type:e}),e.\u0275inj=g.cJS({imports:[[c.Bz.forChild(N)],c.Bz]}),e})();var I=o(2472),M=o(3577);function U(e){return new I.w(e)}let J=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.oAB({type:e}),e.\u0275inj=g.cJS({imports:[[i.ez,r.u5,n.Pc,_,r.UX,h.aw.forChild({loader:{provide:h.Zw,useFactory:U,deps:[l.eN]}}),M.LanguagePopoverPageModule]]}),e})()}}]);