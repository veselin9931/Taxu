!function(){function e(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function r(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function t(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"8k+r":function(r,n,o){"use strict";o.d(n,"a",function(){return h});var a=o("z6cu"),i=o("JIr8"),c=o("vkgz"),s=o("AytR"),d=o("fXoL"),p=o("tk/3"),u=o("Dsd+"),h=function(){var r=function(){function r(t,n){e(this,r),this.http=t,this.sharedService=n,this.orders=[],this.completedOrder=!1}return t(r,[{key:"createOrder",value:function(e){var r=this.sharedService.headerGerneration();return this.http.post("".concat(s.a.apiUrl,"/api/order"),e,{headers:r,responseType:"text"}).pipe(Object(i.a)(this.handleError))}},{key:"addToFavourites",value:function(e){var r=this.sharedService.headerGerneration();return this.http.post("".concat(s.a.apiUrl,"/api/order/favourites"),e,{headers:r,responseType:"text"}).pipe(Object(i.a)(this.handleError))}},{key:"getMyFavourites",value:function(e){var r=this.sharedService.headerGerneration();return this.http.get("".concat(s.a.apiUrl,"/api/order/favourites/").concat(e),{headers:r}).pipe(Object(i.a)(this.handleError))}},{key:"deleteFavouriteOrder",value:function(e){var r=this.sharedService.headerGerneration();return this.http.delete("".concat(s.a.apiUrl,"/api/order/favourites/").concat(e),{headers:r}).pipe(Object(c.a)(function(e){return console.log("deleted favourite order: ",JSON.stringify(e))}),Object(i.a)(this.handleError))}},{key:"getDirections",value:function(e,r,t,n){var o=this.sharedService.headerGerneration();return this.http.post("https://maps.googleapis.com/maps/api/distancematrix/json?units=imperial&origins=".concat(e,",").concat(r,"&destinations=").concat(t,"%2C").concat(n,"%7C&key=AIzaSyAEvlXdM4joG4bNVT5l-tJSk9lUSGhxMNw"),{headers:o,responseType:"text"}).pipe(Object(i.a)(this.handleError))}},{key:"getOrderById",value:function(e){var r=this,t=this.sharedService.headerGerneration();return this.http.get("".concat(s.a.apiUrl,"/api/order/id/").concat(e),{headers:t}).pipe(Object(c.a)(function(e){return r.order=e}))}},{key:"getCanceledOrderById",value:function(e){var r=this,t=this.sharedService.headerGerneration();return this.http.get("".concat(s.a.apiUrl,"/api/order/canceled/").concat(e),{headers:t}).pipe(Object(c.a)(function(e){return r.order=e}))}},{key:"getLastCompletedOrder",value:function(e){var r=this.sharedService.headerGerneration();return this.http.get("".concat(s.a.apiUrl,"/api/order/completed/").concat(e),{headers:r}).pipe(Object(i.a)(this.handleError))}},{key:"getMyOrder",value:function(e){var r=this.sharedService.headerGerneration();return this.http.get("".concat(s.a.apiUrl,"/api/order/").concat(e),{headers:r}).pipe(Object(i.a)(this.handleError))}},{key:"getOrderForChat",value:function(e){var r=this.sharedService.headerGerneration();return this.http.get("".concat(s.a.apiUrl,"/api/order/chat/").concat(e),{headers:r}).pipe(Object(i.a)(this.handleError))}},{key:"getAllOrders",value:function(){var e=this.sharedService.headerGerneration();return this.http.get("".concat(s.a.apiUrl,"/api/order"),{headers:e}).pipe(Object(i.a)(this.handleError))}},{key:"getNormalOrders",value:function(){var e=this.sharedService.headerGerneration();return this.http.get("".concat(s.a.apiUrl,"/api/order/normal"),{headers:e}).pipe(Object(i.a)(this.handleError))}},{key:"getComfortOrders",value:function(){var e=this.sharedService.headerGerneration();return this.http.get("".concat(s.a.apiUrl,"/api/order/comfort"),{headers:e}).pipe(Object(i.a)(this.handleError))}},{key:"acceptOrder",value:function(e,r){var t=this,n=this.sharedService.headerGerneration();return this.http.put("".concat(s.a.apiUrl,"/api/order/").concat(e,"/").concat(r),{headers:n,responseType:"json"}).pipe(Object(c.a)(function(e){return t.driverId=r}),Object(i.a)(this.handleError))}},{key:"updateOrderEta",value:function(e,r){var t=this.sharedService.headerGerneration();return this.http.put("".concat(s.a.apiUrl,"/api/order/eta/").concat(e,"/").concat(r),{headers:t,responseType:"json"}).pipe(Object(i.a)(this.handleError))}},{key:"updateDriverArrived",value:function(e){var r=this.sharedService.headerGerneration();return this.http.put("".concat(s.a.apiUrl,"/api/order/arrived/").concat(e),{headers:r,responseType:"json"}).pipe(Object(i.a)(this.handleError))}},{key:"rateOrder",value:function(e){var r=this.sharedService.headerGerneration();return this.http.put("".concat(s.a.apiUrl,"/api/order/rate/").concat(e),{headers:r,responseType:"json"}).pipe(Object(i.a)(this.handleError))}},{key:"increaseOrderPrice",value:function(e,r){var t=this.sharedService.headerGerneration();return this.http.put("".concat(s.a.apiUrl,"/api/order/increase/").concat(e,"/").concat(r),{headers:t,responseType:"json"}).pipe(Object(i.a)(this.handleError))}},{key:"completeOrder",value:function(e){var r=this.sharedService.headerGerneration();return this.http.put("".concat(s.a.apiUrl,"/api/order/").concat(e),{headers:r,responseType:"json"}).pipe(Object(i.a)(this.handleError))}},{key:"deleteOrder",value:function(e){var r=this.sharedService.headerGerneration();return this.http.delete("".concat(s.a.apiUrl,"/api/order/").concat(e),{headers:r}).pipe(Object(c.a)(function(e){return console.log("deleted order: ",JSON.stringify(e))}),Object(i.a)(this.handleError))}},{key:"driverIncreaseOrderPrice",value:function(e,r,t){var n=this.sharedService.headerGerneration();return this.http.put("".concat(s.a.apiUrl,"/api/order/increased/").concat(e,"/").concat(r,"/").concat(t),{headers:n,responseType:"json"}).pipe(Object(i.a)(this.handleError))}},{key:"resetIncreasing",value:function(e){var r=this.sharedService.headerGerneration();return this.http.put("".concat(s.a.apiUrl,"/api/order/reset/").concat(e),{headers:r,responseType:"json"}).pipe(Object(i.a)(this.handleError))}},{key:"increasedOrderAccept",value:function(e,r){var t=this.sharedService.headerGerneration();return this.http.put("".concat(s.a.apiUrl,"/api/order/accepted/increase/").concat(e,"/").concat(r),{headers:t,responseType:"json"}).pipe(Object(i.a)(this.handleError))}},{key:"incrementOrderPrice",value:function(e){var r=this.sharedService.headerGerneration();return this.http.put("".concat(s.a.apiUrl,"/api/order/increment/").concat(e),{headers:r,responseType:"json"}).pipe(Object(i.a)(this.handleError))}},{key:"decrementOrderPrice",value:function(e){var r=this.sharedService.headerGerneration();return this.http.put("".concat(s.a.apiUrl,"/api/order/decrement/").concat(e),{headers:r,responseType:"json"}).pipe(Object(i.a)(this.handleError))}},{key:"handleError",value:function(e){var r="";return e.error instanceof ErrorEvent?(console.log("Client side error."),r="Error: ".concat(e.error.message)):(console.log("Server side error."),r="Error Code: ".concat(e.status,"\nMessage: ").concat(e.message)),console.log(r),Object(a.a)(r)}}]),r}();return r.\u0275fac=function(e){return new(e||r)(d.Rb(p.a),d.Rb(u.a))},r.\u0275prov=d.Gb({token:r,factory:r.\u0275fac,providedIn:"root"}),r}()},LVab:function(r,n,o){"use strict";o.r(n),o.d(n,"HttpLoaderFactory",function(){return R}),o.d(n,"ReportPageModule",function(){return Y});var a,i=o("ofXK"),c=o("3Pt+"),s=o("TEn/"),d=o("tyNb"),p=o("mrSG"),u=o("oXKM"),h=o("fXoL"),l=o("z6cu"),b=o("JIr8"),v=o("AytR"),f=o("tk/3"),m=o("Dsd+"),g=((a=function(){function r(t,n){e(this,r),this.http=t,this.sharedService=n}return t(r,[{key:"createReport",value:function(e){var r=this.sharedService.headerGerneration();return this.http.post("".concat(v.a.apiUrl,"/api/report"),e,{headers:r,responseType:"text"}).pipe(Object(b.a)(this.handleError))}},{key:"handleError",value:function(e){var r="";return e.error instanceof ErrorEvent?(console.log("Client side error."),r="Error: ".concat(e.error.message)):(console.log("Server side error."),r="Error Code: ".concat(e.status,"\nMessage: ").concat(e.message)),console.log(r),Object(l.a)(r)}}]),r}()).\u0275fac=function(e){return new(e||a)(h.Rb(f.a),h.Rb(m.a))},a.\u0275prov=h.Gb({token:a,factory:a.\u0275fac,providedIn:"root"}),a),y=o("exMm"),O=o("8Xdb"),k=o("8k+r"),I=o("sYmb");function M(e,r){1&e&&(h.Nb(0,"div"),h.pc(1),h.Yb(2,"translate"),h.Mb()),2&e&&(h.zb(1),h.rc("",h.Zb(2,1,"The field is required"),"!"))}function S(e,r){if(1&e&&(h.Nb(0,"div",25),h.oc(1,M,3,3,"div",26),h.Mb()),2&e){var t=h.Xb();h.zb(1),h.dc("ngIf",t.f.typeId.errors.required)}}function N(e,r){if(1&e&&(h.Nb(0,"div",27),h.Nb(1,"ion-text",8),h.Nb(2,"h4",9),h.pc(3),h.Yb(4,"translate"),h.Mb(),h.Mb(),h.Lb(5,"ion-input",28),h.Mb()),2&e){var t=h.Xb();h.zb(3),h.qc(h.Zb(4,3,"Last user")),h.zb(2),h.fc("value","",t.userFirstName," ",t.userLastName,"")}}function j(e,r){1&e&&(h.Nb(0,"div"),h.pc(1),h.Yb(2,"translate"),h.Mb()),2&e&&(h.zb(1),h.rc("",h.Zb(2,1,"The field is required"),"!"))}function C(e,r){if(1&e&&(h.Nb(0,"div",29),h.oc(1,j,3,3,"div",26),h.Mb()),2&e){var t=h.Xb();h.zb(1),h.dc("ngIf",t.f.title.errors.required)}}function E(e,r){1&e&&(h.Nb(0,"div"),h.pc(1),h.Yb(2,"translate"),h.Mb()),2&e&&(h.zb(1),h.rc("",h.Zb(2,1,"The field is required"),"!"))}function x(e,r){if(1&e&&(h.Nb(0,"div",29),h.oc(1,E,3,3,"div",26),h.Mb()),2&e){var t=h.Xb();h.zb(1),h.dc("ngIf",t.f.description.errors.required)}}var G,U,z=function(e){return{"is-invalid":e}},T=[{path:"",component:(G=function(){function r(t,n,o,a,i,c,s,d,p,u){e(this,r),this.reportService=t,this.route=n,this.formBuilder=o,this.driverService=a,this.accountService=i,this.location=c,this.orderService=s,this.alertController=d,this.translate=p,this.popoverController=u,this.subscriptions=[],this.submitted=!1,this.loading=!1,this.userId=this.accountService.userValue.id,this.translate.setDefaultLang(this.accountService.userValue.choosenLanguage)}return t(r,[{key:"ngOnInit",value:function(){this.form=this.formBuilder.group({title:["",c.n.required],description:["",c.n.required],reporterId:[""],suspectedUserId:[""],typeId:[""]})}},{key:"f",get:function(){return this.form.controls}},{key:"reportType",value:function(e){var r=this;this.selectedReportType=e,1==this.selectedReportType&&this.subscriptions.push(this.accountService.getById(this.userId).subscribe(function(e){r.isDriver=e.isDriver,r.subscriptions.push(e.isDriver?r.orderService.getLastCompletedOrder(r.userId).subscribe(function(e){r.lastOrder=e,r.subscriptions.push(r.accountService.getById(e.applicationUserId).subscribe(function(e){r.userFirstName=e.firstName,r.userLastName=e.lastName,r.suspectedUserId=r.lastOrder.applicationUserId,r.reporterId=r.userId}))}):r.orderService.getLastCompletedOrder(r.userId).subscribe(function(e){r.lastOrder=e,r.subscriptions.push(r.accountService.getById(e.acceptedBy).subscribe(function(e){r.userFirstName=e.firstName,r.userLastName=e.lastName,r.subscriptions.push(r.driverService.getDriverActiveCar(e.driverId).subscribe(function(t){r.carModel=t.model,r.form.value.typeId=+r.form.value.typeId,r.suspectedUserId=e.driverId,r.reporterId=r.userId}))}))}))}))}},{key:"onSubmit",value:function(){var e=this;this.submitted=!0,this.form.valid?(this.form.value.typeId=+this.form.value.typeId,1==this.form.value.typeId?(this.form.value.suspectedUserId=this.suspectedUserId,this.form.value.reporterId=this.reporterId,this.subscriptions.push(this.reportService.createReport(this.form.value).subscribe(function(r){console.log("report created:"),console.log(r),e.reportCompleted(),e.clearForm()}))):(this.form.value.reporterId=this.userId,this.subscriptions.push(this.reportService.createReport(this.form.value).subscribe(function(r){console.log("report created:"),console.log(r),e.reportCompleted(),e.clearForm()}))),console.log(this.form.value)):console.log("Please provide all the required values!")}},{key:"openLanguagePopover",value:function(e){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function r(){var t;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.popoverController.create({component:u.a,event:e});case 2:return t=r.sent,r.next=5,t.present();case 5:case"end":return r.stop()}},r,this)}))}},{key:"reportCompleted",value:function(){return Object(p.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.translate.get(["Report","Your report is sent successfully","Confirm"]).subscribe(function(e){return Object(p.a)(r,void 0,void 0,regeneratorRuntime.mark(function r(){var t,n=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.alertController.create({message:e["Your report is sent successfully"],buttons:[{text:e.Confirm,handler:function(){n.route.navigate(1==n.isDriver?["menu/driving"]:["menu/travelling"])}}]});case 2:return t=r.sent,r.next=5,t.present();case 5:case"end":return r.stop()}},r,this)}))});case 1:case"end":return e.stop()}},e,this)}))}},{key:"clearForm",value:function(){this.form.reset({title:"",description:"",typeId:"",suspectedDriverId:"",reporterId:""})}},{key:"goBack",value:function(){this.location.back()}}]),r}(),G.\u0275fac=function(e){return new(e||G)(h.Kb(g),h.Kb(d.f),h.Kb(c.b),h.Kb(y.a),h.Kb(O.a),h.Kb(i.h),h.Kb(k.a),h.Kb(s.a),h.Kb(I.d),h.Kb(s.H))},G.\u0275cmp=h.Eb({type:G,selectors:[["app-report"]],decls:51,vars:41,consts:[["slot","start"],["slot","end"],["id","toolbarIcon","name","language-outline",3,"click"],["padding","",1,"background"],[1,"row"],[1,"col"],[1,"row","mt-2"],[1,"col","text-center"],["color","dark",1,"centered"],[1,"text"],["novalidate","",1,"col-md-6",3,"formGroup"],[1,"form-group","col","mt-5","text-center"],["formControlName","typeId","id","exampleFormControlSelect1",1,"form-control","text",3,"ngClass","change"],["value","","disabled","","selected","","hidden",""],["value","1"],["value","2"],["value","3"],["class","invalid-feedback text",4,"ngIf"],["class","form-group col mt-5 text-center text",4,"ngIf"],[1,"form-group","col","mt-5"],["formControlName","title","type","text",1,"form-control","text",3,"placeholder","ngClass"],["class","invalid-feedback",4,"ngIf"],["formControlName","description","type","text",1,"form-control","text",3,"placeholder","ngClass"],[1,"col-md-12","mt-3"],["type","button","color","dark",1,"btn","btn-info",3,"click"],[1,"invalid-feedback","text"],[4,"ngIf"],[1,"form-group","col","mt-5","text-center","text"],[1,"form-control",3,"value"],[1,"invalid-feedback"]],template:function(e,r){1&e&&(h.Nb(0,"ion-header"),h.Nb(1,"ion-toolbar"),h.Nb(2,"ion-buttons",0),h.Lb(3,"ion-menu-button"),h.Mb(),h.Nb(4,"ion-title"),h.Nb(5,"ion-label"),h.pc(6),h.Yb(7,"translate"),h.Mb(),h.Mb(),h.Nb(8,"ion-buttons",1),h.Nb(9,"ion-icon",2),h.Vb("click",function(e){return r.openLanguagePopover(e)}),h.Mb(),h.Mb(),h.Mb(),h.Mb(),h.Nb(10,"ion-content",3),h.Nb(11,"div",4),h.Nb(12,"div",5),h.Lb(13,"div",6),h.Nb(14,"div",4),h.Nb(15,"div",7),h.Nb(16,"ion-text",8),h.Nb(17,"h2",9),h.pc(18),h.Yb(19,"translate"),h.Mb(),h.Lb(20,"hr"),h.Mb(),h.Nb(21,"form",10),h.Nb(22,"div",11),h.Nb(23,"select",12),h.Vb("change",function(e){return r.reportType(e.target.value)}),h.Nb(24,"option",13),h.pc(25),h.Yb(26,"translate"),h.Mb(),h.Nb(27,"option",14),h.pc(28),h.Yb(29,"translate"),h.Mb(),h.Nb(30,"option",15),h.pc(31),h.Yb(32,"translate"),h.Mb(),h.Nb(33,"option",16),h.pc(34),h.Yb(35,"translate"),h.Mb(),h.Mb(),h.oc(36,S,2,1,"div",17),h.Mb(),h.oc(37,N,6,5,"div",18),h.Nb(38,"div",19),h.Lb(39,"ion-input",20),h.Yb(40,"translate"),h.oc(41,C,2,1,"div",21),h.Mb(),h.Nb(42,"div",19),h.Nb(43,"textarea",22),h.Yb(44,"translate"),h.pc(45,"                "),h.Mb(),h.oc(46,x,2,1,"div",21),h.Mb(),h.Nb(47,"div",23),h.Nb(48,"button",24),h.Vb("click",function(){return r.onSubmit()}),h.pc(49),h.Yb(50,"translate"),h.Mb(),h.Mb(),h.Mb(),h.Mb(),h.Mb(),h.Mb(),h.Mb(),h.Mb()),2&e&&(h.zb(6),h.qc(h.Zb(7,17,"Report")),h.zb(12),h.qc(h.Zb(19,19,"Report a problem")),h.zb(3),h.dc("formGroup",r.form),h.zb(2),h.dc("ngClass",h.gc(35,z,r.submitted&&r.f.typeId.errors)),h.zb(2),h.qc(h.Zb(26,21,"Choose report type")),h.zb(3),h.qc(h.Zb(29,23,"Complaint")),h.zb(3),h.qc(h.Zb(32,25,"Technical")),h.zb(3),h.qc(h.Zb(35,27,"Other")),h.zb(2),h.dc("ngIf",r.submitted&&r.f.typeId.errors),h.zb(1),h.dc("ngIf",1==r.selectedReportType),h.zb(2),h.dc("placeholder",h.Zb(40,29,"Title"))("ngClass",h.gc(37,z,r.submitted&&r.f.title.errors)),h.zb(2),h.dc("ngIf",r.submitted&&r.f.title.errors),h.zb(2),h.dc("placeholder",h.Zb(44,31,"Description"))("ngClass",h.gc(39,z,r.submitted&&r.f.description.errors)),h.zb(3),h.dc("ngIf",r.submitted&&r.f.description.errors),h.zb(3),h.qc(h.Zb(50,33,"Submit")))},directives:[s.l,s.B,s.e,s.s,s.A,s.p,s.m,s.i,s.z,c.o,c.i,c.d,c.m,c.h,c.c,i.j,c.k,c.p,i.l,s.n,s.K,c.a],pipes:[I.c],styles:["ion-content[_ngcontent-%COMP%]{--ion-background-color:#e9e9e9}.centered[_ngcontent-%COMP%]{text-align:center}.text[_ngcontent-%COMP%]{font-family:Open Sans Light}hr[_ngcontent-%COMP%]{background:#eee;width:70%!important}.backIcon[_ngcontent-%COMP%]{font-size:150%}.back[_ngcontent-%COMP%], .backIcon[_ngcontent-%COMP%]{color:#ffae00}ion-toolbar[_ngcontent-%COMP%]{--ion-background-color:#eee}ion-title[_ngcontent-%COMP%]{text-align:center}#toolbarIcon[_ngcontent-%COMP%]{font-size:1.7em}"]}),G)}],w=((U=function r(){e(this,r)}).\u0275fac=function(e){return new(e||U)},U.\u0275mod=h.Ib({type:U}),U.\u0275inj=h.Hb({imports:[[d.h.forChild(T)],d.h]}),U),L=o("mqiu"),P=o("QhVT");function R(e){return new L.a(e)}var q,Y=((q=function r(){e(this,r)}).\u0275fac=function(e){return new(e||q)},q.\u0275mod=h.Ib({type:q}),q.\u0275inj=h.Hb({imports:[[i.b,c.e,s.C,w,c.l,I.b.forChild({loader:{provide:I.a,useFactory:R,deps:[f.a]}}),P.LanguagePopoverPageModule]]}),q)}}])}();