!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{vqOf:function(r,n,o){"use strict";o.r(n),o.d(n,"HttpLoaderFactory",function(){return j}),o.d(n,"CarRegisterPageModule",function(){return D});var i=o("ofXK"),c=o("3Pt+"),a=o("TEn/"),b=o("tyNb"),s=o("mrSG"),u=o("tk/3"),l=o("Gpoy"),d=o("AytR"),f=o("oXKM"),p=o("fXoL"),m=o("exMm"),v=o("8Xdb"),g=o("Jhu6"),h=o("sYmb");function M(e,t){1&e&&(p.Nb(0,"div"),p.pc(1),p.Yb(2,"translate"),p.Mb()),2&e&&(p.zb(1),p.rc("",p.Zb(2,1,"The field is required"),"!"))}function N(e,t){if(1&e&&(p.Nb(0,"div",35),p.oc(1,M,3,3,"div",36),p.Mb()),2&e){var r=p.Xb();p.zb(1),p.dc("ngIf",r.f.model.errors.required)}}function y(e,t){1&e&&(p.Nb(0,"div"),p.pc(1),p.Yb(2,"translate"),p.Mb()),2&e&&(p.zb(1),p.rc("",p.Zb(2,1,"The field is required"),"!"))}function k(e,t){if(1&e&&(p.Nb(0,"div",35),p.oc(1,y,3,3,"div",36),p.Mb()),2&e){var r=p.Xb();p.zb(1),p.dc("ngIf",r.f.color.errors.required)}}function C(e,t){1&e&&(p.Nb(0,"div"),p.pc(1),p.Yb(2,"translate"),p.Mb()),2&e&&(p.zb(1),p.rc("",p.Zb(2,1,"The field is required"),"!"))}function x(e,t){if(1&e&&(p.Nb(0,"div",35),p.oc(1,C,3,3,"div",36),p.Mb()),2&e){var r=p.Xb();p.zb(1),p.dc("ngIf",r.f.capacity.errors.required)}}function I(e,t){1&e&&(p.Nb(0,"div"),p.pc(1),p.Yb(2,"translate"),p.Mb()),2&e&&(p.zb(1),p.rc("",p.Zb(2,1,"The field is required"),"!"))}function w(e,t){if(1&e&&(p.Nb(0,"div",35),p.oc(1,I,3,3,"div",36),p.Mb()),2&e){var r=p.Xb();p.zb(1),p.dc("ngIf",r.f.registrationNumber.errors.required)}}function z(e,t){if(1&e){var r=p.Ob();p.Nb(0,"ion-item"),p.Nb(1,"a",37),p.Nb(2,"p"),p.Lb(3,"img",38),p.Mb(),p.Nb(4,"div",39),p.Lb(5,"h5",40),p.Nb(6,"button",41),p.Vb("click",function(){p.jc(r);var e=t.$implicit;return p.Xb().removePicture(e.id)}),p.pc(7),p.Yb(8,"translate"),p.Mb(),p.Mb(),p.Mb(),p.Mb()}if(2&e){var n=t.$implicit;p.zb(3),p.ec("src",n.path,p.lc),p.zb(4),p.rc(" ",p.Zb(8,2,"Delete"),"")}}var O,P,Y=function(e){return{"is-invalid":e}},R=[{path:"",component:(O=function(){function r(t,n,o,i,c,a,b,s,u){e(this,r),this.route=t,this.formBuilder=n,this.driverService=o,this.accountService=i,this.location=c,this.imageService=a,this.alertController=b,this.popoverController=s,this.translate=u,this.submitted=!1,this.loading=!1,this.folderName="driverFacePic",this.imgType="carImg",this.translate.setDefaultLang(this.accountService.userValue.choosenLanguage),this.userId=this.accountService.userValue.id}var n,o,i;return n=r,(o=[{key:"ngOnInit",value:function(){var e=this;this.getDocs(),this.form=this.formBuilder.group({model:["",c.n.required],registrationNumber:["",c.n.required],color:["",c.n.required],capacity:["",c.n.required],driverId:[""],type:[""]});var t=(new l.b).configureLogging(l.c.Information).withUrl("".concat(d.a.signalRUrl,"/orderHub")).build();t.start().then(function(){console.log("signalR Connected in menu")}).catch(function(e){console.log("Reconnecting in 1 sec."),setTimeout(function(){return t.start()},1e3)}),t.on("OnUpload",function(t){e.getDocs()})}},{key:"ionViewDidEnter",value:function(){this.clearCarImages()}},{key:"f",get:function(){return this.form.controls}},{key:"getDocs",value:function(){var e=this;this.imageService.getUserCarPictures(this.userId).subscribe(function(t){e.pics=t,console.log(e.pics)})}},{key:"removePicture",value:function(e){this.picDelete(e)}},{key:"clearCarImages",value:function(){var e=this;this.imageService.getUserCarPictures(this.userId).subscribe(function(t){e.pics=t,e.pics.length>0&&e.pics.forEach(function(t){e.imageService.removeDocument(t.id).subscribe(function(e){console.log("Image removed sucessfully")})})})}},{key:"onSubmit",value:function(){var e=this;this.submitted=!0,this.form.valid&&(4!=this.pics.length?this.notEnoughImages():this.accountService.getById(this.userId).subscribe(function(t){e.form.value.driverId=t.driverId,e.form.value.type=+e.form.value.type,e.driverService.createCar(e.form.value).subscribe(function(r){e.clearForm(),e.driverService.getDriverCars(t.driverId).subscribe(function(t){e.route.navigateByUrl("menu/verifying")})})}))}},{key:"upload",value:function(e){var t=this;if(0!==e.length){var r=e[0],n=new FormData;n.append("file",r,r.name),this.imageService.upload(n,this.folderName,this.userId,this.imgType).subscribe(function(e){switch(e.type===u.c.UploadProgress?t.progress=Math.round(100*e.loaded/e.total):e.type===u.c.Response&&(t.message="Documents uploaded successfully."),e.type){case u.c.Sent:console.log("Request has been made!");break;case u.c.ResponseHeader:console.log("Response header has been received!");break;case u.c.UploadProgress:t.progress=Math.round(e.loaded/e.total*100);break;case u.c.Response:setTimeout(function(){t.progress=0},1500)}})}}},{key:"goBack",value:function(){this.location.back()}},{key:"openLanguagePopover",value:function(e){return Object(s.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.popoverController.create({component:f.a,event:e});case 2:return r=t.sent,t.next=5,r.present();case 5:case"end":return t.stop()}},t,this)}))}},{key:"notEnoughImages",value:function(){return Object(s.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.translate.get(["You have to upload 4 document pictures."]).subscribe(function(e){return Object(s.a)(t,void 0,void 0,regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertController.create({header:e["You have to upload 4 document pictures."],buttons:[{text:"Ok",role:"Ok"}]});case 2:return r=t.sent,t.next=5,r.present();case 5:case"end":return t.stop()}},t,this)}))});case 1:case"end":return e.stop()}},e,this)}))}},{key:"picDelete",value:function(e){return Object(s.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.translate.get(["Delete the picture?","Yes","No"]).subscribe(function(t){return Object(s.a)(r,void 0,void 0,regeneratorRuntime.mark(function r(){var n,o=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.alertController.create({header:t["Delete the picture?"],buttons:[{text:t.Yes,handler:function(){o.imageService.removeDocument(e).subscribe(function(e){console.log("Image removed sucessfully")})}},{text:t.No,role:"no"}]});case 2:return n=r.sent,r.next=5,n.present();case 5:case"end":return r.stop()}},r,this)}))});case 1:case"end":return t.stop()}},t,this)}))}},{key:"clearForm",value:function(){this.form.reset({model:"",tehnicalReview:"",registrationNumber:"",color:"",capacity:""})}}])&&t(n.prototype,o),i&&t(n,i),r}(),O.\u0275fac=function(e){return new(e||O)(p.Kb(b.f),p.Kb(c.b),p.Kb(m.a),p.Kb(v.a),p.Kb(i.h),p.Kb(g.a),p.Kb(a.a),p.Kb(a.H),p.Kb(h.d))},O.\u0275cmp=p.Eb({type:O,selectors:[["app-car-register"]],decls:97,vars:60,consts:[["slot","start"],["slot","end"],["id","toolbarIcon","name","language-outline",3,"click"],["padding","",1,"background"],[1,"row","mt-2"],[1,"col"],[1,"row"],[1,"col","text-center"],["color","dark",1,"centered"],[1,"text"],["novalidate","",1,"col-md-6","mt-1",3,"formGroup"],[1,"form-group","col","text-center"],["formControlName","model","type","text",1,"form-control",3,"placeholder","ngClass"],["class","invalid-feedback",4,"ngIf"],["formControlName","type","id","exampleFormControlSelect1",1,"form-control"],["value","","disabled","","selected","","hidden",""],["value","1"],["value","2"],["formControlName","color","type","text",1,"form-control",3,"placeholder","ngClass"],["formControlName","capacity","type","number",1,"form-control",3,"placeholder","ngClass"],["formControlName","registrationNumber","type","text",1,"form-control",3,"placeholder","ngClass"],[1,"text","mb-3"],[1,"input-group","text-left"],[1,"input-group","mb-1"],["type","text",1,"form-control"],[1,"input-group-append"],["type","file","placeholder","Choose file",2,"display","none",3,"change"],["file1",""],["name","add-outline","color","dark",3,"click"],["file2",""],["file3",""],["file4",""],[4,"ngFor","ngForOf"],[1,"col-md-12","mt-3"],["type","submit",1,"btn","btn-info",3,"click"],[1,"invalid-feedback"],[4,"ngIf"],[1,"text","list-group-item","list-group-item-action","flex-column","align-items-start"],[3,"src"],[1,"text-center"],[1,"mb-1","fonted"],[1,"btn","btn-danger",3,"click"]],template:function(e,t){if(1&e){var r=p.Ob();p.Nb(0,"ion-header"),p.Nb(1,"ion-toolbar"),p.Nb(2,"ion-buttons",0),p.Lb(3,"ion-menu-button"),p.Mb(),p.Nb(4,"ion-title"),p.Nb(5,"ion-label"),p.pc(6,"Cyber"),p.Mb(),p.Mb(),p.Nb(7,"ion-buttons",1),p.Nb(8,"ion-icon",2),p.Vb("click",function(e){return t.openLanguagePopover(e)}),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Nb(9,"ion-content",3),p.Nb(10,"div",4),p.Nb(11,"div",5),p.Nb(12,"div",6),p.Nb(13,"div",7),p.Nb(14,"ion-text",8),p.Nb(15,"h3",9),p.pc(16),p.Yb(17,"translate"),p.Mb(),p.Lb(18,"hr"),p.Mb(),p.Nb(19,"form",10),p.Nb(20,"div",11),p.Lb(21,"ion-input",12),p.Yb(22,"translate"),p.oc(23,N,2,1,"div",13),p.Mb(),p.Nb(24,"div",11),p.Nb(25,"select",14),p.Nb(26,"option",15),p.pc(27),p.Yb(28,"translate"),p.Mb(),p.Nb(29,"option",16),p.pc(30),p.Yb(31,"translate"),p.Mb(),p.Nb(32,"option",17),p.pc(33),p.Yb(34,"translate"),p.Mb(),p.Mb(),p.Mb(),p.Nb(35,"div",11),p.Lb(36,"ion-input",18),p.Yb(37,"translate"),p.oc(38,k,2,1,"div",13),p.Mb(),p.Nb(39,"div",11),p.Lb(40,"ion-input",19),p.Yb(41,"translate"),p.oc(42,x,2,1,"div",13),p.Mb(),p.Nb(43,"div",11),p.Lb(44,"ion-input",20),p.Yb(45,"translate"),p.oc(46,w,2,1,"div",13),p.Mb(),p.Nb(47,"h5",21),p.pc(48),p.Yb(49,"translate"),p.Mb(),p.Nb(50,"div",22),p.Nb(51,"div",23),p.Nb(52,"label",24),p.pc(53),p.Yb(54,"translate"),p.Mb(),p.Nb(55,"div",25),p.Nb(56,"span"),p.Nb(57,"input",26,27),p.Vb("change",function(){p.jc(r);var e=p.ic(58);return t.upload(e.files)}),p.Mb(),p.Nb(59,"label"),p.Nb(60,"ion-icon",28),p.Vb("click",function(){return p.jc(r),p.ic(58).click()}),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Nb(61,"div",23),p.Nb(62,"label",24),p.pc(63),p.Yb(64,"translate"),p.Mb(),p.Nb(65,"div",25),p.Nb(66,"span"),p.Nb(67,"input",26,29),p.Vb("change",function(){p.jc(r);var e=p.ic(68);return t.upload(e.files)}),p.Mb(),p.Nb(69,"label"),p.Nb(70,"ion-icon",28),p.Vb("click",function(){return p.jc(r),p.ic(68).click()}),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Nb(71,"div",23),p.Nb(72,"label",24),p.pc(73),p.Yb(74,"translate"),p.Mb(),p.Nb(75,"div",25),p.Nb(76,"span"),p.Nb(77,"input",26,30),p.Vb("change",function(){p.jc(r);var e=p.ic(78);return t.upload(e.files)}),p.Mb(),p.Nb(79,"label"),p.Nb(80,"ion-icon",28),p.Vb("click",function(){return p.jc(r),p.ic(78).click()}),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Nb(81,"div",23),p.Nb(82,"label",24),p.pc(83),p.Yb(84,"translate"),p.Mb(),p.Nb(85,"div",25),p.Nb(86,"span"),p.Nb(87,"input",26,31),p.Vb("change",function(){p.jc(r);var e=p.ic(88);return t.upload(e.files)}),p.Mb(),p.Nb(89,"label"),p.Nb(90,"ion-icon",28),p.Vb("click",function(){return p.jc(r),p.ic(88).click()}),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Nb(91,"ion-list"),p.oc(92,z,9,4,"ion-item",32),p.Mb(),p.Nb(93,"div",33),p.Nb(94,"button",34),p.Vb("click",function(){return t.onSubmit()}),p.pc(95),p.Yb(96,"translate"),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Mb(),p.Mb()}2&e&&(p.zb(16),p.qc(p.Zb(17,24,"Car information")),p.zb(3),p.dc("formGroup",t.form),p.zb(2),p.dc("placeholder",p.Zb(22,26,"Model"))("ngClass",p.gc(52,Y,t.submitted&&t.f.model.errors)),p.zb(2),p.dc("ngIf",t.submitted&&t.f.model.errors),p.zb(4),p.qc(p.Zb(28,28,"Click to choose car type")),p.zb(3),p.qc(p.Zb(31,30,"Normal")),p.zb(3),p.qc(p.Zb(34,32,"Comfort")),p.zb(3),p.dc("placeholder",p.Zb(37,34,"Color"))("ngClass",p.gc(54,Y,t.submitted&&t.f.color.errors)),p.zb(2),p.dc("ngIf",t.submitted&&t.f.color.errors),p.zb(2),p.dc("placeholder",p.Zb(41,36,"Capacity"))("ngClass",p.gc(56,Y,t.submitted&&t.f.capacity.errors)),p.zb(2),p.dc("ngIf",t.submitted&&t.f.capacity.errors),p.zb(2),p.dc("placeholder",p.Zb(45,38,"Registration Number"))("ngClass",p.gc(58,Y,t.submitted&&t.f.registrationNumber.errors)),p.zb(2),p.dc("ngIf",t.submitted&&t.f.registrationNumber.errors),p.zb(2),p.rc("",p.Zb(49,40,"Please upload pictures of the following documents"),":"),p.zb(5),p.rc("1. ",p.Zb(54,42,"Front car picture"),""),p.zb(10),p.rc("2. ",p.Zb(64,44,"Rear car picture"),""),p.zb(10),p.rc("3. ",p.Zb(74,46,"Car insurance picture"),""),p.zb(10),p.rc("4. ",p.Zb(84,48,"Technical review picture"),""),p.zb(9),p.dc("ngForOf",t.pics),p.zb(3),p.qc(p.Zb(96,50,"Submit")))},directives:[a.l,a.B,a.e,a.s,a.A,a.p,a.m,a.i,a.z,c.o,c.i,c.d,a.n,a.K,c.h,c.c,i.j,i.l,c.m,c.k,c.p,a.F,a.q,i.k,a.o],pipes:[h.c],styles:["ion-content[_ngcontent-%COMP%]{--ion-background-color:#e9e9e9}ion-toolbar[_ngcontent-%COMP%]{--ion-background-color:#eee}ion-title[_ngcontent-%COMP%]{text-align:center}#toolbarIcon[_ngcontent-%COMP%]{font-size:1.7em}.text[_ngcontent-%COMP%]{font-family:Open Sans Light}.centered[_ngcontent-%COMP%]{text-align:center}hr[_ngcontent-%COMP%]{width:70%!important}label[_ngcontent-%COMP%]{border:1px solid #ccc;padding:8px 15px;cursor:pointer}.backIcon[_ngcontent-%COMP%]{font-size:150%}.back[_ngcontent-%COMP%], .backIcon[_ngcontent-%COMP%]{color:#ffae00}"]}),O)}],q=((P=function t(){e(this,t)}).\u0275fac=function(e){return new(e||P)},P.\u0275mod=p.Ib({type:P}),P.\u0275inj=p.Hb({imports:[[b.h.forChild(R)],b.h]}),P),S=o("mqiu"),Z=o("QhVT");function j(e){return new S.a(e)}var L,D=((L=function t(){e(this,t)}).\u0275fac=function(e){return new(e||L)},L.\u0275mod=p.Ib({type:L}),L.\u0275inj=p.Hb({imports:[[i.b,c.e,a.C,q,c.l,h.b.forChild({loader:{provide:h.a,useFactory:j,deps:[u.a]}}),Z.LanguagePopoverPageModule]]}),L)}}])}();