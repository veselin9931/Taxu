!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(self.webpackChunkcsharpcornerauthor=self.webpackChunkcsharpcornerauthor||[]).push([[54],{54:function(r,n,o){"use strict";o.r(n),o.d(n,{CarRegisterPageModule:function(){return P},HttpLoaderFactory:function(){return L}});var i=o(8583),c=o(3679),a=o(7823),s=o(4481),u=o(4762),l=o(1841),d=o(4426),g=o(2340),p=o(6522),f=o(3018),Z=o(1799),m=o(5056),v=o(292),h=o(7800);function A(e,t){1&e&&(f.TgZ(0,"div"),f._uU(1),f.ALo(2,"translate"),f.qZA()),2&e&&(f.xp6(1),f.hij("",f.lcZ(2,1,"The field is required"),"!"))}function q(e,t){if(1&e&&(f.TgZ(0,"div",35),f.YNc(1,A,3,3,"div",36),f.qZA()),2&e){var r=f.oxw();f.xp6(1),f.Q6J("ngIf",r.f.model.errors.required)}}function b(e,t){1&e&&(f.TgZ(0,"div"),f._uU(1),f.ALo(2,"translate"),f.qZA()),2&e&&(f.xp6(1),f.hij("",f.lcZ(2,1,"The field is required"),"!"))}function T(e,t){if(1&e&&(f.TgZ(0,"div",35),f.YNc(1,b,3,3,"div",36),f.qZA()),2&e){var r=f.oxw();f.xp6(1),f.Q6J("ngIf",r.f.color.errors.required)}}function x(e,t){1&e&&(f.TgZ(0,"div"),f._uU(1),f.ALo(2,"translate"),f.qZA()),2&e&&(f.xp6(1),f.hij("",f.lcZ(2,1,"The field is required"),"!"))}function k(e,t){if(1&e&&(f.TgZ(0,"div",35),f.YNc(1,x,3,3,"div",36),f.qZA()),2&e){var r=f.oxw();f.xp6(1),f.Q6J("ngIf",r.f.capacity.errors.required)}}function C(e,t){1&e&&(f.TgZ(0,"div"),f._uU(1),f.ALo(2,"translate"),f.qZA()),2&e&&(f.xp6(1),f.hij("",f.lcZ(2,1,"The field is required"),"!"))}function y(e,t){if(1&e&&(f.TgZ(0,"div",35),f.YNc(1,C,3,3,"div",36),f.qZA()),2&e){var r=f.oxw();f.xp6(1),f.Q6J("ngIf",r.f.registrationNumber.errors.required)}}function N(e,t){if(1&e){var r=f.EpF();f.TgZ(0,"ion-item"),f.TgZ(1,"a",37),f.TgZ(2,"p"),f._UZ(3,"img",38),f.qZA(),f.TgZ(4,"div",39),f._UZ(5,"h5",40),f.TgZ(6,"button",41),f.NdJ("click",function(){f.CHM(r);var e=t.$implicit;return f.oxw().removePicture(e.id)}),f._uU(7),f.ALo(8,"translate"),f.qZA(),f.qZA(),f.qZA(),f.qZA()}if(2&e){var n=t.$implicit;f.xp6(3),f.s9C("src",n.path,f.LSH),f.xp6(4),f.hij(" ",f.lcZ(8,2,"Delete"),"")}}var w,_=function(e){return{"is-invalid":e}},I=[{path:"",component:(w=function(){function r(t,n,o,i,c,a,s,u,l){e(this,r),this.route=t,this.formBuilder=n,this.driverService=o,this.accountService=i,this.location=c,this.imageService=a,this.alertController=s,this.popoverController=u,this.translate=l,this.submitted=!1,this.loading=!1,this.folderName="driverFacePic",this.imgType="carImg",this.translate.setDefaultLang(this.accountService.userValue.choosenLanguage),this.userId=this.accountService.userValue.id}var n,o,i;return n=r,(o=[{key:"ngOnInit",value:function(){var e=this;this.getDocs(),this.form=this.formBuilder.group({model:["",c.kI.required],registrationNumber:["",c.kI.required],color:["",c.kI.required],capacity:["",c.kI.required],driverId:[""],type:[""]});var t=(new d.su).configureLogging(d.in.Information).withUrl("".concat(g.N.signalRUrl,"/orderHub")).build();t.start().then(function(){console.log("signalR Connected in menu")}).catch(function(e){console.log("Reconnecting in 1 sec."),setTimeout(function(){return t.start()},1e3)}),t.on("OnUpload",function(t){e.getDocs()})}},{key:"ionViewDidEnter",value:function(){}},{key:"f",get:function(){return this.form.controls}},{key:"getDocs",value:function(){var e=this;this.imageService.getUserCarPictures(this.userId).subscribe(function(t){e.pics=t,console.log(e.pics)})}},{key:"removePicture",value:function(e){this.picDelete(e)}},{key:"onSubmit",value:function(){var e=this;this.submitted=!0,this.form.valid&&(4!=this.pics.length?this.notEnoughImages():this.accountService.getById(this.userId).subscribe(function(t){e.form.value.driverId=t.driverId,e.form.value.type=+e.form.value.type,e.driverService.createCar(e.form.value).subscribe(function(r){e.clearForm(),e.driverService.getDriverCars(t.driverId).subscribe(function(t){e.route.navigateByUrl("menu/verifying")})})}))}},{key:"upload",value:function(e){var t=this;if(0!==e.length){var r=e[0],n=new FormData;n.append("file",r,r.name),this.imageService.upload(n,this.folderName,this.userId,this.imgType).subscribe(function(e){switch(e.type===l.dt.UploadProgress?t.progress=Math.round(100*e.loaded/e.total):e.type===l.dt.Response&&(t.message="Documents uploaded successfully."),e.type){case l.dt.Sent:console.log("Request has been made!");break;case l.dt.ResponseHeader:console.log("Response header has been received!");break;case l.dt.UploadProgress:t.progress=Math.round(e.loaded/e.total*100);break;case l.dt.Response:setTimeout(function(){t.progress=0},1500)}})}}},{key:"goBack",value:function(){this.location.back()}},{key:"openLanguagePopover",value:function(e){return(0,u.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.popoverController.create({component:p.m,event:e});case 2:return r=t.sent,t.next=5,r.present();case 5:case"end":return t.stop()}},t,this)}))}},{key:"notEnoughImages",value:function(){return(0,u.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.translate.get(["You have to upload 4 document pictures."]).subscribe(function(e){return(0,u.mG)(t,void 0,void 0,regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertController.create({header:e["You have to upload 4 document pictures."],buttons:[{text:"Ok",role:"Ok"}]});case 2:return r=t.sent,t.next=5,r.present();case 5:case"end":return t.stop()}},t,this)}))});case 1:case"end":return e.stop()}},e,this)}))}},{key:"picDelete",value:function(e){return(0,u.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.translate.get(["Delete the picture?","Yes","No"]).subscribe(function(t){return(0,u.mG)(r,void 0,void 0,regeneratorRuntime.mark(function r(){var n,o=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.alertController.create({header:t["Delete the picture?"],buttons:[{text:t.Yes,handler:function(){o.imageService.removeDocument(e).subscribe(function(e){console.log("Image removed sucessfully")})}},{text:t.No,role:"no"}]});case 2:return n=r.sent,r.next=5,n.present();case 5:case"end":return r.stop()}},r,this)}))});case 1:case"end":return t.stop()}},t,this)}))}},{key:"clearForm",value:function(){this.form.reset({model:"",tehnicalReview:"",registrationNumber:"",color:"",capacity:""})}}])&&t(n.prototype,o),i&&t(n,i),r}(),w.\u0275fac=function(e){return new(e||w)(f.Y36(s.F0),f.Y36(c.qu),f.Y36(Z.F),f.Y36(m.B),f.Y36(i.Ye),f.Y36(v.A),f.Y36(a.Br),f.Y36(a.Dh),f.Y36(h.sK))},w.\u0275cmp=f.Xpm({type:w,selectors:[["app-car-register"]],decls:97,vars:60,consts:[["slot","start"],["slot","end"],["id","toolbarIcon","name","language-outline",3,"click"],["padding","",1,"background"],[1,"row","mt-2"],[1,"col"],[1,"row"],[1,"col","text-center"],["color","dark",1,"centered"],[1,"text"],["novalidate","",1,"col-md-6","mt-1",3,"formGroup"],[1,"form-group","col","text-center"],["formControlName","model","type","text",1,"form-control",3,"placeholder","ngClass"],["class","invalid-feedback",4,"ngIf"],["formControlName","type","id","exampleFormControlSelect1",1,"form-control"],["value","","disabled","","selected","","hidden",""],["value","1"],["value","2"],["formControlName","color","type","text",1,"form-control",3,"placeholder","ngClass"],["formControlName","capacity","type","number",1,"form-control",3,"placeholder","ngClass"],["formControlName","registrationNumber","type","text",1,"form-control",3,"placeholder","ngClass"],[1,"text","mb-3"],[1,"input-group","text-left"],[1,"input-group","mb-1"],["type","text",1,"form-control"],[1,"input-group-append"],["type","file","placeholder","Choose file",2,"display","none",3,"change"],["file1",""],["name","add-outline","color","dark",3,"click"],["file2",""],["file3",""],["file4",""],[4,"ngFor","ngForOf"],[1,"col-md-12","mt-3"],["type","submit",1,"btn","btn-info",3,"click"],[1,"invalid-feedback"],[4,"ngIf"],[1,"text","list-group-item","list-group-item-action","flex-column","align-items-start"],[3,"src"],[1,"text-center"],[1,"mb-1","fonted"],[1,"btn","btn-danger",3,"click"]],template:function(e,t){if(1&e){var r=f.EpF();f.TgZ(0,"ion-header"),f.TgZ(1,"ion-toolbar"),f.TgZ(2,"ion-buttons",0),f._UZ(3,"ion-menu-button"),f.qZA(),f.TgZ(4,"ion-title"),f.TgZ(5,"ion-label"),f._uU(6,"Cyber"),f.qZA(),f.qZA(),f.TgZ(7,"ion-buttons",1),f.TgZ(8,"ion-icon",2),f.NdJ("click",function(e){return t.openLanguagePopover(e)}),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(9,"ion-content",3),f.TgZ(10,"div",4),f.TgZ(11,"div",5),f.TgZ(12,"div",6),f.TgZ(13,"div",7),f.TgZ(14,"ion-text",8),f.TgZ(15,"h3",9),f._uU(16),f.ALo(17,"translate"),f.qZA(),f._UZ(18,"hr"),f.qZA(),f.TgZ(19,"form",10),f.TgZ(20,"div",11),f._UZ(21,"ion-input",12),f.ALo(22,"translate"),f.YNc(23,q,2,1,"div",13),f.qZA(),f.TgZ(24,"div",11),f.TgZ(25,"select",14),f.TgZ(26,"option",15),f._uU(27),f.ALo(28,"translate"),f.qZA(),f.TgZ(29,"option",16),f._uU(30),f.ALo(31,"translate"),f.qZA(),f.TgZ(32,"option",17),f._uU(33),f.ALo(34,"translate"),f.qZA(),f.qZA(),f.qZA(),f.TgZ(35,"div",11),f._UZ(36,"ion-input",18),f.ALo(37,"translate"),f.YNc(38,T,2,1,"div",13),f.qZA(),f.TgZ(39,"div",11),f._UZ(40,"ion-input",19),f.ALo(41,"translate"),f.YNc(42,k,2,1,"div",13),f.qZA(),f.TgZ(43,"div",11),f._UZ(44,"ion-input",20),f.ALo(45,"translate"),f.YNc(46,y,2,1,"div",13),f.qZA(),f.TgZ(47,"h5",21),f._uU(48),f.ALo(49,"translate"),f.qZA(),f.TgZ(50,"div",22),f.TgZ(51,"div",23),f.TgZ(52,"label",24),f._uU(53),f.ALo(54,"translate"),f.qZA(),f.TgZ(55,"div",25),f.TgZ(56,"span"),f.TgZ(57,"input",26,27),f.NdJ("change",function(){f.CHM(r);var e=f.MAs(58);return t.upload(e.files)}),f.qZA(),f.TgZ(59,"label"),f.TgZ(60,"ion-icon",28),f.NdJ("click",function(){return f.CHM(r),f.MAs(58).click()}),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(61,"div",23),f.TgZ(62,"label",24),f._uU(63),f.ALo(64,"translate"),f.qZA(),f.TgZ(65,"div",25),f.TgZ(66,"span"),f.TgZ(67,"input",26,29),f.NdJ("change",function(){f.CHM(r);var e=f.MAs(68);return t.upload(e.files)}),f.qZA(),f.TgZ(69,"label"),f.TgZ(70,"ion-icon",28),f.NdJ("click",function(){return f.CHM(r),f.MAs(68).click()}),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(71,"div",23),f.TgZ(72,"label",24),f._uU(73),f.ALo(74,"translate"),f.qZA(),f.TgZ(75,"div",25),f.TgZ(76,"span"),f.TgZ(77,"input",26,30),f.NdJ("change",function(){f.CHM(r);var e=f.MAs(78);return t.upload(e.files)}),f.qZA(),f.TgZ(79,"label"),f.TgZ(80,"ion-icon",28),f.NdJ("click",function(){return f.CHM(r),f.MAs(78).click()}),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(81,"div",23),f.TgZ(82,"label",24),f._uU(83),f.ALo(84,"translate"),f.qZA(),f.TgZ(85,"div",25),f.TgZ(86,"span"),f.TgZ(87,"input",26,31),f.NdJ("change",function(){f.CHM(r);var e=f.MAs(88);return t.upload(e.files)}),f.qZA(),f.TgZ(89,"label"),f.TgZ(90,"ion-icon",28),f.NdJ("click",function(){return f.CHM(r),f.MAs(88).click()}),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(91,"ion-list"),f.YNc(92,N,9,4,"ion-item",32),f.qZA(),f.TgZ(93,"div",33),f.TgZ(94,"button",34),f.NdJ("click",function(){return t.onSubmit()}),f._uU(95),f.ALo(96,"translate"),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.qZA()}2&e&&(f.xp6(16),f.Oqu(f.lcZ(17,24,"Car information")),f.xp6(3),f.Q6J("formGroup",t.form),f.xp6(2),f.Q6J("placeholder",f.lcZ(22,26,"Model"))("ngClass",f.VKq(52,_,t.submitted&&t.f.model.errors)),f.xp6(2),f.Q6J("ngIf",t.submitted&&t.f.model.errors),f.xp6(4),f.Oqu(f.lcZ(28,28,"Click to choose car type")),f.xp6(3),f.Oqu(f.lcZ(31,30,"Normal")),f.xp6(3),f.Oqu(f.lcZ(34,32,"Comfort")),f.xp6(3),f.Q6J("placeholder",f.lcZ(37,34,"Color"))("ngClass",f.VKq(54,_,t.submitted&&t.f.color.errors)),f.xp6(2),f.Q6J("ngIf",t.submitted&&t.f.color.errors),f.xp6(2),f.Q6J("placeholder",f.lcZ(41,36,"Capacity"))("ngClass",f.VKq(56,_,t.submitted&&t.f.capacity.errors)),f.xp6(2),f.Q6J("ngIf",t.submitted&&t.f.capacity.errors),f.xp6(2),f.Q6J("placeholder",f.lcZ(45,38,"Registration Number"))("ngClass",f.VKq(58,_,t.submitted&&t.f.registrationNumber.errors)),f.xp6(2),f.Q6J("ngIf",t.submitted&&t.f.registrationNumber.errors),f.xp6(2),f.hij("",f.lcZ(49,40,"Please upload pictures of the following documents"),":"),f.xp6(5),f.hij("1. ",f.lcZ(54,42,"Front car picture"),""),f.xp6(10),f.hij("2. ",f.lcZ(64,44,"Rear car picture"),""),f.xp6(10),f.hij("3. ",f.lcZ(74,46,"Car insurance picture"),""),f.xp6(10),f.hij("4. ",f.lcZ(84,48,"Technical review picture"),""),f.xp6(9),f.Q6J("ngForOf",t.pics),f.xp6(3),f.Oqu(f.lcZ(96,50,"Submit")))},directives:[a.Gu,a.sr,a.Sm,a.fG,a.wd,a.Q$,a.gu,a.W2,a.yW,c.Y7,c.JL,c.sg,a.pK,a.j9,c.JJ,c.u,i.mk,i.O5,c.EJ,c.YN,c.$B,a.as,a.q_,i.sg,a.Ie],pipes:[h.X$],styles:["ion-content[_ngcontent-%COMP%]{--ion-background-color:#e9e9e9}ion-toolbar[_ngcontent-%COMP%]{--ion-background-color:#eee}ion-title[_ngcontent-%COMP%]{text-align:center}#toolbarIcon[_ngcontent-%COMP%]{font-size:1.7em}.text[_ngcontent-%COMP%]{font-family:Open Sans Light}.centered[_ngcontent-%COMP%]{text-align:center}hr[_ngcontent-%COMP%]{width:70%!important}label[_ngcontent-%COMP%]{border:1px solid #ccc;padding:8px 15px;cursor:pointer}.backIcon[_ngcontent-%COMP%]{font-size:150%}.back[_ngcontent-%COMP%], .backIcon[_ngcontent-%COMP%]{color:#ffae00}"]}),w)}],M=function(){var t=function t(){e(this,t)};return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=f.oAB({type:t}),t.\u0275inj=f.cJS({imports:[[s.Bz.forChild(I)],s.Bz]}),t}(),U=o(2472),J=o(3577);function L(e){return new U.w(e)}var O,P=((O=function t(){e(this,t)}).\u0275fac=function(e){return new(e||O)},O.\u0275mod=f.oAB({type:O}),O.\u0275inj=f.cJS({imports:[[i.ez,c.u5,a.Pc,M,c.UX,h.aw.forChild({loader:{provide:h.Zw,useFactory:L,deps:[l.eN]}}),J.LanguagePopoverPageModule]]}),O)}}])}();