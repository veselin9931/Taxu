!function(){function e(t,r){return(e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(t,r)}function t(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var i,o=n(e);if(t){var a=n(this).constructor;i=Reflect.construct(o,arguments,a)}else i=o.apply(this,arguments);return r(this,i)}}function r(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function n(e){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}(self.webpackChunkcsharpcornerauthor=self.webpackChunkcsharpcornerauthor||[]).push([[6805],{297:function(e,t,r){"use strict";r.d(t,{p:function(){return h}});var n=r(205),o=r(5304),c=r(3342),s=r(2340),u=r(3018),l=r(1841),d=r(728),h=function(){var e=function(){function e(t,r){i(this,e),this.http=t,this.sharedService=r,this.orders=[],this.completedOrder=!1}return a(e,[{key:"createOrder",value:function(e){var t=this.sharedService.headerGerneration();return this.http.post("".concat(s.N.apiUrl,"/api/order"),e,{headers:t,responseType:"text"}).pipe((0,o.K)(this.handleError))}},{key:"addToFavourites",value:function(e){var t=this.sharedService.headerGerneration();return this.http.post("".concat(s.N.apiUrl,"/api/order/favourites"),e,{headers:t,responseType:"text"}).pipe((0,o.K)(this.handleError))}},{key:"getMyFavourites",value:function(e){var t=this.sharedService.headerGerneration();return this.http.get("".concat(s.N.apiUrl,"/api/order/favourites/").concat(e),{headers:t}).pipe((0,o.K)(this.handleError))}},{key:"deleteFavouriteOrder",value:function(e){var t=this.sharedService.headerGerneration();return this.http.delete("".concat(s.N.apiUrl,"/api/order/favourites/").concat(e),{headers:t}).pipe((0,c.b)(function(e){return console.log("deleted favourite order: ",JSON.stringify(e))}),(0,o.K)(this.handleError))}},{key:"getDirections",value:function(e,t,r,n){var i=this.sharedService.headerGerneration();return this.http.post("https://maps.googleapis.com/maps/api/distancematrix/json?units=imperial&origins=".concat(e,",").concat(t,"&destinations=").concat(r,"%2C").concat(n,"%7C&key=AIzaSyAEvlXdM4joG4bNVT5l-tJSk9lUSGhxMNw"),{headers:i,responseType:"text"}).pipe((0,o.K)(this.handleError))}},{key:"getOrderById",value:function(e){var t=this,r=this.sharedService.headerGerneration();return this.http.get("".concat(s.N.apiUrl,"/api/order/id/").concat(e),{headers:r}).pipe((0,c.b)(function(e){return t.order=e}))}},{key:"getCanceledOrderById",value:function(e){var t=this,r=this.sharedService.headerGerneration();return this.http.get("".concat(s.N.apiUrl,"/api/order/canceled/").concat(e),{headers:r}).pipe((0,c.b)(function(e){return t.order=e}))}},{key:"getLastCompletedOrder",value:function(e){var t=this.sharedService.headerGerneration();return this.http.get("".concat(s.N.apiUrl,"/api/order/completed/").concat(e),{headers:t}).pipe((0,o.K)(this.handleError))}},{key:"getMyOrder",value:function(e){var t=this.sharedService.headerGerneration();return this.http.get("".concat(s.N.apiUrl,"/api/order/").concat(e),{headers:t}).pipe((0,o.K)(this.handleError))}},{key:"getOrderForChat",value:function(e){var t=this.sharedService.headerGerneration();return this.http.get("".concat(s.N.apiUrl,"/api/order/chat/").concat(e),{headers:t}).pipe((0,o.K)(this.handleError))}},{key:"getAllOrders",value:function(){var e=this.sharedService.headerGerneration();return this.http.get("".concat(s.N.apiUrl,"/api/order"),{headers:e}).pipe((0,o.K)(this.handleError))}},{key:"getNormalOrders",value:function(){var e=this.sharedService.headerGerneration();return this.http.get("".concat(s.N.apiUrl,"/api/order/normal"),{headers:e}).pipe((0,o.K)(this.handleError))}},{key:"getComfortOrders",value:function(){var e=this.sharedService.headerGerneration();return this.http.get("".concat(s.N.apiUrl,"/api/order/comfort"),{headers:e}).pipe((0,o.K)(this.handleError))}},{key:"acceptOrder",value:function(e,t){var r=this,n=this.sharedService.headerGerneration();return this.http.put("".concat(s.N.apiUrl,"/api/order/").concat(e,"/").concat(t),{headers:n,responseType:"json"}).pipe((0,c.b)(function(e){return r.driverId=t}),(0,o.K)(this.handleError))}},{key:"updateOrderEta",value:function(e,t){var r=this.sharedService.headerGerneration();return this.http.put("".concat(s.N.apiUrl,"/api/order/eta/").concat(e,"/").concat(t),{headers:r,responseType:"json"}).pipe((0,o.K)(this.handleError))}},{key:"updateDriverArrived",value:function(e){var t=this.sharedService.headerGerneration();return this.http.put("".concat(s.N.apiUrl,"/api/order/arrived/").concat(e),{headers:t,responseType:"json"}).pipe((0,o.K)(this.handleError))}},{key:"rateOrder",value:function(e){var t=this.sharedService.headerGerneration();return this.http.put("".concat(s.N.apiUrl,"/api/order/rate/").concat(e),{headers:t,responseType:"json"}).pipe((0,o.K)(this.handleError))}},{key:"increaseOrderPrice",value:function(e,t){var r=this.sharedService.headerGerneration();return this.http.put("".concat(s.N.apiUrl,"/api/order/increase/").concat(e,"/").concat(t),{headers:r,responseType:"json"}).pipe((0,o.K)(this.handleError))}},{key:"completeOrder",value:function(e){var t=this.sharedService.headerGerneration();return this.http.put("".concat(s.N.apiUrl,"/api/order/").concat(e),{headers:t,responseType:"json"}).pipe((0,o.K)(this.handleError))}},{key:"deleteOrder",value:function(e){var t=this.sharedService.headerGerneration();return this.http.delete("".concat(s.N.apiUrl,"/api/order/").concat(e),{headers:t}).pipe((0,c.b)(function(e){return console.log("deleted order: ",JSON.stringify(e))}),(0,o.K)(this.handleError))}},{key:"driverIncreaseOrderPrice",value:function(e,t,r){var n=this.sharedService.headerGerneration();return this.http.put("".concat(s.N.apiUrl,"/api/order/increased/").concat(e,"/").concat(t,"/").concat(r),{headers:n,responseType:"json"}).pipe((0,o.K)(this.handleError))}},{key:"resetIncreasing",value:function(e){var t=this.sharedService.headerGerneration();return this.http.put("".concat(s.N.apiUrl,"/api/order/reset/").concat(e),{headers:t,responseType:"json"}).pipe((0,o.K)(this.handleError))}},{key:"increasedOrderAccept",value:function(e,t){var r=this.sharedService.headerGerneration();return this.http.put("".concat(s.N.apiUrl,"/api/order/accepted/increase/").concat(e,"/").concat(t),{headers:r,responseType:"json"}).pipe((0,o.K)(this.handleError))}},{key:"incrementOrderPrice",value:function(e){var t=this.sharedService.headerGerneration();return this.http.put("".concat(s.N.apiUrl,"/api/order/increment/").concat(e),{headers:t,responseType:"json"}).pipe((0,o.K)(this.handleError))}},{key:"decrementOrderPrice",value:function(e){var t=this.sharedService.headerGerneration();return this.http.put("".concat(s.N.apiUrl,"/api/order/decrement/").concat(e),{headers:t,responseType:"json"}).pipe((0,o.K)(this.handleError))}},{key:"handleError",value:function(e){var t="";return e.error instanceof ErrorEvent?(console.log("Client side error."),t="Error: ".concat(e.error.message)):(console.log("Server side error."),t="Error Code: ".concat(e.status,"\nMessage: ").concat(e.message)),console.log(t),(0,n._)(t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(u.LFG(l.eN),u.LFG(d.F))},e.\u0275prov=u.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},6805:function(r,n,o){"use strict";o.r(n),o.d(n,{HttpLoaderFactory:function(){return W},TravellingPageModule:function(){return $}});var c=o(8583),s=o(3679),u=o(7823),l=o(4481),d=o(4762),h=o(4426),p=o(2340),f=o(6522),v=o(5435),g=o(7393),m=function(){function e(){i(this,e)}return a(e,[{key:"call",value:function(e,t){return t.subscribe(new b(e))}}]),e}(),b=function(r){!function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&e(t,r)}(o,r);var n=t(o);function o(e){var t;return i(this,o),(t=n.call(this,e)).hasPrev=!1,t}return a(o,[{key:"_next",value:function(e){var t;this.hasPrev?t=[this.prev,e]:this.hasPrev=!0,this.prev=e,t&&this.destination.next(t)}}]),o}(g.L),Z=o(3018),x=o(297),y=o(5056),k=o(7800),S=o(7324),T=["mydt"];function O(e,t){if(1&e){var r=Z.EpF();Z.TgZ(0,"p",22),Z.NdJ("click",function(){return Z.CHM(r),Z.oxw(2).locationMap()}),Z._UZ(1,"ion-icon",23),Z._uU(2),Z.qZA()}if(2&e){var n=Z.oxw(2);Z.xp6(2),Z.hij(" ",n.orderService.chosenLocation," ")}}function A(e,t){if(1&e){var r=Z.EpF();Z.TgZ(0,"p",22),Z.NdJ("click",function(){return Z.CHM(r),Z.oxw(2).locationMap()}),Z._UZ(1,"ion-icon",23),Z._uU(2),Z.ALo(3,"translate"),Z.qZA()}2&e&&(Z.xp6(2),Z.hij("",Z.lcZ(3,1,"Take me from here")," "))}function P(e,t){if(1&e&&(Z.TgZ(0,"div",20),Z.YNc(1,O,3,1,"p",21),Z.YNc(2,A,4,3,"p",21),Z._UZ(3,"hr"),Z.qZA()),2&e){var r=Z.oxw();Z.xp6(1),Z.Q6J("ngIf",null!=r.orderService.chosenLocation),Z.xp6(1),Z.Q6J("ngIf",null==r.orderService.chosenLocation)}}function C(e,t){if(1&e){var r=Z.EpF();Z.TgZ(0,"p",22),Z.NdJ("click",function(){return Z.CHM(r),Z.oxw(2).destinationMap()}),Z._UZ(1,"ion-icon",25),Z._uU(2),Z.qZA()}if(2&e){var n=Z.oxw(2);Z.xp6(2),Z.hij(" ",n.orderService.chosenDestination," ")}}function L(e,t){if(1&e){var r=Z.EpF();Z.TgZ(0,"p",22),Z.NdJ("click",function(){return Z.CHM(r),Z.oxw(2).destinationMap()}),Z._UZ(1,"ion-icon",25),Z._uU(2),Z.ALo(3,"translate"),Z.qZA()}2&e&&(Z.xp6(2),Z.hij("",Z.lcZ(3,1,"Choose destination")," "))}function w(e,t){if(1&e&&(Z.TgZ(0,"div",24),Z.YNc(1,C,3,1,"p",21),Z.YNc(2,L,4,3,"p",21),Z.qZA()),2&e){var r=Z.oxw();Z.xp6(1),Z.Q6J("ngIf",null!=r.orderService.chosenDestination),Z.xp6(1),Z.Q6J("ngIf",null==r.orderService.chosenDestination)}}function _(e,t){if(1&e&&(Z.TgZ(0,"div",20),Z.TgZ(1,"p"),Z._UZ(2,"ion-icon",26),Z._uU(3),Z.qZA(),Z._UZ(4,"hr"),Z.TgZ(5,"p"),Z._UZ(6,"ion-icon",25),Z._uU(7),Z.qZA(),Z.qZA()),2&e){var r=Z.oxw();Z.xp6(3),Z.hij("",r.order.location," "),Z.xp6(4),Z.hij("",r.order.destination," ")}}function U(e,t){1&e&&(Z.TgZ(0,"div",27),Z._UZ(1,"hr"),Z.TgZ(2,"ion-label"),Z._uU(3),Z.ALo(4,"translate"),Z.qZA(),Z._UZ(5,"br"),Z.qZA()),2&e&&(Z.xp6(3),Z.Oqu(Z.lcZ(4,1,"Additional options")))}function N(e,t){if(1&e){var r=Z.EpF();Z.TgZ(0,"div",28),Z.TgZ(1,"ion-checkbox",29),Z.NdJ("click",function(){return Z.CHM(r),Z.oxw().priceUpdate()}),Z.qZA(),Z.TgZ(2,"ion-label",30),Z._UZ(3,"ion-icon",31),Z._uU(4),Z.ALo(5,"translate"),Z.qZA(),Z._UZ(6,"br"),Z._UZ(7,"ion-checkbox",32),Z.TgZ(8,"ion-label",30),Z._UZ(9,"ion-icon",33),Z._uU(10),Z.ALo(11,"translate"),Z.qZA(),Z._UZ(12,"br"),Z._UZ(13,"ion-checkbox",34),Z.TgZ(14,"ion-label",30),Z._UZ(15,"ion-icon",35),Z._uU(16),Z.ALo(17,"translate"),Z.qZA(),Z.qZA()}2&e&&(Z.xp6(4),Z.hij(" ",Z.lcZ(5,3,"Pets")," + 2.20 \u043b\u0432. "),Z.xp6(6),Z.hij(" ",Z.lcZ(11,5,"Baggage")," "),Z.xp6(6),Z.hij(" ",Z.lcZ(17,7,"Special needs")," "))}var q=function(e){return{border:e}};function M(e,t){if(1&e){var r=Z.EpF();Z.TgZ(0,"div",15),Z.TgZ(1,"div",36),Z.TgZ(2,"ion-label"),Z._uU(3),Z.ALo(4,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(5,"div",37),Z.NdJ("click",function(){return Z.CHM(r),Z.oxw().onSelectCar("normal")}),Z._UZ(6,"img",38),Z.qZA(),Z.TgZ(7,"div",37),Z.NdJ("click",function(){return Z.CHM(r),Z.oxw().onSelectCar("comfort")}),Z._UZ(8,"img",39),Z.qZA(),Z.qZA()}if(2&e){var n=Z.oxw();Z.xp6(3),Z.Oqu(Z.lcZ(4,3,"Car type (optional)")),Z.xp6(3),Z.Q6J("ngStyle",Z.VKq(5,q,"normal"==n.carValue?"3px solid rgb(255, 208, 0)":"3px solid rgb(109, 109, 109)")),Z.xp6(2),Z.Q6J("ngStyle",Z.VKq(7,q,"comfort"==n.carValue?"3px solid rgb(255, 208, 0)":"3px solid rgb(109, 109, 109)"))}}function I(e,t){if(1&e&&(Z.TgZ(0,"ion-item",40),Z.TgZ(1,"ion-label"),Z._uU(2),Z.ALo(3,"translate"),Z.qZA(),Z._UZ(4,"ion-datetime",41,42),Z.ALo(6,"translate"),Z.qZA()),2&e){var r=Z.oxw();Z.xp6(2),Z.Oqu(Z.lcZ(3,3,"Select pickup time")),Z.xp6(2),Z.Q6J("placeholder",Z.lcZ(6,5,"Select time"))("pickerOptions",r.customPickerOptions)}}function D(e,t){1&e&&(Z.TgZ(0,"ion-item"),Z.TgZ(1,"ion-label",43),Z._uU(2),Z.ALo(3,"translate"),Z.qZA(),Z._UZ(4,"ion-input",44),Z.qZA()),2&e&&(Z.xp6(2),Z.Oqu(Z.lcZ(3,1,"Additional information")))}function E(e,t){if(1&e){var r=Z.EpF();Z.TgZ(0,"div",24),Z.TgZ(1,"div",45),Z.TgZ(2,"h5",46),Z._uU(3),Z.ALo(4,"translate"),Z.qZA(),Z.TgZ(5,"a",47),Z.TgZ(6,"button",48),Z._uU(7),Z.ALo(8,"number"),Z.qZA(),Z.TgZ(9,"button",49),Z.NdJ("click",function(){return Z.CHM(r),Z.oxw().increment()}),Z._uU(10,"+"),Z.qZA(),Z.qZA(),Z.qZA(),Z._UZ(11,"hr"),Z.qZA()}if(2&e){var n=Z.oxw();Z.xp6(3),Z.Oqu(Z.lcZ(4,2,"Increase amount")),Z.xp6(4),Z.hij("",Z.xi3(8,4,n.order.totalPrice,"1.2-2")," \u043b\u0432.")}}function J(e,t){1&e&&Z._UZ(0,"span",52)}function G(e,t){if(1&e){var r=Z.EpF();Z.TgZ(0,"button",50),Z.NdJ("click",function(){return Z.CHM(r),Z.oxw().onSubmit()}),Z._uU(1),Z.ALo(2,"number"),Z.ALo(3,"translate"),Z.YNc(4,J,1,0,"span",51),Z.qZA()}if(2&e){var n=Z.oxw();Z.Q6J("disabled",n.isSubmitted),Z.xp6(1),Z.AsE(" ",Z.xi3(2,4,n.orderTotalPrice,"1.2-2")," \u043b\u0432. | ",Z.lcZ(3,7,"Make a order")," "),Z.xp6(3),Z.Q6J("ngIf",n.isSubmitted)}}function F(e,t){1&e&&(Z.TgZ(0,"div",53),Z.TgZ(1,"button",54),Z._uU(2),Z.ALo(3,"translate"),Z.qZA(),Z.qZA()),2&e&&(Z.xp6(2),Z.Oqu(Z.lcZ(3,1,"Looking for a driver")))}function j(e,t){if(1&e&&(Z.TgZ(0,"button",58),Z._uU(1),Z.ALo(2,"translate"),Z.ALo(3,"number"),Z.qZA()),2&e){var r=Z.oxw(2);Z.xp6(1),Z.AsE("",Z.lcZ(2,2,"Cost")," : ",Z.xi3(3,4,r.order.totalPrice,"1.2-2")," \u043b\u0432.")}}function Y(e,t){if(1&e){var r=Z.EpF();Z.TgZ(0,"button",59),Z.NdJ("click",function(){return Z.CHM(r),Z.oxw(2).cancelOrder()}),Z._uU(1),Z.ALo(2,"translate"),Z.qZA()}2&e&&(Z.xp6(1),Z.Oqu(Z.lcZ(2,1,"Cancel")))}function K(e,t){if(1&e&&(Z.TgZ(0,"ion-footer",55),Z.TgZ(1,"ion-toolbar"),Z.TgZ(2,"div",6),Z.TgZ(3,"div",5),Z.TgZ(4,"div",45),Z.YNc(5,j,4,7,"button",56),Z.YNc(6,Y,3,3,"button",57),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA()),2&e){var r=Z.oxw();Z.xp6(5),Z.Q6J("ngIf",1==r.isCompleted),Z.xp6(1),Z.Q6J("ngIf",1==r.isCompleted)}}var R,V=[{path:"",component:(R=function(){function e(t,r,n,o,a,c,s,u,d){var h=this;i(this,e),this.formBuilder=t,this.route=r,this.orderService=n,this.accountService=o,this.translate=a,this.popoverController=c,this.alertController=s,this.localNotifications=u,this.plt=d,this.user=this.accountService.userValue,this.choosedLocDest=!1,this.carModel="",this.carColor="",this.firstName="",this.lastName="",this.carValue="normal",this.isSubmitted=!1,this.isCompleted=!1,this.subscriptions=[],this.pushes=[],this.translate.setDefaultLang(this.accountService.userValue.choosenLanguage),this.dateAndTimePicker(),this.route.events.pipe((0,v.h)(function(e){return e instanceof l.R9}),function(e){return e.lift(new m)}).subscribe(function(e){console.log("previous url",e[0].urlAfterRedirects),"/menu/travel-mode"!=e[0].urlAfterRedirects&&"/menu/travelling"!=e[0].urlAfterRedirects||(h.backFromTravel(),console.log("gay"))})}return a(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.form=this.formBuilder.group({applicationUserId:[""],location:this.orderService.chosenLocation,locationLat:this.orderService.userLocationLat,locationLong:this.orderService.userLocationLong,destination:this.orderService.chosenDestination,destinationLat:this.orderService.userDestinationLat,destinationLong:this.orderService.userDestinationLong,totalPrice:this.orderTotalPrice,tripDistance:0,userDistance:0,increasePrice:[0],status:"Waiting",eta:"",withPets:!1,withStroller:!1,special:!1,carType:this.carValue,description:"",pickUpTime:""});var t=(new h.su).configureLogging(h.in.Information).withUrl("".concat(p.N.signalRUrl,"/orderHub")).build();t.start().then(function(){console.log("signalR Connected in travelling")}).catch(function(e){return console.log(e)}),t.on("CreatedOrder",function(){e.checkorder()}),t.on("IncrementDecrement",function(t){e.subscriptions.push(e.orderService.getOrderById(t).subscribe(function(t){Math.round(100*e.orderTotalPrice),e.order.totalPrice=t.totalPrice}))}),t.on("OfferMorePrice",function(t){e.subscriptions.push(e.orderService.getOrderById(t).subscribe(function(t){t.id==e.order.id&&t.increasedByDriver>=.5&&(e.driverPrice=t.increasedByDriver,e.driverIncreased=t.increasedByDriver+e.orderTotalPrice,e.increasedOrder())}))}),t.on("OrderAccepted",function(){e.subscriptions.push(e.orderService.getMyOrder(e.user.id).subscribe(function(t){"Accepted"==t.status&&(e.presentOrderAcceptedNotification(),e.checkorder())}))}),t.on("LocateDriver",function(e){})}},{key:"presentOrderAcceptedNotification",value:function(){var e=this;this.translate.get(["Order","Your order is accepted"]).subscribe(function(t){e.localNotifications.schedule({id:1,title:t.Order,text:t["Your order is accepted"],data:{secret:"secret"}})})}},{key:"ionViewDidEnter",value:function(){this.form.value.carType="normal",this.carValue="normal",this.orderService.chosenDestination&&this.orderService.chosenLocation&&(this.choosedLocDest=!0),this.checkorder(),this.orderService.selectedFavourite?(this.orderService.chosenLocation=this.orderService.selectedFavourite.location,this.form.get("location").setValue(this.orderService.selectedFavourite.location),this.form.get("locationLat").setValue(+this.orderService.selectedFavourite.locationLat),this.form.get("locationLong").setValue(+this.orderService.selectedFavourite.locationLong),this.orderService.chosenDestination=this.orderService.selectedFavourite.destination,this.form.get("destination").setValue(this.orderService.selectedFavourite.destination),this.form.get("destinationLat").setValue(+this.orderService.selectedFavourite.destinationLat),this.form.get("destinationLong").setValue(+this.orderService.selectedFavourite.destinationLong)):(this.form.get("location").setValue(this.orderService.chosenLocation),this.form.get("locationLat").setValue(this.orderService.userLocationLat),this.form.get("locationLong").setValue(this.orderService.userLocationLong),this.form.get("destination").setValue(this.orderService.chosenDestination),this.form.get("destinationLat").setValue(this.orderService.userDestinationLat),this.form.get("destinationLong").setValue(this.orderService.userDestinationLong)),this.isCompleted&&(this.form.get("location").setValue(this.order.location),this.form.get("destination").setValue(this.order.destination))}},{key:"f",get:function(){return this.form.controls}},{key:"locationMap",value:function(){this.route.navigate(["menu/location"])}},{key:"destinationMap",value:function(){this.route.navigate(["menu/destination"])}},{key:"onSubmit",value:function(){var e=this;this.isSubmitted=!0,this.form.value.carType=this.carValue,null==this.form.value.location&&(this.locationError(),this.isSubmitted=!1),null==this.form.value.destination&&(this.destinationError(),this.isSubmitted=!1),this.form.valid&&(new google.maps.DirectionsService).route({origin:{lat:this.form.value.locationLat,lng:this.form.value.locationLong},destination:{lat:this.form.value.destinationLat,lng:this.form.value.destinationLong},travelMode:google.maps.TravelMode.DRIVING},function(t,r){if("OK"===r){if(e.estimatedDuration=t.routes[0].legs[0].duration.text,e.orderTotalDestination=t.routes[0].legs[0].distance.value/1e3,e.orderTotalPrice=.9*e.orderTotalDestination,1==e.form.value.withPets&&(e.orderTotalPrice+=2.2),"comfort"==e.form.value.carType&&(e.orderTotalPrice+=1),e.form.value.totalPrice=e.orderTotalPrice,e.form.value.tripDistance=e.orderTotalDestination,e.form.value.increasePrice=+e.form.value.increasePrice,e.form.value.eta=e.estimatedDuration,e.form.value.applicationUserId=e.user.id,e.isSubmitted=!0,!e.form.valid)return!1;e.subscriptions.push(e.orderService.createOrder(e.form.value).subscribe(function(t){e.form.value.locationLat=e.form.value.locationLat.toString(),e.form.value.locationLong=e.form.value.locationLong.toString(),e.orderStatus=e.form.value.status,e.subscriptions.push(e.orderService.getMyOrder(e.user.id).subscribe())})),console.log(e.order)}else e.isSubmitted=!1})}},{key:"openPicker",value:function(){this.mydt.open()}},{key:"dateAndTimePicker",value:function(){var e=this;this.translate.get(["Now","Cancel","Choose"]).subscribe(function(t){e.customPickerOptions={buttons:[{text:t.Now,handler:function(){var t=new Date;e.mydt.value="".concat(t.getHours(),":").concat(t.getMinutes()),console.log(e.mydt.value)}},{text:t.Cancel},{text:t.Choose,handler:function(t){e.mydt.value="".concat(t.hour.text,":").concat(t.minute.text),console.log(t.hour.text),console.log(t.minute.text)}}]}})}},{key:"offer",value:function(e){this.form.value.increasePrice=e}},{key:"selector",value:function(e){var t=+e;0==t&&""==e||this.subscriptions.push(this.orderService.increaseOrderPrice(this.order.id,t).subscribe())}},{key:"increment",value:function(){this.subscriptions.push(this.orderService.incrementOrderPrice(this.order.id).subscribe(function(){}))}},{key:"decrement",value:function(){this.orderTotalPrice>=1&&this.subscriptions.push(this.orderService.decrementOrderPrice(this.order.id).subscribe(function(){}))}},{key:"priceUpdate",value:function(){0==this.form.value.withPets&&(this.orderTotalPrice=this.orderTotalPrice+2.2,console.log(this.form.value)),1==this.form.value.withPets&&(this.orderTotalPrice=this.orderTotalPrice-2.2)}},{key:"onSelectCar",value:function(e){this.form.value.carType=this.carValue,this.carValue=e,"normal"==e&&"comfort"==this.form.value.carType&&(this.orderTotalPrice=this.orderTotalPrice-1),"comfort"==e&&"normal"==this.form.value.carType&&(this.orderTotalPrice=this.orderTotalPrice+1),this.form.value.carType=e}},{key:"checkorder",value:function(){var e=this;this.orderService.userLocationLat&&(new google.maps.DirectionsService).route({origin:{lat:this.orderService.userLocationLat,lng:this.orderService.userLocationLong},destination:{lat:this.orderService.userDestinationLat,lng:this.orderService.userDestinationLong},travelMode:google.maps.TravelMode.DRIVING},function(t,r){"OK"===r&&(e.orderTotalDestination=t.routes[0].legs[0].distance.value/1e3,e.orderTotalPrice=.9*e.orderTotalDestination)}),this.subscriptions.push(this.orderService.getMyOrder(this.user.id).subscribe(function(t){"Canceled"!=t.status?(e.orderService.currentOrderId=t.id,e.location=t.location,e.destination=t.destination,(Math.round(100*e.orderTotalPrice)/100).toFixed(2),e.orderTotalPrice=t.totalPrice,e.order=t,e.estimatedDuration=t.eta,"Waiting"==t.status&&null!=t&&(e.orderStatus=t.status,e.isCompleted=!0),"Accepted"==t.status&&null!=t&&(e.isSubmitted=!1,e.route.navigate(["menu/travel-mode"]),e.isCompleted=!1)):e.orderTotalPrice=0},function(e){console.log(e)}))}},{key:"cancelOrder",value:function(){var e=this;this.subscriptions.push(this.orderService.getMyOrder(this.user.id).subscribe(function(t){e.subscriptions.push(e.orderService.deleteOrder(t.id).subscribe(function(){e.choosedLocDest=!1,e.isCompleted=!1,e.orderStatus=null,e.orderTotalPrice=0,e.clearForm(),e.isSubmitted=!1}))}))}},{key:"openLanguagePopover",value:function(e){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.popoverController.create({component:f.m,event:e});case 2:return r=t.sent,t.next=5,r.present();case 5:case"end":return t.stop()}},t,this)}))}},{key:"locationError",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.translate.get(["Location field is required!"]).subscribe(function(e){return(0,d.mG)(t,void 0,void 0,regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertController.create({header:e["Location field is required!"],buttons:[{text:"Ok",role:"Ok"}]});case 2:return r=t.sent,t.next=5,r.present();case 5:case"end":return t.stop()}},t,this)}))});case 1:case"end":return e.stop()}},e,this)}))}},{key:"destinationError",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.translate.get(["Destination field is required!"]).subscribe(function(e){return(0,d.mG)(t,void 0,void 0,regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertController.create({header:e["Destination field is required!"],buttons:[{text:"Ok",role:"Ok"}]});case 2:return r=t.sent,t.next=5,r.present();case 5:case"end":return t.stop()}},t,this)}))});case 1:case"end":return e.stop()}},e,this)}))}},{key:"increasedOrder",value:function(){return(0,d.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(t={}).first=this.translate.instant("Driver offers you"),t.second=this.translate.instant("\u043b\u0432. for the order"),this.translate.get(["Accept","Cancel"]).subscribe(function(e){return(0,d.mG)(r,void 0,void 0,regeneratorRuntime.mark(function r(){var n,i=this;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.alertController.create({header:"".concat(t.first," ").concat(this.driverIncreased.toFixed(2)," ").concat(t.second),buttons:[{text:e.Accept,handler:function(){i.subscriptions.push(i.orderService.getMyOrder(i.user.id).subscribe(function(e){i.subscriptions.push(i.orderService.increasedOrderAccept(e.id,!0).subscribe(function(){i.subscriptions.push(i.orderService.increaseOrderPrice(e.id,i.driverPrice).subscribe(function(){}))}))}))}},{text:e.Cancel,handler:function(){i.subscriptions.push(i.orderService.getMyOrder(i.user.id).subscribe(function(e){i.subscriptions.push(i.orderService.increasedOrderAccept(e.id,!1).subscribe(function(){})),i.subscriptions.push(i.orderService.resetIncreasing(i.order.id).subscribe(function(){}))}))}}]});case 2:return n=r.sent,r.next=5,n.present();case 5:case"end":return r.stop()}},r,this)}))});case 2:case"end":return e.stop()}},e,this)}))}},{key:"backFromTravel",value:function(){this.choosedLocDest=!1,this.isCompleted=!1,this.orderStatus=null,this.orderTotalPrice=0,this.clearForm(),this.isSubmitted=!1}},{key:"clearForm",value:function(){var e=this;this.translate.get(["Take me from here","Choose destination"]).subscribe(function(t){e.orderService.chosenLocation=t["Take me from here"],e.orderService.chosenDestination=t["Choose destination"]}),this.form.reset({location:void 0,destination:void 0,increaseAmount:"",applicationUserId:"",locationLat:0,locationLong:0,destinationLat:0,destinationLong:0,totalPrice:0,tripDistance:0,userDistance:0,increasePrice:0,status:"Waiting",eta:"",withPets:!1,withStroller:!1,special:!1,carType:"normal"})}}]),e}(),R.\u0275fac=function(e){return new(e||R)(Z.Y36(s.qu),Z.Y36(l.F0),Z.Y36(x.p),Z.Y36(y.B),Z.Y36(k.sK),Z.Y36(u.Dh),Z.Y36(u.Br),Z.Y36(S.sn),Z.Y36(u.t4))},R.\u0275cmp=Z.Xpm({type:R,selectors:[["app-travelling"]],viewQuery:function(e,t){var r;1&e&&Z.Gf(T,1),2&e&&Z.iGM(r=Z.CRH())&&(t.mydt=r.first)},decls:31,vars:16,consts:[["padding",""],["slot","start"],["slot","end"],["id","toolbarIcon","name","language-outline",3,"click"],[1,"row","mt-2"],[1,"col"],[1,"row"],["novalidate","",1,"col",3,"formGroup"],["class","form-group col mt-2",4,"ngIf"],["class","form-group col mt-3",4,"ngIf"],["class","text-center mb-2",4,"ngIf"],["class","col-md-12 text-left",4,"ngIf"],["class","row text-center",4,"ngIf"],["class","mt-2",4,"ngIf"],[4,"ngIf"],[1,"row","text-center"],[1,"col-md-12"],["type","button","class","mt-3 btn btn-warning fonted",3,"disabled","click",4,"ngIf"],["class","blink_me col-md-12 mt-3 text-center fonted",4,"ngIf"],["class","ion-no-border",4,"ngIf"],[1,"form-group","col","mt-2"],[3,"click",4,"ngIf"],[3,"click"],["name","location-outline",1,"mr-2"],[1,"form-group","col","mt-3"],["name","arrow-forward-outline",1,"mr-2"],["name","analytics-outline",1,"mr-2"],[1,"text-center","mb-2"],[1,"col-md-12","text-left"],["color","dark","value","With pets","formControlName","withPets",3,"click"],[1,"ml-2"],["name","paw"],["color","dark","value","With stroller","formControlName","withStroller"],["name","bag-handle"],["color","dark","value","Special needs","formControlName","special"],["name","information-circle"],[1,"col-md-12","mb-2"],[1,"col",3,"click"],["id","normal","src","../../assets/normtext.png","width","100","height","100",3,"ngStyle"],["id","comfort","src","../../assets/comftext.png","width","100","height","100",3,"ngStyle"],[1,"mt-2"],["displayFormat","HH:mm","formControlName","pickUpTime",3,"placeholder","pickerOptions"],["mydt",""],["position","floating"],["formControlName","description"],[1,"d-flex","w-100","justify-content-between"],[1,"fonted"],[1,"mr-1"],[1,"btn","btn-light","btn-sm"],[1,"btn","btn-light","btn-sm","ml-1",3,"click"],["type","button",1,"mt-3","btn","btn-warning","fonted",3,"disabled","click"],["class","spinner-border spinner-border-sm mr-1",4,"ngIf"],[1,"spinner-border","spinner-border-sm","mr-1"],[1,"blink_me","col-md-12","mt-3","text-center","fonted"],[1,"btn","btn-warning","fonted"],[1,"ion-no-border"],["class","ml-3 btn btn-info fonted",4,"ngIf"],["class","mr-3 btn btn-danger fonted",3,"click",4,"ngIf"],[1,"ml-3","btn","btn-info","fonted"],[1,"mr-3","btn","btn-danger","fonted",3,"click"]],template:function(e,t){1&e&&(Z.TgZ(0,"ion-content",0),Z.TgZ(1,"ion-header"),Z.TgZ(2,"ion-toolbar"),Z.TgZ(3,"ion-buttons",1),Z._UZ(4,"ion-menu-button"),Z.qZA(),Z.TgZ(5,"ion-title"),Z.TgZ(6,"ion-label"),Z._uU(7),Z.ALo(8,"translate"),Z.qZA(),Z.qZA(),Z.TgZ(9,"ion-buttons",2),Z.TgZ(10,"ion-icon",3),Z.NdJ("click",function(e){return t.openLanguagePopover(e)}),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.TgZ(11,"div",4),Z.TgZ(12,"div",5),Z.TgZ(13,"ion-text"),Z.TgZ(14,"div",6),Z.TgZ(15,"form",7),Z.YNc(16,P,4,2,"div",8),Z.YNc(17,w,3,2,"div",9),Z.YNc(18,_,8,2,"div",8),Z.YNc(19,U,6,3,"div",10),Z.YNc(20,N,18,9,"div",11),Z._UZ(21,"hr"),Z.YNc(22,M,9,9,"div",12),Z.YNc(23,I,7,7,"ion-item",13),Z.YNc(24,D,5,3,"ion-item",14),Z.YNc(25,E,12,7,"div",9),Z.TgZ(26,"div",15),Z.TgZ(27,"div",16),Z.YNc(28,G,5,9,"button",17),Z.qZA(),Z.qZA(),Z.qZA(),Z.YNc(29,F,4,3,"div",18),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.qZA(),Z.YNc(30,K,7,2,"ion-footer",19)),2&e&&(Z.xp6(7),Z.Oqu(Z.lcZ(8,14,"Travel")),Z.xp6(8),Z.Q6J("formGroup",t.form),Z.xp6(1),Z.Q6J("ngIf",0==t.isCompleted),Z.xp6(1),Z.Q6J("ngIf",0==t.isCompleted),Z.xp6(1),Z.Q6J("ngIf",1==t.isCompleted),Z.xp6(1),Z.Q6J("ngIf",0==t.isCompleted),Z.xp6(1),Z.Q6J("ngIf",0==t.isCompleted),Z.xp6(2),Z.Q6J("ngIf",0==t.isCompleted),Z.xp6(1),Z.Q6J("ngIf",0==t.isCompleted),Z.xp6(1),Z.Q6J("ngIf",0==t.isCompleted),Z.xp6(1),Z.Q6J("ngIf","Waiting"==t.orderStatus),Z.xp6(3),Z.Q6J("ngIf",0==t.isCompleted),Z.xp6(1),Z.Q6J("ngIf",1==t.isCompleted),Z.xp6(1),Z.Q6J("ngIf",1==t.isCompleted))},directives:[u.W2,u.Gu,u.sr,u.Sm,u.fG,u.wd,u.Q$,u.gu,u.yW,s.Y7,s.JL,s.sg,c.O5,u.nz,u.w,s.JJ,s.u,c.PC,u.Ie,u.x4,u.QI,u.pK,u.j9,u.fr],pipes:[k.X$,c.JJ],styles:["ion-content[_ngcontent-%COMP%]{--ion-background-color:#e9e9e9}ion-toolbar[_ngcontent-%COMP%]{--ion-background-color:#eee}ion-title[_ngcontent-%COMP%]{text-align:center}#normal[_ngcontent-%COMP%]{border-radius:20px}#comfort[_ngcontent-%COMP%]{border:3px solid #6d6d6d;border-radius:20px}.noScroll[_ngcontent-%COMP%]{overflow:hidden}#marker[_ngcontent-%COMP%]{position:absolute;background:url(http://maps.gstatic.com/mapfiles/markers2/marker.png) no-repeat;top:50%;left:50%;z-index:1;margin-left:-10px;margin-top:-34px;height:34px;width:20px;cursor:pointer}#map[_ngcontent-%COMP%]{height:100%;width:100%}#toolbarIcon[_ngcontent-%COMP%]{font-size:1.7em}.centered[_ngcontent-%COMP%]{text-align:center}.textTravel[_ngcontent-%COMP%]{font-size:1.5em}.text[_ngcontent-%COMP%], .textTravel[_ngcontent-%COMP%]{font-family:Open Sans Light}.text[_ngcontent-%COMP%]{font-size:1.4em}.checkbox-icon[_ngcontent-%COMP%]{color:#fff}ion-select[_ngcontent-%COMP%]{color:#383838;background-color:#fff;border-radius:10px;border:3px solid #eee}.blink_me[_ngcontent-%COMP%]{-webkit-animation:blinker 1s linear infinite;animation:blinker 1s linear infinite}@-webkit-keyframes blinker{50%{opacity:0}}@keyframes blinker{50%{opacity:0}}.backIcon[_ngcontent-%COMP%]{font-size:150%}.back[_ngcontent-%COMP%], .backIcon[_ngcontent-%COMP%]{color:#ffae00}.fonted[_ngcontent-%COMP%]{font-family:Open Sans Light}.icn[_ngcontent-%COMP%]{margin-top:4px}.date[_ngcontent-%COMP%], .icn[_ngcontent-%COMP%]{font-size:20px}.date[_ngcontent-%COMP%]{line-height:9px;font-family:Roboto,FontAwesome,Material Icons;margin-right:3%}.timebtn[_ngcontent-%COMP%]{margin-top:8px;height:38px}"]}),R)}],Q=function(){var e=function e(){i(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Z.oAB({type:e}),e.\u0275inj=Z.cJS({imports:[[l.Bz.forChild(V)],l.Bz]}),e}(),B=o(1841),H=o(2472),z=o(3577);function W(e){return new H.w(e)}var X,$=((X=function e(){i(this,e)}).\u0275fac=function(e){return new(e||X)},X.\u0275mod=Z.oAB({type:X}),X.\u0275inj=Z.cJS({providers:[k.sK],imports:[[c.ez,s.u5,u.Pc,Q,s.UX,k.aw.forChild({loader:{provide:k.Zw,useFactory:W,deps:[B.eN]}}),z.LanguagePopoverPageModule]]}),X)}}])}();