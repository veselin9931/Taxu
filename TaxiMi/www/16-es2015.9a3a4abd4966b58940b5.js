(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"8k+r":function(e,r,t){"use strict";t.d(r,"a",function(){return p});var i=t("z6cu"),s=t("JIr8"),o=t("vkgz"),n=t("AytR"),a=t("fXoL"),c=t("tk/3"),d=t("Dsd+");let p=(()=>{class e{constructor(e,r){this.http=e,this.sharedService=r,this.orders=[],this.completedOrder=!1}createOrder(e){const r=this.sharedService.headerGerneration();return this.http.post(`${n.a.apiUrl}/api/order`,e,{headers:r,responseType:"text"}).pipe(Object(s.a)(this.handleError))}addToFavourites(e){const r=this.sharedService.headerGerneration();return this.http.post(`${n.a.apiUrl}/api/order/favourites`,e,{headers:r,responseType:"text"}).pipe(Object(s.a)(this.handleError))}getMyFavourites(e){const r=this.sharedService.headerGerneration();return this.http.get(`${n.a.apiUrl}/api/order/favourites/${e}`,{headers:r}).pipe(Object(s.a)(this.handleError))}deleteFavouriteOrder(e){const r=this.sharedService.headerGerneration();return this.http.delete(`${n.a.apiUrl}/api/order/favourites/${e}`,{headers:r}).pipe(Object(o.a)(e=>console.log("deleted favourite order: ",JSON.stringify(e))),Object(s.a)(this.handleError))}getDirections(e,r,t,i){const o=this.sharedService.headerGerneration();return this.http.post(`https://maps.googleapis.com/maps/api/distancematrix/json?units=imperial&origins=${e},${r}&destinations=${t}%2C${i}%7C&key=AIzaSyAEvlXdM4joG4bNVT5l-tJSk9lUSGhxMNw`,{headers:o,responseType:"text"}).pipe(Object(s.a)(this.handleError))}getOrderById(e){const r=this.sharedService.headerGerneration();return this.http.get(`${n.a.apiUrl}/api/order/id/${e}`,{headers:r}).pipe(Object(o.a)(e=>this.order=e))}getCanceledOrderById(e){const r=this.sharedService.headerGerneration();return this.http.get(`${n.a.apiUrl}/api/order/canceled/${e}`,{headers:r}).pipe(Object(o.a)(e=>this.order=e))}getLastCompletedOrder(e){const r=this.sharedService.headerGerneration();return this.http.get(`${n.a.apiUrl}/api/order/completed/${e}`,{headers:r}).pipe(Object(s.a)(this.handleError))}getMyOrder(e){const r=this.sharedService.headerGerneration();return this.http.get(`${n.a.apiUrl}/api/order/${e}`,{headers:r}).pipe(Object(s.a)(this.handleError))}getOrderForChat(e){const r=this.sharedService.headerGerneration();return this.http.get(`${n.a.apiUrl}/api/order/chat/${e}`,{headers:r}).pipe(Object(s.a)(this.handleError))}getAllOrders(){const e=this.sharedService.headerGerneration();return this.http.get(`${n.a.apiUrl}/api/order`,{headers:e}).pipe(Object(s.a)(this.handleError))}getNormalOrders(){const e=this.sharedService.headerGerneration();return this.http.get(`${n.a.apiUrl}/api/order/normal`,{headers:e}).pipe(Object(s.a)(this.handleError))}getComfortOrders(){const e=this.sharedService.headerGerneration();return this.http.get(`${n.a.apiUrl}/api/order/comfort`,{headers:e}).pipe(Object(s.a)(this.handleError))}acceptOrder(e,r){const t=this.sharedService.headerGerneration();return this.http.put(`${n.a.apiUrl}/api/order/${e}/${r}`,{headers:t,responseType:"json"}).pipe(Object(o.a)(e=>this.driverId=r),Object(s.a)(this.handleError))}updateOrderEta(e,r){const t=this.sharedService.headerGerneration();return this.http.put(`${n.a.apiUrl}/api/order/eta/${e}/${r}`,{headers:t,responseType:"json"}).pipe(Object(s.a)(this.handleError))}updateDriverArrived(e){const r=this.sharedService.headerGerneration();return this.http.put(`${n.a.apiUrl}/api/order/arrived/${e}`,{headers:r,responseType:"json"}).pipe(Object(s.a)(this.handleError))}rateOrder(e){const r=this.sharedService.headerGerneration();return this.http.put(`${n.a.apiUrl}/api/order/rate/${e}`,{headers:r,responseType:"json"}).pipe(Object(s.a)(this.handleError))}increaseOrderPrice(e,r){const t=this.sharedService.headerGerneration();return this.http.put(`${n.a.apiUrl}/api/order/increase/${e}/${r}`,{headers:t,responseType:"json"}).pipe(Object(s.a)(this.handleError))}completeOrder(e){const r=this.sharedService.headerGerneration();return this.http.put(`${n.a.apiUrl}/api/order/${e}`,{headers:r,responseType:"json"}).pipe(Object(s.a)(this.handleError))}deleteOrder(e){const r=this.sharedService.headerGerneration();return this.http.delete(`${n.a.apiUrl}/api/order/${e}`,{headers:r}).pipe(Object(o.a)(e=>console.log("deleted order: ",JSON.stringify(e))),Object(s.a)(this.handleError))}driverIncreaseOrderPrice(e,r,t){const i=this.sharedService.headerGerneration();return this.http.put(`${n.a.apiUrl}/api/order/increased/${e}/${r}/${t}`,{headers:i,responseType:"json"}).pipe(Object(s.a)(this.handleError))}resetIncreasing(e){const r=this.sharedService.headerGerneration();return this.http.put(`${n.a.apiUrl}/api/order/reset/${e}`,{headers:r,responseType:"json"}).pipe(Object(s.a)(this.handleError))}increasedOrderAccept(e,r){const t=this.sharedService.headerGerneration();return this.http.put(`${n.a.apiUrl}/api/order/accepted/increase/${e}/${r}`,{headers:t,responseType:"json"}).pipe(Object(s.a)(this.handleError))}incrementOrderPrice(e){const r=this.sharedService.headerGerneration();return this.http.put(`${n.a.apiUrl}/api/order/increment/${e}`,{headers:r,responseType:"json"}).pipe(Object(s.a)(this.handleError))}decrementOrderPrice(e){const r=this.sharedService.headerGerneration();return this.http.put(`${n.a.apiUrl}/api/order/decrement/${e}`,{headers:r,responseType:"json"}).pipe(Object(s.a)(this.handleError))}handleError(e){let r="";return e.error instanceof ErrorEvent?(console.log("Client side error."),r=`Error: ${e.error.message}`):(console.log("Server side error."),r=`Error Code: ${e.status}\nMessage: ${e.message}`),console.log(r),Object(i.a)(r)}}return e.\u0275fac=function(r){return new(r||e)(a.Rb(c.a),a.Rb(d.a))},e.\u0275prov=a.Gb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},LVab:function(e,r,t){"use strict";t.r(r),t.d(r,"HttpLoaderFactory",function(){return z}),t.d(r,"ReportPageModule",function(){return x});var i=t("ofXK"),s=t("3Pt+"),o=t("TEn/"),n=t("tyNb"),a=t("mrSG"),c=t("oXKM"),d=t("fXoL"),p=t("z6cu"),h=t("JIr8"),l=t("AytR"),b=t("tk/3"),u=t("Dsd+");let v=(()=>{class e{constructor(e,r){this.http=e,this.sharedService=r}createReport(e){const r=this.sharedService.headerGerneration();return this.http.post(`${l.a.apiUrl}/api/report`,e,{headers:r,responseType:"text"}).pipe(Object(h.a)(this.handleError))}handleError(e){let r="";return e.error instanceof ErrorEvent?(console.log("Client side error."),r=`Error: ${e.error.message}`):(console.log("Server side error."),r=`Error Code: ${e.status}\nMessage: ${e.message}`),console.log(r),Object(p.a)(r)}}return e.\u0275fac=function(r){return new(r||e)(d.Rb(b.a),d.Rb(u.a))},e.\u0275prov=d.Gb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var f=t("exMm"),m=t("8Xdb"),g=t("8k+r"),O=t("sYmb");function I(e,r){1&e&&(d.Nb(0,"div"),d.pc(1),d.Yb(2,"translate"),d.Mb()),2&e&&(d.zb(1),d.rc("",d.Zb(2,1,"The field is required"),"!"))}function y(e,r){if(1&e&&(d.Nb(0,"div",25),d.oc(1,I,3,3,"div",26),d.Mb()),2&e){const e=d.Xb();d.zb(1),d.dc("ngIf",e.f.typeId.errors.required)}}function $(e,r){if(1&e&&(d.Nb(0,"div",27),d.Nb(1,"ion-text",8),d.Nb(2,"h4",9),d.pc(3),d.Yb(4,"translate"),d.Mb(),d.Mb(),d.Lb(5,"ion-input",28),d.Mb()),2&e){const e=d.Xb();d.zb(3),d.qc(d.Zb(4,3,"Last user")),d.zb(2),d.fc("value","",e.userFirstName," ",e.userLastName,"")}}function M(e,r){1&e&&(d.Nb(0,"div"),d.pc(1),d.Yb(2,"translate"),d.Mb()),2&e&&(d.zb(1),d.rc("",d.Zb(2,1,"The field is required"),"!"))}function S(e,r){if(1&e&&(d.Nb(0,"div",29),d.oc(1,M,3,3,"div",26),d.Mb()),2&e){const e=d.Xb();d.zb(1),d.dc("ngIf",e.f.title.errors.required)}}function N(e,r){1&e&&(d.Nb(0,"div"),d.pc(1),d.Yb(2,"translate"),d.Mb()),2&e&&(d.zb(1),d.rc("",d.Zb(2,1,"The field is required"),"!"))}function j(e,r){if(1&e&&(d.Nb(0,"div",29),d.oc(1,N,3,3,"div",26),d.Mb()),2&e){const e=d.Xb();d.zb(1),d.dc("ngIf",e.f.description.errors.required)}}const C=function(e){return{"is-invalid":e}},E=[{path:"",component:(()=>{class e{constructor(e,r,t,i,s,o,n,a,c,d){this.reportService=e,this.route=r,this.formBuilder=t,this.driverService=i,this.accountService=s,this.location=o,this.orderService=n,this.alertController=a,this.translate=c,this.popoverController=d,this.subscriptions=[],this.submitted=!1,this.loading=!1,this.userId=this.accountService.userValue.id,this.translate.setDefaultLang(this.accountService.userValue.choosenLanguage)}ngOnInit(){this.form=this.formBuilder.group({title:["",s.n.required],description:["",s.n.required],reporterId:[""],suspectedUserId:[""],typeId:[""]})}get f(){return this.form.controls}reportType(e){this.selectedReportType=e,1==this.selectedReportType&&this.subscriptions.push(this.accountService.getById(this.userId).subscribe(e=>{this.isDriver=e.isDriver,this.subscriptions.push(e.isDriver?this.orderService.getLastCompletedOrder(this.userId).subscribe(e=>{this.lastOrder=e,this.subscriptions.push(this.accountService.getById(e.applicationUserId).subscribe(e=>{this.userFirstName=e.firstName,this.userLastName=e.lastName,this.suspectedUserId=this.lastOrder.applicationUserId,this.reporterId=this.userId}))}):this.orderService.getLastCompletedOrder(this.userId).subscribe(e=>{this.lastOrder=e,this.subscriptions.push(this.accountService.getById(e.acceptedBy).subscribe(e=>{this.userFirstName=e.firstName,this.userLastName=e.lastName,this.subscriptions.push(this.driverService.getDriverActiveCar(e.driverId).subscribe(r=>{this.carModel=r.model,this.form.value.typeId=+this.form.value.typeId,this.suspectedUserId=e.driverId,this.reporterId=this.userId}))}))}))}))}onSubmit(){this.submitted=!0,this.form.valid?(this.form.value.typeId=+this.form.value.typeId,1==this.form.value.typeId?(this.form.value.suspectedUserId=this.suspectedUserId,this.form.value.reporterId=this.reporterId,this.subscriptions.push(this.reportService.createReport(this.form.value).subscribe(e=>{console.log("report created:"),console.log(e),this.reportCompleted(),this.clearForm()}))):(this.form.value.reporterId=this.userId,this.subscriptions.push(this.reportService.createReport(this.form.value).subscribe(e=>{console.log("report created:"),console.log(e),this.reportCompleted(),this.clearForm()}))),console.log(this.form.value)):console.log("Please provide all the required values!")}openLanguagePopover(e){return Object(a.a)(this,void 0,void 0,function*(){const r=yield this.popoverController.create({component:c.a,event:e});yield r.present()})}reportCompleted(){return Object(a.a)(this,void 0,void 0,function*(){this.translate.get(["Report","Your report is sent successfully","Confirm"]).subscribe(e=>Object(a.a)(this,void 0,void 0,function*(){const r=yield this.alertController.create({message:e["Your report is sent successfully"],buttons:[{text:e.Confirm,handler:()=>{this.route.navigate(1==this.isDriver?["menu/driving"]:["menu/travelling"])}}]});yield r.present()}))})}clearForm(){this.form.reset({title:"",description:"",typeId:"",suspectedDriverId:"",reporterId:""})}goBack(){this.location.back()}}return e.\u0275fac=function(r){return new(r||e)(d.Kb(v),d.Kb(n.f),d.Kb(s.b),d.Kb(f.a),d.Kb(m.a),d.Kb(i.h),d.Kb(g.a),d.Kb(o.a),d.Kb(O.d),d.Kb(o.H))},e.\u0275cmp=d.Eb({type:e,selectors:[["app-report"]],decls:51,vars:41,consts:[["slot","start"],["slot","end"],["id","toolbarIcon","name","language-outline",3,"click"],["padding","",1,"background"],[1,"row"],[1,"col"],[1,"row","mt-2"],[1,"col","text-center"],["color","dark",1,"centered"],[1,"text"],["novalidate","",1,"col-md-6",3,"formGroup"],[1,"form-group","col","mt-5","text-center"],["formControlName","typeId","id","exampleFormControlSelect1",1,"form-control","text",3,"ngClass","change"],["value","","disabled","","selected","","hidden",""],["value","1"],["value","2"],["value","3"],["class","invalid-feedback text",4,"ngIf"],["class","form-group col mt-5 text-center text",4,"ngIf"],[1,"form-group","col","mt-5"],["formControlName","title","type","text",1,"form-control","text",3,"placeholder","ngClass"],["class","invalid-feedback",4,"ngIf"],["formControlName","description","type","text",1,"form-control","text",3,"placeholder","ngClass"],[1,"col-md-12","mt-3"],["type","button","color","dark",1,"btn","btn-info",3,"click"],[1,"invalid-feedback","text"],[4,"ngIf"],[1,"form-group","col","mt-5","text-center","text"],[1,"form-control",3,"value"],[1,"invalid-feedback"]],template:function(e,r){1&e&&(d.Nb(0,"ion-header"),d.Nb(1,"ion-toolbar"),d.Nb(2,"ion-buttons",0),d.Lb(3,"ion-menu-button"),d.Mb(),d.Nb(4,"ion-title"),d.Nb(5,"ion-label"),d.pc(6),d.Yb(7,"translate"),d.Mb(),d.Mb(),d.Nb(8,"ion-buttons",1),d.Nb(9,"ion-icon",2),d.Vb("click",function(e){return r.openLanguagePopover(e)}),d.Mb(),d.Mb(),d.Mb(),d.Mb(),d.Nb(10,"ion-content",3),d.Nb(11,"div",4),d.Nb(12,"div",5),d.Lb(13,"div",6),d.Nb(14,"div",4),d.Nb(15,"div",7),d.Nb(16,"ion-text",8),d.Nb(17,"h2",9),d.pc(18),d.Yb(19,"translate"),d.Mb(),d.Lb(20,"hr"),d.Mb(),d.Nb(21,"form",10),d.Nb(22,"div",11),d.Nb(23,"select",12),d.Vb("change",function(e){return r.reportType(e.target.value)}),d.Nb(24,"option",13),d.pc(25),d.Yb(26,"translate"),d.Mb(),d.Nb(27,"option",14),d.pc(28),d.Yb(29,"translate"),d.Mb(),d.Nb(30,"option",15),d.pc(31),d.Yb(32,"translate"),d.Mb(),d.Nb(33,"option",16),d.pc(34),d.Yb(35,"translate"),d.Mb(),d.Mb(),d.oc(36,y,2,1,"div",17),d.Mb(),d.oc(37,$,6,5,"div",18),d.Nb(38,"div",19),d.Lb(39,"ion-input",20),d.Yb(40,"translate"),d.oc(41,S,2,1,"div",21),d.Mb(),d.Nb(42,"div",19),d.Nb(43,"textarea",22),d.Yb(44,"translate"),d.pc(45,"                "),d.Mb(),d.oc(46,j,2,1,"div",21),d.Mb(),d.Nb(47,"div",23),d.Nb(48,"button",24),d.Vb("click",function(){return r.onSubmit()}),d.pc(49),d.Yb(50,"translate"),d.Mb(),d.Mb(),d.Mb(),d.Mb(),d.Mb(),d.Mb(),d.Mb(),d.Mb()),2&e&&(d.zb(6),d.qc(d.Zb(7,17,"Report")),d.zb(12),d.qc(d.Zb(19,19,"Report a problem")),d.zb(3),d.dc("formGroup",r.form),d.zb(2),d.dc("ngClass",d.gc(35,C,r.submitted&&r.f.typeId.errors)),d.zb(2),d.qc(d.Zb(26,21,"Choose report type")),d.zb(3),d.qc(d.Zb(29,23,"Complaint")),d.zb(3),d.qc(d.Zb(32,25,"Technical")),d.zb(3),d.qc(d.Zb(35,27,"Other")),d.zb(2),d.dc("ngIf",r.submitted&&r.f.typeId.errors),d.zb(1),d.dc("ngIf",1==r.selectedReportType),d.zb(2),d.dc("placeholder",d.Zb(40,29,"Title"))("ngClass",d.gc(37,C,r.submitted&&r.f.title.errors)),d.zb(2),d.dc("ngIf",r.submitted&&r.f.title.errors),d.zb(2),d.dc("placeholder",d.Zb(44,31,"Description"))("ngClass",d.gc(39,C,r.submitted&&r.f.description.errors)),d.zb(3),d.dc("ngIf",r.submitted&&r.f.description.errors),d.zb(3),d.qc(d.Zb(50,33,"Submit")))},directives:[o.l,o.B,o.e,o.s,o.A,o.p,o.m,o.i,o.z,s.o,s.i,s.d,s.m,s.h,s.c,i.j,s.k,s.p,i.l,o.n,o.K,s.a],pipes:[O.c],styles:["ion-content[_ngcontent-%COMP%]{--ion-background-color:#e9e9e9}.centered[_ngcontent-%COMP%]{text-align:center}.text[_ngcontent-%COMP%]{font-family:Open Sans Light}hr[_ngcontent-%COMP%]{background:#eee;width:70%!important}.backIcon[_ngcontent-%COMP%]{font-size:150%}.back[_ngcontent-%COMP%], .backIcon[_ngcontent-%COMP%]{color:#ffae00}ion-toolbar[_ngcontent-%COMP%]{--ion-background-color:#eee}ion-title[_ngcontent-%COMP%]{text-align:center}#toolbarIcon[_ngcontent-%COMP%]{font-size:1.7em}"]}),e})()}];let G=(()=>{class e{}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=d.Ib({type:e}),e.\u0275inj=d.Hb({imports:[[n.h.forChild(E)],n.h]}),e})();var U=t("mqiu"),k=t("QhVT");function z(e){return new U.a(e)}let x=(()=>{class e{}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=d.Ib({type:e}),e.\u0275inj=d.Hb({imports:[[i.b,s.e,o.C,G,s.l,O.b.forChild({loader:{provide:O.a,useFactory:z,deps:[b.a]}}),k.LanguagePopoverPageModule]]}),e})()}}]);