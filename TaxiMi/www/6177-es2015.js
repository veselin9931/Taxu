(self.webpackChunkcsharpcornerauthor=self.webpackChunkcsharpcornerauthor||[]).push([[6177],{297:function(e,r,t){"use strict";t.d(r,{p:function(){return c}});var i=t(205),s=t(5304),o=t(3342),n=t(2340),a=t(3018),d=t(1841),p=t(728);let c=(()=>{class e{constructor(e,r){this.http=e,this.sharedService=r,this.orders=[],this.completedOrder=!1}createOrder(e){const r=this.sharedService.headerGerneration();return this.http.post(`${n.N.apiUrl}/api/order`,e,{headers:r,responseType:"text"}).pipe((0,s.K)(this.handleError))}addToFavourites(e){const r=this.sharedService.headerGerneration();return this.http.post(`${n.N.apiUrl}/api/order/favourites`,e,{headers:r,responseType:"text"}).pipe((0,s.K)(this.handleError))}getMyFavourites(e){const r=this.sharedService.headerGerneration();return this.http.get(`${n.N.apiUrl}/api/order/favourites/${e}`,{headers:r}).pipe((0,s.K)(this.handleError))}deleteFavouriteOrder(e){const r=this.sharedService.headerGerneration();return this.http.delete(`${n.N.apiUrl}/api/order/favourites/${e}`,{headers:r}).pipe((0,o.b)(e=>console.log("deleted favourite order: ",JSON.stringify(e))),(0,s.K)(this.handleError))}getDirections(e,r,t,i){const o=this.sharedService.headerGerneration();return this.http.post(`https://maps.googleapis.com/maps/api/distancematrix/json?units=imperial&origins=${e},${r}&destinations=${t}%2C${i}%7C&key=AIzaSyAEvlXdM4joG4bNVT5l-tJSk9lUSGhxMNw`,{headers:o,responseType:"text"}).pipe((0,s.K)(this.handleError))}getOrderById(e){const r=this.sharedService.headerGerneration();return this.http.get(`${n.N.apiUrl}/api/order/id/${e}`,{headers:r}).pipe((0,o.b)(e=>this.order=e))}getCanceledOrderById(e){const r=this.sharedService.headerGerneration();return this.http.get(`${n.N.apiUrl}/api/order/canceled/${e}`,{headers:r}).pipe((0,o.b)(e=>this.order=e))}getLastCompletedOrder(e){const r=this.sharedService.headerGerneration();return this.http.get(`${n.N.apiUrl}/api/order/completed/${e}`,{headers:r}).pipe((0,s.K)(this.handleError))}getMyOrder(e){const r=this.sharedService.headerGerneration();return this.http.get(`${n.N.apiUrl}/api/order/${e}`,{headers:r}).pipe((0,s.K)(this.handleError))}getOrderForChat(e){const r=this.sharedService.headerGerneration();return this.http.get(`${n.N.apiUrl}/api/order/chat/${e}`,{headers:r}).pipe((0,s.K)(this.handleError))}getAllOrders(){const e=this.sharedService.headerGerneration();return this.http.get(`${n.N.apiUrl}/api/order`,{headers:e}).pipe((0,s.K)(this.handleError))}getNormalOrders(){const e=this.sharedService.headerGerneration();return this.http.get(`${n.N.apiUrl}/api/order/normal`,{headers:e}).pipe((0,s.K)(this.handleError))}getComfortOrders(){const e=this.sharedService.headerGerneration();return this.http.get(`${n.N.apiUrl}/api/order/comfort`,{headers:e}).pipe((0,s.K)(this.handleError))}acceptOrder(e,r){const t=this.sharedService.headerGerneration();return this.http.put(`${n.N.apiUrl}/api/order/${e}/${r}`,{headers:t,responseType:"json"}).pipe((0,o.b)(e=>this.driverId=r),(0,s.K)(this.handleError))}updateOrderEta(e,r){const t=this.sharedService.headerGerneration();return this.http.put(`${n.N.apiUrl}/api/order/eta/${e}/${r}`,{headers:t,responseType:"json"}).pipe((0,s.K)(this.handleError))}updateDriverArrived(e){const r=this.sharedService.headerGerneration();return this.http.put(`${n.N.apiUrl}/api/order/arrived/${e}`,{headers:r,responseType:"json"}).pipe((0,s.K)(this.handleError))}rateOrder(e){const r=this.sharedService.headerGerneration();return this.http.put(`${n.N.apiUrl}/api/order/rate/${e}`,{headers:r,responseType:"json"}).pipe((0,s.K)(this.handleError))}increaseOrderPrice(e,r){const t=this.sharedService.headerGerneration();return this.http.put(`${n.N.apiUrl}/api/order/increase/${e}/${r}`,{headers:t,responseType:"json"}).pipe((0,s.K)(this.handleError))}completeOrder(e){const r=this.sharedService.headerGerneration();return this.http.put(`${n.N.apiUrl}/api/order/${e}`,{headers:r,responseType:"json"}).pipe((0,s.K)(this.handleError))}deleteOrder(e){const r=this.sharedService.headerGerneration();return this.http.delete(`${n.N.apiUrl}/api/order/${e}`,{headers:r}).pipe((0,o.b)(e=>console.log("deleted order: ",JSON.stringify(e))),(0,s.K)(this.handleError))}driverIncreaseOrderPrice(e,r,t){const i=this.sharedService.headerGerneration();return this.http.put(`${n.N.apiUrl}/api/order/increased/${e}/${r}/${t}`,{headers:i,responseType:"json"}).pipe((0,s.K)(this.handleError))}resetIncreasing(e){const r=this.sharedService.headerGerneration();return this.http.put(`${n.N.apiUrl}/api/order/reset/${e}`,{headers:r,responseType:"json"}).pipe((0,s.K)(this.handleError))}increasedOrderAccept(e,r){const t=this.sharedService.headerGerneration();return this.http.put(`${n.N.apiUrl}/api/order/accepted/increase/${e}/${r}`,{headers:t,responseType:"json"}).pipe((0,s.K)(this.handleError))}incrementOrderPrice(e){const r=this.sharedService.headerGerneration();return this.http.put(`${n.N.apiUrl}/api/order/increment/${e}`,{headers:r,responseType:"json"}).pipe((0,s.K)(this.handleError))}decrementOrderPrice(e){const r=this.sharedService.headerGerneration();return this.http.put(`${n.N.apiUrl}/api/order/decrement/${e}`,{headers:r,responseType:"json"}).pipe((0,s.K)(this.handleError))}handleError(e){let r="";return e.error instanceof ErrorEvent?(console.log("Client side error."),r=`Error: ${e.error.message}`):(console.log("Server side error."),r=`Error Code: ${e.status}\nMessage: ${e.message}`),console.log(r),(0,i._)(r)}}return e.\u0275fac=function(r){return new(r||e)(a.LFG(d.eN),a.LFG(p.F))},e.\u0275prov=a.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},6177:function(e,r,t){"use strict";t.r(r),t.d(r,{HttpLoaderFactory:function(){return G},ReportPageModule:function(){return E}});var i=t(8583),s=t(3679),o=t(7823),n=t(4481),a=t(4762),d=t(6522),p=t(3018),c=t(205),h=t(5304),l=t(2340),u=t(1841),g=t(728);let v=(()=>{class e{constructor(e,r){this.http=e,this.sharedService=r}createReport(e){const r=this.sharedService.headerGerneration();return this.http.post(`${l.N.apiUrl}/api/report`,e,{headers:r,responseType:"text"}).pipe((0,h.K)(this.handleError))}handleError(e){let r="";return e.error instanceof ErrorEvent?(console.log("Client side error."),r=`Error: ${e.error.message}`):(console.log("Server side error."),r=`Error Code: ${e.status}\nMessage: ${e.message}`),console.log(r),(0,c._)(r)}}return e.\u0275fac=function(r){return new(r||e)(p.LFG(u.eN),p.LFG(g.F))},e.\u0275prov=p.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var f=t(1799),m=t(5056),Z=t(297),b=t(7800);function I(e,r){1&e&&(p.TgZ(0,"div"),p._uU(1),p.ALo(2,"translate"),p.qZA()),2&e&&(p.xp6(1),p.hij("",p.lcZ(2,1,"The field is required"),"!"))}function y(e,r){if(1&e&&(p.TgZ(0,"div",25),p.YNc(1,I,3,3,"div",26),p.qZA()),2&e){const e=p.oxw();p.xp6(1),p.Q6J("ngIf",e.f.typeId.errors.required)}}function $(e,r){if(1&e&&(p.TgZ(0,"div",27),p.TgZ(1,"ion-text",8),p.TgZ(2,"h4",9),p._uU(3),p.ALo(4,"translate"),p.qZA(),p.qZA(),p._UZ(5,"ion-input",28),p.qZA()),2&e){const e=p.oxw();p.xp6(3),p.Oqu(p.lcZ(4,3,"Last user")),p.xp6(2),p.hYB("value","",e.userFirstName," ",e.userLastName,"")}}function T(e,r){1&e&&(p.TgZ(0,"div"),p._uU(1),p.ALo(2,"translate"),p.qZA()),2&e&&(p.xp6(1),p.hij("",p.lcZ(2,1,"The field is required"),"!"))}function N(e,r){if(1&e&&(p.TgZ(0,"div",29),p.YNc(1,T,3,3,"div",26),p.qZA()),2&e){const e=p.oxw();p.xp6(1),p.Q6J("ngIf",e.f.title.errors.required)}}function S(e,r){1&e&&(p.TgZ(0,"div"),p._uU(1),p.ALo(2,"translate"),p.qZA()),2&e&&(p.xp6(1),p.hij("",p.lcZ(2,1,"The field is required"),"!"))}function q(e,r){if(1&e&&(p.TgZ(0,"div",29),p.YNc(1,S,3,3,"div",26),p.qZA()),2&e){const e=p.oxw();p.xp6(1),p.Q6J("ngIf",e.f.description.errors.required)}}const A=function(e){return{"is-invalid":e}},x=[{path:"",component:(()=>{class e{constructor(e,r,t,i,s,o,n,a,d,p){this.reportService=e,this.route=r,this.formBuilder=t,this.driverService=i,this.accountService=s,this.location=o,this.orderService=n,this.alertController=a,this.translate=d,this.popoverController=p,this.subscriptions=[],this.submitted=!1,this.loading=!1,this.userId=this.accountService.userValue.id,this.translate.setDefaultLang(this.accountService.userValue.choosenLanguage)}ngOnInit(){this.form=this.formBuilder.group({title:["",s.kI.required],description:["",s.kI.required],reporterId:[""],suspectedUserId:[""],typeId:[""]})}get f(){return this.form.controls}reportType(e){this.selectedReportType=e,1==this.selectedReportType&&this.subscriptions.push(this.accountService.getById(this.userId).subscribe(e=>{this.isDriver=e.isDriver,this.subscriptions.push(e.isDriver?this.orderService.getLastCompletedOrder(this.userId).subscribe(e=>{this.lastOrder=e,this.subscriptions.push(this.accountService.getById(e.applicationUserId).subscribe(e=>{this.userFirstName=e.firstName,this.userLastName=e.lastName,this.suspectedUserId=this.lastOrder.applicationUserId,this.reporterId=this.userId}))}):this.orderService.getLastCompletedOrder(this.userId).subscribe(e=>{this.lastOrder=e,this.subscriptions.push(this.accountService.getById(e.acceptedBy).subscribe(e=>{this.userFirstName=e.firstName,this.userLastName=e.lastName,this.subscriptions.push(this.driverService.getDriverActiveCar(e.driverId).subscribe(r=>{this.carModel=r.model,this.form.value.typeId=+this.form.value.typeId,this.suspectedUserId=e.driverId,this.reporterId=this.userId}))}))}))}))}onSubmit(){this.submitted=!0,this.form.valid?(this.form.value.typeId=+this.form.value.typeId,1==this.form.value.typeId?(this.form.value.suspectedUserId=this.suspectedUserId,this.form.value.reporterId=this.reporterId,this.subscriptions.push(this.reportService.createReport(this.form.value).subscribe(e=>{console.log("report created:"),console.log(e),this.reportCompleted(),this.clearForm()}))):(this.form.value.reporterId=this.userId,this.subscriptions.push(this.reportService.createReport(this.form.value).subscribe(e=>{console.log("report created:"),console.log(e),this.reportCompleted(),this.clearForm()}))),console.log(this.form.value)):console.log("Please provide all the required values!")}openLanguagePopover(e){return(0,a.mG)(this,void 0,void 0,function*(){const r=yield this.popoverController.create({component:d.m,event:e});yield r.present()})}reportCompleted(){return(0,a.mG)(this,void 0,void 0,function*(){this.translate.get(["Report","Your report is sent successfully","Confirm"]).subscribe(e=>(0,a.mG)(this,void 0,void 0,function*(){const r=yield this.alertController.create({message:e["Your report is sent successfully"],buttons:[{text:e.Confirm,handler:()=>{this.route.navigate(1==this.isDriver?["menu/driving"]:["menu/travelling"])}}]});yield r.present()}))})}clearForm(){this.form.reset({title:"",description:"",typeId:"",suspectedDriverId:"",reporterId:""})}goBack(){this.location.back()}}return e.\u0275fac=function(r){return new(r||e)(p.Y36(v),p.Y36(n.F0),p.Y36(s.qu),p.Y36(f.F),p.Y36(m.B),p.Y36(i.Ye),p.Y36(Z.p),p.Y36(o.Br),p.Y36(b.sK),p.Y36(o.Dh))},e.\u0275cmp=p.Xpm({type:e,selectors:[["app-report"]],decls:51,vars:41,consts:[["slot","start"],["slot","end"],["id","toolbarIcon","name","language-outline",3,"click"],["padding","",1,"background"],[1,"row"],[1,"col"],[1,"row","mt-2"],[1,"col","text-center"],["color","dark",1,"centered"],[1,"text"],["novalidate","",1,"col-md-6",3,"formGroup"],[1,"form-group","col","mt-5","text-center"],["formControlName","typeId","id","exampleFormControlSelect1",1,"form-control","text",3,"ngClass","change"],["value","","disabled","","selected","","hidden",""],["value","1"],["value","2"],["value","3"],["class","invalid-feedback text",4,"ngIf"],["class","form-group col mt-5 text-center text",4,"ngIf"],[1,"form-group","col","mt-5"],["formControlName","title","type","text",1,"form-control","text",3,"placeholder","ngClass"],["class","invalid-feedback",4,"ngIf"],["formControlName","description","type","text",1,"form-control","text",3,"placeholder","ngClass"],[1,"col-md-12","mt-3"],["type","button","color","dark",1,"btn","btn-info",3,"click"],[1,"invalid-feedback","text"],[4,"ngIf"],[1,"form-group","col","mt-5","text-center","text"],[1,"form-control",3,"value"],[1,"invalid-feedback"]],template:function(e,r){1&e&&(p.TgZ(0,"ion-header"),p.TgZ(1,"ion-toolbar"),p.TgZ(2,"ion-buttons",0),p._UZ(3,"ion-menu-button"),p.qZA(),p.TgZ(4,"ion-title"),p.TgZ(5,"ion-label"),p._uU(6),p.ALo(7,"translate"),p.qZA(),p.qZA(),p.TgZ(8,"ion-buttons",1),p.TgZ(9,"ion-icon",2),p.NdJ("click",function(e){return r.openLanguagePopover(e)}),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(10,"ion-content",3),p.TgZ(11,"div",4),p.TgZ(12,"div",5),p._UZ(13,"div",6),p.TgZ(14,"div",4),p.TgZ(15,"div",7),p.TgZ(16,"ion-text",8),p.TgZ(17,"h2",9),p._uU(18),p.ALo(19,"translate"),p.qZA(),p._UZ(20,"hr"),p.qZA(),p.TgZ(21,"form",10),p.TgZ(22,"div",11),p.TgZ(23,"select",12),p.NdJ("change",function(e){return r.reportType(e.target.value)}),p.TgZ(24,"option",13),p._uU(25),p.ALo(26,"translate"),p.qZA(),p.TgZ(27,"option",14),p._uU(28),p.ALo(29,"translate"),p.qZA(),p.TgZ(30,"option",15),p._uU(31),p.ALo(32,"translate"),p.qZA(),p.TgZ(33,"option",16),p._uU(34),p.ALo(35,"translate"),p.qZA(),p.qZA(),p.YNc(36,y,2,1,"div",17),p.qZA(),p.YNc(37,$,6,5,"div",18),p.TgZ(38,"div",19),p._UZ(39,"ion-input",20),p.ALo(40,"translate"),p.YNc(41,N,2,1,"div",21),p.qZA(),p.TgZ(42,"div",19),p.TgZ(43,"textarea",22),p.ALo(44,"translate"),p._uU(45,"                "),p.qZA(),p.YNc(46,q,2,1,"div",21),p.qZA(),p.TgZ(47,"div",23),p.TgZ(48,"button",24),p.NdJ("click",function(){return r.onSubmit()}),p._uU(49),p.ALo(50,"translate"),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&e&&(p.xp6(6),p.Oqu(p.lcZ(7,17,"Report")),p.xp6(12),p.Oqu(p.lcZ(19,19,"Report a problem")),p.xp6(3),p.Q6J("formGroup",r.form),p.xp6(2),p.Q6J("ngClass",p.VKq(35,A,r.submitted&&r.f.typeId.errors)),p.xp6(2),p.Oqu(p.lcZ(26,21,"Choose report type")),p.xp6(3),p.Oqu(p.lcZ(29,23,"Complaint")),p.xp6(3),p.Oqu(p.lcZ(32,25,"Technical")),p.xp6(3),p.Oqu(p.lcZ(35,27,"Other")),p.xp6(2),p.Q6J("ngIf",r.submitted&&r.f.typeId.errors),p.xp6(1),p.Q6J("ngIf",1==r.selectedReportType),p.xp6(2),p.Q6J("placeholder",p.lcZ(40,29,"Title"))("ngClass",p.VKq(37,A,r.submitted&&r.f.title.errors)),p.xp6(2),p.Q6J("ngIf",r.submitted&&r.f.title.errors),p.xp6(2),p.Q6J("placeholder",p.lcZ(44,31,"Description"))("ngClass",p.VKq(39,A,r.submitted&&r.f.description.errors)),p.xp6(3),p.Q6J("ngIf",r.submitted&&r.f.description.errors),p.xp6(3),p.Oqu(p.lcZ(50,33,"Submit")))},directives:[o.Gu,o.sr,o.Sm,o.fG,o.wd,o.Q$,o.gu,o.W2,o.yW,s.Y7,s.JL,s.sg,s.EJ,s.JJ,s.u,i.mk,s.YN,s.$B,i.O5,o.pK,o.j9,s.Fj],pipes:[b.X$],styles:["ion-content[_ngcontent-%COMP%]{--ion-background-color:#e9e9e9}.centered[_ngcontent-%COMP%]{text-align:center}.text[_ngcontent-%COMP%]{font-family:Open Sans Light}hr[_ngcontent-%COMP%]{background:#eee;width:70%!important}.backIcon[_ngcontent-%COMP%]{font-size:150%}.back[_ngcontent-%COMP%], .backIcon[_ngcontent-%COMP%]{color:#ffae00}ion-toolbar[_ngcontent-%COMP%]{--ion-background-color:#eee}ion-title[_ngcontent-%COMP%]{text-align:center}#toolbarIcon[_ngcontent-%COMP%]{font-size:1.7em}"]}),e})()}];let U=(()=>{class e{}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=p.oAB({type:e}),e.\u0275inj=p.cJS({imports:[[n.Bz.forChild(x)],n.Bz]}),e})();var O=t(2472),C=t(3577);function G(e){return new O.w(e)}let E=(()=>{class e{}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=p.oAB({type:e}),e.\u0275inj=p.cJS({imports:[[i.ez,s.u5,o.Pc,U,s.UX,b.aw.forChild({loader:{provide:b.Zw,useFactory:G,deps:[u.eN]}}),C.LanguagePopoverPageModule]]}),e})()}}]);