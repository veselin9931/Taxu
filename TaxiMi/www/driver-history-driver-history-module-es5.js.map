{"version":3,"sources":["webpack:///src/app/driver-history/driver-history.page.html","webpack:///src/app/driver-history/driver-history.page.ts","webpack:///src/app/driver-history/driver-history.page.scss","webpack:///src/app/driver-history/driver-history.module.ts","webpack:///src/app/driver-history/driver-history-routing.module.ts"],"names":["DriverHistoryPage","driverService","accountService","locationPage","subscriptions","orders","userId","userValue","id","currentDate","Date","getHistory","connection","configureLogging","Information","withUrl","signalRUrl","build","start","then","console","log","err","toString","on","subscription","unsubscribe","push","getDriverHistory","subscribe","x","sum","forEach","order","totalPrice","dailyProfit","toFixed","back","selector","template","DriverHistoryPageModule","imports","declarations","routes","path","component","DriverHistoryPageRoutingModule","forChild","exports"],"mappings":"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","file":"driver-history-driver-history-module-es5.js","sourcesContent":["export default \"<ion-header>\\r\\n  <ion-toolbar>\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <ion-menu-button></ion-menu-button>\\r\\n    </ion-buttons>\\r\\n\\r\\n    <ion-title>\\r\\n        <ion-label>Cyber</ion-label>\\r\\n    </ion-title>\\r\\n\\r\\n    <ion-buttons slot=\\\"end\\\">\\r\\n      <ion-icon id=\\\"toolbarIcon\\\" name=\\\"language-outline\\\"></ion-icon>\\r\\n    </ion-buttons>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n<ion-content padding class=\\\"background\\\">\\r\\n  <div class=\\\"row mt-2\\\">\\r\\n    <div class=\\\"col\\\">\\r\\n      <div class=\\\"row\\\">\\r\\n        <div class=\\\"col-md-12 text-center\\\">\\r\\n          <ion-text class=\\\"centered\\\" color=\\\"light\\\">\\r\\n            <h2 class=\\\"text\\\">My history</h2>\\r\\n            <hr>\\r\\n          </ion-text>\\r\\n        </div>\\r\\n        <div class=\\\"col-md-10\\\">\\r\\n        <div class=\\\"list-group mt-2\\\">\\r\\n\\r\\n          <a class=\\\"text list-group-item list-group-item-action flex-column align-items-start\\\">\\r\\n            <div class=\\\"d-flex w-100 justify-content-between\\\">\\r\\n              <h5 class=\\\"text mb-1\\\">Daily earnings</h5>\\r\\n              <small>Today: {{currentDate |  date:'MM/dd/yyyy h:mm'}}</small>\\r\\n\\r\\n            </div>\\r\\n\\r\\n            <div class=\\\"row\\\">\\r\\n              <div class=\\\"col-md-12 text-center\\\">\\r\\n                <h5 class=\\\"text\\\">Profit: {{dailyProfit}}$</h5>\\r\\n              </div>\\r\\n            </div>\\r\\n          </a>\\r\\n        </div>\\r\\n      </div>\\r\\n        <div class=\\\"col-md-10\\\">\\r\\n          <div *ngFor=\\\"let order of orders\\\" class=\\\"list-group mt-2\\\">\\r\\n\\r\\n            <a class=\\\"text list-group-item list-group-item-action flex-column align-items-start\\\">\\r\\n              <div class=\\\"d-flex w-100 justify-content-between\\\">\\r\\n                <h5 class=\\\"text mb-1\\\">Order details</h5>\\r\\n                <small>{{order.createdOn |  date:'MM/dd/yyyy h:mm'}}</small>\\r\\n              </div>\\r\\n              <p class=\\\"mb-1 text\\\">Passenger: {{order.applicationUser.firstName}} {{order.applicationUser.lastName}}</p>\\r\\n              <p class=\\\"mb-1 text\\\">Phone number: {{order.applicationUser.phone}}</p>\\r\\n              <p class=\\\"mb-1 text\\\">Location: {{order.location}}</p>\\r\\n              <p class=\\\"mb-1 text\\\">Destination: {{order.destination}}</p>\\r\\n\\r\\n              <div class=\\\"row\\\">\\r\\n                <div class=\\\"col-md-12\\\">\\r\\n                  <small class=\\\"text\\\">Profit: {{order.totalPrice}}$</small>\\r\\n                </div>\\r\\n              </div>\\r\\n            </a>\\r\\n          </div>\\r\\n        </div>\\r\\n      </div>\\r\\n    </div>\\r\\n  </div>\\r\\n\\r\\n\\r\\n</ion-content>\";","import { Component, OnInit } from '@angular/core';\r\nimport { Order, User } from 'src/_models';\r\nimport { AccountService } from 'src/_services';\r\nimport { DriverService } from 'src/_services/driver/driver.service';\r\nimport { Location } from '@angular/common';\r\nimport * as signalR from '@aspnet/signalr';\r\nimport { environment } from 'src/environments/environment';\r\nimport { Subscription } from 'rxjs';\r\n@Component({\r\n  selector: 'app-driver-history',\r\n  templateUrl: './driver-history.page.html',\r\n  styleUrls: ['./driver-history.page.scss'],\r\n})\r\nexport class DriverHistoryPage implements OnInit {\r\n  private subscriptions: Subscription[] = [];\r\n\r\n  orders: Order[] = [];\r\n  userId = this.accountService.userValue.id;\r\n  orderer : User;\r\n  dailyProfit: string;\r\n  currentDate = new Date();\r\n  constructor(private driverService: DriverService,\r\n    private accountService: AccountService,\r\n    private locationPage: Location,) {}\r\n\r\n  ngOnInit() {\r\n    this.getHistory();\r\n\r\n    const connection = new signalR.HubConnectionBuilder()\r\n      .configureLogging(signalR.LogLevel.Information)\r\n      .withUrl(`${environment.signalRUrl}/orderHub`)\r\n      .build();\r\n\r\n    // const connection = new signalR.HubConnectionBuilder()\r\n    //    .configureLogging(signalR.LogLevel.Information)\r\n    //    .withUrl(`${environment.signalRUrl}/orderHub`, {\r\n    //     skipNegotiation: true,\r\n    //     transport: signalR.HttpTransportType.WebSockets})\r\n    //    .build();\r\n\r\n    connection.start().then(function () {\r\n      console.log('signalR Connected in history');\r\n    }).catch(function (err) {\r\n      return console.log(err.toString());\r\n    });\r\n\r\n    connection.on('BroadcastMessage', () => {\r\n      this.getHistory();\r\n    });\r\n  }\r\n\r\n  ionViewDidLeave() {\r\n    for (const subscription of this.subscriptions) {\r\n      console.log(subscription)\r\n      subscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  getHistory(){\r\n    this.subscriptions.push(this.driverService.getDriverHistory(this.userId)\r\n    .subscribe((x: Order[]) => {\r\n      if(this.orders == null){\r\n        console.log(\"No orders\");\r\n        return;\r\n      }\r\n      this.orders = x;\r\n      let sum: number = 0;\r\n      x.forEach(order => {\r\n        sum += order.totalPrice;\r\n      });\r\n      this.dailyProfit = sum.toFixed(2);\r\n    }))\r\n  }\r\n\r\n  goBack(){\r\n    this.locationPage.back();\r\n  }\r\n  \r\n}\r\n","export default \"ion-content {\\n  --ion-background-color:#353535;\\n}\\n\\nion-toolbar {\\n  --ion-background-color:#eeeeee;\\n}\\n\\nion-title {\\n  text-align: center;\\n}\\n\\n#toolbarIcon {\\n  font-size: 1.7em;\\n}\\n\\n.text {\\n  font-family: Open Sans Light;\\n}\\n\\n.centered {\\n  text-align: center;\\n}\\n\\nhr {\\n  background: #eeeeee;\\n  width: 70% !important;\\n}\\n\\n.backIcon {\\n  color: #ffae00;\\n  font-size: 150%;\\n}\\n\\n.back {\\n  color: #ffae00;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uXFwuLlxcLi5cXGRyaXZlci1oaXN0b3J5LnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUVJLDhCQUFBO0FBQUo7O0FBR0E7RUFDSSw4QkFBQTtBQUFKOztBQUdBO0VBQ0ksa0JBQUE7QUFBSjs7QUFHQTtFQUNJLGdCQUFBO0FBQUo7O0FBR0E7RUFDSSw0QkFBQTtBQUFKOztBQUdBO0VBQ0ksa0JBQUE7QUFBSjs7QUFJQTtFQUNJLG1CQUFBO0VBQ0EscUJBQUE7QUFESjs7QUFLQTtFQUNJLGNBQUE7RUFDQSxlQUFBO0FBRko7O0FBS0E7RUFDSSxjQUFBO0FBRkoiLCJmaWxlIjoiZHJpdmVyLWhpc3RvcnkucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiaW9uLWNvbnRlbnR7XHJcbiAgICAvLy0tYmFja2dyb3VuZDogdXJsKC4uLy4uL2Fzc2V0cy93cDQ3OTI3ODAtZGFyay1waG9uZS13YWxscGFwZXJzLmpwZykgMCAwLzEwMCUgMTAwJSBuby1yZXBlYXQ7XHJcbiAgICAtLWlvbi1iYWNrZ3JvdW5kLWNvbG9yOiMzNTM1MzU7XHJcbn1cclxuXHJcbmlvbi10b29sYmFye1xyXG4gICAgLS1pb24tYmFja2dyb3VuZC1jb2xvcjojZWVlZWVlO1xyXG59XHJcblxyXG5pb24tdGl0bGUge1xyXG4gICAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG59XHJcblxyXG4jdG9vbGJhckljb257XHJcbiAgICBmb250LXNpemU6IDEuN2VtO1xyXG59XHJcblxyXG4udGV4dCB7XHJcbiAgICBmb250LWZhbWlseTogT3BlbiBTYW5zIExpZ2h0O1xyXG59XHJcblxyXG4uY2VudGVyZWR7XHJcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XHJcbn1cclxuXHJcblxyXG5ocntcclxuICAgIGJhY2tncm91bmQ6I2VlZWVlZTtcclxuICAgIHdpZHRoOiA3MCUgIWltcG9ydGFudDtcclxufVxyXG5cclxuXHJcbi5iYWNrSWNvbiB7XHJcbiAgICBjb2xvcjogcmdiKDI1NSwgMTc0LCAwKTtcclxuICAgIGZvbnQtc2l6ZTogMTUwJTtcclxufVxyXG5cclxuLmJhY2sge1xyXG4gICAgY29sb3I6IHJnYigyNTUsIDE3NCwgMCk7XHJcbn0iXX0= */\";","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { DriverHistoryPageRoutingModule } from './driver-history-routing.module';\r\n\r\nimport { DriverHistoryPage } from './driver-history.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    DriverHistoryPageRoutingModule\r\n  ],\r\n  declarations: [DriverHistoryPage]\r\n})\r\nexport class DriverHistoryPageModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { DriverHistoryPage } from './driver-history.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: DriverHistoryPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class DriverHistoryPageRoutingModule {}\r\n"]}