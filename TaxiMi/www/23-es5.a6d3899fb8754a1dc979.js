!function(){function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{"5O4O":function(n,r,i){"use strict";i.r(r),i.d(r,"HttpLoaderFactory",function(){return Y}),i.d(r,"DriverProfilePageModule",function(){return R});var o=i("ofXK"),c=i("3Pt+"),a=i("TEn/"),s=i("tyNb"),b=i("mrSG"),l=i("Gpoy"),u=i("tk/3"),d=i("AytR"),p=i("oXKM"),f=i("fXoL"),g=i("8Xdb"),h=i("exMm"),v=i("Hmjx"),m=i("Jhu6"),M=i("sYmb");function y(t,e){if(1&t&&(f.Nb(0,"span",26),f.pc(1),f.Mb()),2&t){var n=f.Xb();f.zb(1),f.rc(" ",n.progress,"% ")}}function C(t,e){if(1&t&&(f.Nb(0,"span",26),f.pc(1),f.Mb()),2&t){var n=f.Xb();f.zb(1),f.rc(" ",n.message," ")}}function k(t,e){1&t&&(f.Nb(0,"h6",27),f.Nb(1,"ion-chip"),f.Nb(2,"ion-label",15),f.pc(3),f.Yb(4,"translate"),f.Mb(),f.Mb(),f.Mb()),2&t&&(f.zb(3),f.rc("",f.Zb(4,1,"Choose your car for today"),":"))}function N(t,e){1&t&&(f.Nb(0,"h6",27),f.Nb(1,"ion-chip"),f.Nb(2,"ion-label",15),f.pc(3),f.Yb(4,"translate"),f.Mb(),f.Mb(),f.Mb()),2&t&&(f.zb(3),f.qc(f.Zb(4,1,"You must add car")))}function O(t,e){if(1&t){var n=f.Ob();f.Nb(0,"button",35),f.Vb("click",function(){f.jc(n);var t=f.Xb().$implicit;return f.Xb().active(t)}),f.pc(1),f.Mb()}if(2&t){var r=f.Xb().$implicit;f.zb(1),f.rc("",r.model," - Comfort")}}function P(t,e){if(1&t){var n=f.Ob();f.Nb(0,"button",35),f.Vb("click",function(){f.jc(n);var t=f.Xb().$implicit;return f.Xb().active(t)}),f.pc(1),f.Mb()}if(2&t){var r=f.Xb().$implicit;f.zb(1),f.rc("",r.model," - Normal")}}function x(t,e){if(1&t){var n=f.Ob();f.Nb(0,"button",36),f.Vb("click",function(){f.jc(n);var t=f.Xb().$implicit;return f.Xb().active(t)}),f.pc(1),f.Mb()}if(2&t){var r=f.Xb().$implicit;f.zb(1),f.rc("",r.model," - Comfort")}}function w(t,e){if(1&t){var n=f.Ob();f.Nb(0,"button",37),f.Vb("click",function(){f.jc(n);var t=f.Xb().$implicit;return f.Xb().active(t)}),f.pc(1),f.Mb()}if(2&t){var r=f.Xb().$implicit;f.zb(1),f.rc("",r.model," - Normal")}}function z(t,e){if(1&t){var n=f.Ob();f.Nb(0,"div"),f.Nb(1,"div",28),f.Nb(2,"div",29),f.oc(3,O,2,1,"button",30),f.oc(4,P,2,1,"button",30),f.oc(5,x,2,1,"button",31),f.oc(6,w,2,1,"button",32),f.Mb(),f.Nb(7,"div",33),f.Nb(8,"button",34),f.Vb("click",function(){f.jc(n);var t=e.$implicit;return f.Xb().deleteCar(t.id)}),f.pc(9),f.Yb(10,"translate"),f.Mb(),f.Mb(),f.Mb(),f.Mb()}if(2&t){var r=e.$implicit;f.zb(3),f.dc("ngIf",0==r.isActive&&2==r.typeId),f.zb(1),f.dc("ngIf",0==r.isActive&&1==r.typeId),f.zb(1),f.dc("ngIf",1==r.isActive&&2==r.typeId),f.zb(1),f.dc("ngIf",1==r.isActive&&1==r.typeId),f.zb(3),f.rc(" ",f.Zb(10,5,"Delete")," ")}}var _,I,A=[{path:"",component:(_=function(){function n(e,r,i,o,c,a,s,b,l){t(this,n),this.accountService=e,this.driverService=r,this.route=i,this.location=o,this.alertController=c,this.walletService=a,this.imageService=s,this.translate=b,this.popoverController=l,this.subscriptions=[],this.user=this.accountService.userValue,this.driverId=this.user.driverId,this.carsCount=0,this.folderName="driverFacePic",this.imgType="profile",this.translate.setDefaultLang(this.accountService.userValue.choosenLanguage)}var r,i,o;return r=n,(i=[{key:"ngOnInit",value:function(){var t=this;this.getDriver(),this.getProfilePicture(),this.getWalletAmount(),this.getCars();var e=(new l.b).configureLogging(l.c.Information).withUrl("".concat(d.a.signalRUrl,"/orderHub")).build();e.start().then(function(){console.log("signalR Connected in profile")}).catch(function(t){return console.log(t)}),e.on("Voted",function(e){t.driverId==e&&t.getDriver()}),e.on("CarAction",function(e){t.driverId==e&&t.getCars()}),e.on("WalletAction",function(e){t.getWalletAmount()}),e.on("BroadcastMessage",function(){t.getProfilePicture()})}},{key:"copy",value:function(t){console.log(t)}},{key:"getProfilePicture",value:function(){var t=this;this.subscriptions.push(this.imageService.getMyPicture(this.user.id).subscribe(function(e){null!=e&&(t.imgPath=e.path)}))}},{key:"upload",value:function(t){var e=this;if(0!==t.length){var n=t[0],r=new FormData;r.append("file",n,n.name),this.subscriptions.push(this.imageService.upload(r,this.folderName,this.user.id,this.imgType).subscribe(function(t){t.type===u.c.UploadProgress?e.progress=Math.round(100*t.loaded/t.total):t.type===u.c.Response&&(e.message="Upload success.")}))}}},{key:"getDriver",value:function(){var t=this;this.subscriptions.push(this.driverService.getDriver(this.driverId).subscribe(function(e){null!=e?(t.driver=e,t.rating=e.rating.toFixed(2),t.driverCommission=e.comission,(Math.round(100*t.driverCommission)/100).toFixed(2),t.referral=t.driver.referal):console.log("No driver")}))}},{key:"getWalletAmount",value:function(){var t=this;this.subscriptions.push(this.walletService.getMyWallet(this.user.id).subscribe(function(e){t.walletAmount=e.ammount?e.ammount:0}))}},{key:"getCars",value:function(){var t=this;this.subscriptions.push(this.driverService.getDriverCars(this.driverId).subscribe(function(e){null!=e?(t.driverCars=e,t.carsCount=t.driverCars.length):console.log("No cars")}))}},{key:"openHistory",value:function(){this.route.navigate(["menu/driver-history"])}},{key:"addNewCar",value:function(){this.route.navigate(["menu/car-register"])}},{key:"active",value:function(t){var e=this;t.isActive||(0!=t.confirmation?this.subscriptions.push(this.driverService.activeCar(t.id,t.driverId).subscribe(function(t){e.isActiveCar=t.isActive,console.log(t)})):this.presentAlert())}},{key:"deleteCar",value:function(t){this.deleteCarConfirmation(t)}},{key:"goBack",value:function(){this.location.back()}},{key:"openLanguagePopover",value:function(t){return Object(b.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.popoverController.create({component:p.a,event:t});case 2:return n=e.sent,e.next=5,n.present();case 5:case"end":return e.stop()}},e,this)}))}},{key:"presentAlert",value:function(){return Object(b.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.translate.get(["Confirmation","Your car is not confirmet yet."]).subscribe(function(t){return Object(b.a)(e,void 0,void 0,regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertController.create({cssClass:"my-custom-class",header:t.Confirmation,message:t["Your car is not confirmet yet."],buttons:["OK"]});case 2:return n=e.sent,e.next=5,n.present();case 5:case"end":return e.stop()}},e,this)}))});case 1:case"end":return t.stop()}},t,this)}))}},{key:"deleteCarConfirmation",value:function(t){return Object(b.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.translate.get(["Delete the car?","Yes","No"]).subscribe(function(e){return Object(b.a)(n,void 0,void 0,regeneratorRuntime.mark(function n(){var r,i=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.alertController.create({header:e["Delete the car?"],buttons:[{text:e.Yes,handler:function(){i.subscriptions.push(i.driverService.deleteCar(t).subscribe(function(t){console.log(t)}))}},{text:e.No}]});case 2:return r=n.sent,n.next=5,r.present();case 5:case"end":return n.stop()}},n,this)}))});case 1:case"end":return e.stop()}},e,this)}))}},{key:"chargeCash",value:function(){this.route.navigate(["menu/payments"])}}])&&e(r.prototype,i),o&&e(r,o),n}(),_.\u0275fac=function(t){return new(t||_)(f.Kb(g.a),f.Kb(h.a),f.Kb(s.f),f.Kb(o.h),f.Kb(a.a),f.Kb(v.a),f.Kb(m.a),f.Kb(M.d),f.Kb(a.H))},_.\u0275cmp=f.Eb({type:_,selectors:[["app-driver-profile"]],decls:57,vars:32,consts:[["slot","start"],["slot","end"],["id","toolbarIcon","name","language-outline",3,"click"],["padding","",1,"background"],[1,"row","mt-2"],[1,"col"],[1,"card-transparent"],[1,"header-transparent"],[1,"avatar"],["onerror","this.onerror=null; this.src='../assets/default.png'","alt","",3,"src"],[1,"card-body"],[1,"user-meta","ion-text-center"],[1,"playername","my-label","text"],[1,"ranking","my-label","text"],[3,"click"],[1,"my-label","text"],["href","https://taximidrive.netlify.app/#/login"],["type","file","placeholder","Choose file",2,"display","none",3,"change"],["file",""],[1,"my-label","btn","btn-info","btn-block","mb-1",3,"click"],[1,"col-md-4"],["class","upload",4,"ngIf"],[1,"my-label","text","btn","btn-warning","btn-block",3,"click"],[1,"my-label","mt-1","text","btn","btn-info","btn-block",3,"click"],["class","ranking ion-text-center",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"upload"],[1,"ranking","ion-text-center"],[1,"row"],[1,"col-10"],["class","my-label text btn btn-dark btn-block mt-1",3,"click",4,"ngIf"],["class","my-label text btn btn-success btn-block mt-1",3,"click",4,"ngIf"],["class","my-label text btn-success btn-block mt-1",3,"click",4,"ngIf"],[1,"col-2"],["expand","full","color","danger",1,"my-label","text","btn","btn-danger","mt-1",2,"float","right",3,"click"],[1,"my-label","text","btn","btn-dark","btn-block","mt-1",3,"click"],[1,"my-label","text","btn","btn-success","btn-block","mt-1",3,"click"],[1,"my-label","text","btn-success","btn-block","mt-1",3,"click"]],template:function(t,e){if(1&t){var n=f.Ob();f.Nb(0,"ion-header"),f.Nb(1,"ion-toolbar"),f.Nb(2,"ion-buttons",0),f.Lb(3,"ion-menu-button"),f.Mb(),f.Nb(4,"ion-title"),f.Nb(5,"ion-label"),f.pc(6),f.Yb(7,"translate"),f.Mb(),f.Mb(),f.Nb(8,"ion-buttons",1),f.Nb(9,"ion-icon",2),f.Vb("click",function(t){return e.openLanguagePopover(t)}),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Nb(10,"ion-content",3),f.Nb(11,"div",4),f.Nb(12,"div",5),f.Nb(13,"div",6),f.Nb(14,"div",7),f.Nb(15,"div",8),f.Lb(16,"img",9),f.Mb(),f.Mb(),f.Mb(),f.Nb(17,"div",10),f.Nb(18,"div",11),f.Nb(19,"h3",12),f.pc(20),f.Mb(),f.Nb(21,"h4",12),f.pc(22),f.Mb(),f.Nb(23,"h6",13),f.pc(24),f.Yb(25,"translate"),f.Nb(26,"ion-chip"),f.Nb(27,"ion-label"),f.pc(28),f.Mb(),f.Mb(),f.Mb(),f.Nb(29,"ion-chip",14),f.Vb("click",function(){return e.chargeCash()}),f.Nb(30,"ion-label",15),f.Nb(31,"a",16),f.pc(32),f.Yb(33,"translate"),f.Mb(),f.Mb(),f.Mb(),f.Nb(34,"h6",13),f.pc(35),f.Yb(36,"translate"),f.Nb(37,"ion-chip"),f.Nb(38,"ion-label"),f.pc(39),f.Mb(),f.Mb(),f.Mb(),f.Mb(),f.Nb(40,"input",17,18),f.Vb("change",function(){f.jc(n);var t=f.ic(41);return e.upload(t.files)}),f.Mb(),f.Nb(42,"button",19),f.Vb("click",function(){return f.jc(n),f.ic(41).click()}),f.pc(43),f.Yb(44,"translate"),f.Mb(),f.Nb(45,"div",20),f.oc(46,y,2,1,"span",21),f.oc(47,C,2,1,"span",21),f.Mb(),f.Nb(48,"button",22),f.Vb("click",function(){return e.openHistory()}),f.pc(49),f.Yb(50,"translate"),f.Mb(),f.Nb(51,"button",23),f.Vb("click",function(){return e.addNewCar()}),f.pc(52),f.Yb(53,"translate"),f.Mb(),f.oc(54,k,5,3,"h6",24),f.oc(55,N,5,3,"h6",24),f.oc(56,z,11,7,"div",25),f.Mb(),f.Mb(),f.Mb(),f.Mb()}2&t&&(f.zb(6),f.qc(f.Zb(7,18,"Profile")),f.zb(10),f.ec("src",e.imgPath,f.lc),f.zb(4),f.sc("",e.user.firstName," ",e.user.lastName,""),f.zb(2),f.qc(e.user.phone),f.zb(2),f.rc("",f.Zb(25,20,"Wallet ballance"),": "),f.zb(4),f.rc("",e.walletAmount," \u043b\u0432."),f.zb(4),f.qc(f.Zb(33,22,"Click to charge your account")),f.zb(3),f.rc("",f.Zb(36,24,"My rating"),": "),f.zb(4),f.qc(e.rating),f.zb(4),f.qc(f.Zb(44,26,"Upload picture")),f.zb(3),f.dc("ngIf",e.progress>0),f.zb(1),f.dc("ngIf",e.message),f.zb(2),f.qc(f.Zb(50,28,"Drive history")),f.zb(3),f.qc(f.Zb(53,30,"Add new car")),f.zb(2),f.dc("ngIf",e.carsCount>0),f.zb(1),f.dc("ngIf",0==e.carsCount),f.zb(1),f.dc("ngForOf",e.driverCars))},directives:[a.l,a.B,a.e,a.s,a.A,a.p,a.m,a.i,a.h,o.l,o.k],pipes:[M.c],styles:["ion-content[_ngcontent-%COMP%]{--ion-background-color:#353535}ion-toolbar[_ngcontent-%COMP%]{--ion-background-color:#eee}ion-title[_ngcontent-%COMP%]{text-align:center}#toolbarIcon[_ngcontent-%COMP%]{font-size:1.7em}a[_ngcontent-%COMP%]{text-decoration:none;color:#000}.centered[_ngcontent-%COMP%]{text-align:center}.text[_ngcontent-%COMP%]{font-family:Open Sans Light}hr[_ngcontent-%COMP%]{background:#eee;width:70%!important}.my-label[_ngcontent-%COMP%]{font-family:Open Sans Light}.backIcon[_ngcontent-%COMP%]{font-size:150%}.back[_ngcontent-%COMP%], .backIcon[_ngcontent-%COMP%]{color:#ffae00}.car[_ngcontent-%COMP%]{color:green}.card-transparent[_ngcontent-%COMP%]{margin:0 auto}.card-transparent[_ngcontent-%COMP%]   .header-transparent[_ngcontent-%COMP%]{height:150px}.card-transparent[_ngcontent-%COMP%]   .header-transparent[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{width:160px;height:120px;position:relative;margin:0 auto}.card-transparent[_ngcontent-%COMP%]   .header-transparent[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:130px;display:block;border-radius:50%;position:absolute;bottom:calc(-1*(80px + 8px));background-color:#fff;margin-left:20px}.my-custom-class[_ngcontent-%COMP%]{--background:#e5e5e5}.card-body[_ngcontent-%COMP%]{background-color:#fff;padding:30px;height:100%;overflow:hidden}.card-body[_ngcontent-%COMP%]   .user-meta[_ngcontent-%COMP%]{padding-top:40px}.card-body[_ngcontent-%COMP%]   .user-meta[_ngcontent-%COMP%]   .playername[_ngcontent-%COMP%]{font-size:24px;font-weight:600;color:#303940}.card-body[_ngcontent-%COMP%]   .user-meta[_ngcontent-%COMP%]   .country[_ngcontent-%COMP%]{font-size:90%;color:#949ea6;text-transform:uppercase;margin:0 auto}"]}),_)}],X=((I=function e(){t(this,e)}).\u0275fac=function(t){return new(t||I)},I.\u0275mod=f.Ib({type:I}),I.\u0275inj=f.Hb({imports:[[s.h.forChild(A)],s.h]}),I),j=i("mqiu"),S=i("QhVT");function Y(t){return new j.a(t)}var V,R=((V=function e(){t(this,e)}).\u0275fac=function(t){return new(t||V)},V.\u0275mod=f.Ib({type:V}),V.\u0275inj=f.Hb({providers:[M.d],imports:[[o.b,c.e,a.C,X,M.b.forChild({loader:{provide:M.a,useFactory:Y,deps:[u.a]}}),S.LanguagePopoverPageModule]]}),V)}}])}();