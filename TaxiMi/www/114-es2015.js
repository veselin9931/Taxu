(self.webpackChunkcsharpcornerauthor=self.webpackChunkcsharpcornerauthor||[]).push([[114],{114:function(t,e,n){"use strict";n.r(e),n.d(e,{DriverProfilePageModule:function(){return N},HttpLoaderFactory:function(){return w}});var i=n(8583),o=n(3679),r=n(7823),c=n(4481),s=n(4762),a=n(4426),l=n(1841),u=n(2340),g=n(6522),d=n(3018),p=n(5056),h=n(1799),b=n(8948),f=n(292),m=n(7800);function Z(t,e){if(1&t&&(d.TgZ(0,"span",25),d._uU(1),d.qZA()),2&t){const t=d.oxw();d.xp6(1),d.hij(" ",t.progress,"% ")}}function v(t,e){if(1&t&&(d.TgZ(0,"span",25),d._uU(1),d.qZA()),2&t){const t=d.oxw();d.xp6(1),d.hij(" ",t.message," ")}}function C(t,e){1&t&&(d.TgZ(0,"h6",26),d.TgZ(1,"ion-chip"),d.TgZ(2,"ion-label",27),d._uU(3),d.ALo(4,"translate"),d.qZA(),d.qZA(),d.qZA()),2&t&&(d.xp6(3),d.hij("",d.lcZ(4,1,"Choose your car for today"),":"))}function x(t,e){1&t&&(d.TgZ(0,"h6",28),d.TgZ(1,"ion-chip"),d.TgZ(2,"ion-label",27),d._uU(3),d.ALo(4,"translate"),d.qZA(),d.qZA(),d.qZA()),2&t&&(d.xp6(3),d.Oqu(d.lcZ(4,1,"You must add car")))}function A(t,e){if(1&t){const t=d.EpF();d.TgZ(0,"button",36),d.NdJ("click",function(){d.CHM(t);const e=d.oxw().$implicit;return d.oxw().active(e)}),d._uU(1),d.qZA()}if(2&t){const t=d.oxw().$implicit;d.xp6(1),d.hij(" ",t.model," - Comfort ")}}function y(t,e){if(1&t){const t=d.EpF();d.TgZ(0,"button",36),d.NdJ("click",function(){d.CHM(t);const e=d.oxw().$implicit;return d.oxw().active(e)}),d._uU(1),d.qZA()}if(2&t){const t=d.oxw().$implicit;d.xp6(1),d.hij(" ",t.model," - Normal ")}}function k(t,e){if(1&t){const t=d.EpF();d.TgZ(0,"button",37),d.NdJ("click",function(){d.CHM(t);const e=d.oxw().$implicit;return d.oxw().active(e)}),d._uU(1),d.qZA()}if(2&t){const t=d.oxw().$implicit;d.xp6(1),d.hij(" ",t.model," - Comfort ")}}function q(t,e){if(1&t){const t=d.EpF();d.TgZ(0,"button",38),d.NdJ("click",function(){d.CHM(t);const e=d.oxw().$implicit;return d.oxw().active(e)}),d._uU(1),d.qZA()}if(2&t){const t=d.oxw().$implicit;d.xp6(1),d.hij(" ",t.model," - Normal ")}}function _(t,e){if(1&t){const t=d.EpF();d.TgZ(0,"div"),d.TgZ(1,"div",29),d.TgZ(2,"div",30),d.YNc(3,A,2,1,"button",31),d.YNc(4,y,2,1,"button",31),d.YNc(5,k,2,1,"button",32),d.YNc(6,q,2,1,"button",33),d.qZA(),d.TgZ(7,"div",34),d.TgZ(8,"button",35),d.NdJ("click",function(){d.CHM(t);const n=e.$implicit;return d.oxw().deleteCar(n.id)}),d._uU(9),d.ALo(10,"translate"),d.qZA(),d.qZA(),d.qZA(),d.qZA()}if(2&t){const t=e.$implicit;d.xp6(3),d.Q6J("ngIf",0==t.isActive&&2==t.typeId),d.xp6(1),d.Q6J("ngIf",0==t.isActive&&1==t.typeId),d.xp6(1),d.Q6J("ngIf",1==t.isActive&&2==t.typeId),d.xp6(1),d.Q6J("ngIf",1==t.isActive&&1==t.typeId),d.xp6(3),d.hij(" ",d.lcZ(10,5,"Delete")," ")}}const P=[{path:"",component:(()=>{class t{constructor(t,e,n,i,o,r,c,s,a){this.accountService=t,this.driverService=e,this.route=n,this.location=i,this.alertController=o,this.walletService=r,this.imageService=c,this.translate=s,this.popoverController=a,this.subscriptions=[],this.user=this.accountService.userValue,this.driverId=this.user.driverId,this.carsCount=0,this.folderName="driverFacePic",this.imgType="profile",this.translate.setDefaultLang(this.accountService.userValue.choosenLanguage)}ngOnInit(){this.getDriver(),this.getProfilePicture(),this.getWalletAmount(),this.getCars();const t=(new a.su).configureLogging(a.in.Information).withUrl(`${u.N.signalRUrl}/orderHub`).build();t.start().then(function(){console.log("signalR Connected in profile")}).catch(function(t){return console.log(t)}),t.on("Voted",t=>{this.driverId==t&&this.getDriver()}),t.on("CarAction",t=>{this.driverId==t&&this.getCars()}),t.on("WalletAction",t=>{this.getWalletAmount()}),t.on("BroadcastMessage",()=>{this.getProfilePicture()})}copy(t){console.log(t)}getProfilePicture(){this.subscriptions.push(this.imageService.getMyPicture(this.user.id).subscribe(t=>{null!=t&&(this.imgPath=t.path)}))}upload(t){if(0===t.length)return;let e=t[0];const n=new FormData;n.append("file",e,e.name),this.subscriptions.push(this.imageService.upload(n,this.folderName,this.user.id,this.imgType).subscribe(t=>{t.type===l.dt.UploadProgress?this.progress=Math.round(100*t.loaded/t.total):t.type===l.dt.Response&&(this.message="Upload success.")}))}getDriver(){this.subscriptions.push(this.driverService.getDriver(this.driverId).subscribe(t=>{null!=t?(this.driver=t,this.rating=t.rating.toFixed(2),this.driverCommission=t.comission,(Math.round(100*this.driverCommission)/100).toFixed(2),this.referral=this.driver.referal):console.log("No driver")}))}getWalletAmount(){this.subscriptions.push(this.walletService.getMyWallet(this.user.id).subscribe(t=>{this.walletAmount=t.ammount?t.ammount:0}))}getCars(){this.subscriptions.push(this.driverService.getDriverCars(this.driverId).subscribe(t=>{null!=t?(this.driverCars=t,this.carsCount=this.driverCars.length):console.log("No cars")}))}openHistory(){this.route.navigate(["menu/driver-history"])}addNewCar(){this.route.navigate(["menu/car-register"])}active(t){t.isActive||(0!=t.confirmation?this.subscriptions.push(this.driverService.activeCar(t.id,t.driverId).subscribe(t=>{this.isActiveCar=t.isActive,console.log(t)})):this.presentAlert())}deleteCar(t){this.deleteCarConfirmation(t)}goBack(){this.location.back()}openLanguagePopover(t){return(0,s.mG)(this,void 0,void 0,function*(){const e=yield this.popoverController.create({component:g.m,event:t});yield e.present()})}presentAlert(){return(0,s.mG)(this,void 0,void 0,function*(){this.translate.get(["Confirmation","Your car is not confirmet yet."]).subscribe(t=>(0,s.mG)(this,void 0,void 0,function*(){const e=yield this.alertController.create({cssClass:"my-custom-class",header:t.Confirmation,message:t["Your car is not confirmet yet."],buttons:["OK"]});yield e.present()}))})}deleteCarConfirmation(t){return(0,s.mG)(this,void 0,void 0,function*(){this.translate.get(["Delete the car?","Yes","No"]).subscribe(e=>(0,s.mG)(this,void 0,void 0,function*(){const n=yield this.alertController.create({header:e["Delete the car?"],buttons:[{text:e.Yes,handler:()=>{this.subscriptions.push(this.driverService.deleteCar(t).subscribe(t=>{console.log(t)}))}},{text:e.No}]});yield n.present()}))})}chargeCash(){this.route.navigate(["menu/payments"])}reservation(){this.route.navigate(["menu/reservations"])}}return t.\u0275fac=function(e){return new(e||t)(d.Y36(p.B),d.Y36(h.F),d.Y36(c.F0),d.Y36(i.Ye),d.Y36(r.Br),d.Y36(b.X),d.Y36(f.A),d.Y36(m.sK),d.Y36(r.Dh))},t.\u0275cmp=d.Xpm({type:t,selectors:[["app-driver-profile"]],decls:58,vars:35,consts:[["slot","start"],["slot","end"],["id","toolbarIcon","name","language-outline",3,"click"],["padding","",1,"background"],[1,"row","mt-2"],[1,"col"],[1,"card-transparent"],[1,"header-transparent"],[1,"avatar"],["onerror","this.onerror=null; this.src='../assets/default.png'","alt","",3,"src"],[1,"card-body"],[1,"user-meta","ion-text-center"],[1,"playername","my-label","text"],[1,"ranking","my-label","text"],[1,"my-label","text","btn","btn-success","btn-block","mb-1",3,"click"],["type","file","placeholder","Choose file",2,"display","none",3,"change"],["file",""],[1,"my-label","btn","btn-info","btn-block","mb-1",3,"click"],[1,"col-md-4"],["class","upload",4,"ngIf"],[1,"my-label","text","btn","btn-info","btn-block",3,"click"],[1,"my-label","mt-1","text","btn","btn-info","btn-block",3,"click"],["class","ranking ion-text-center mt-1",4,"ngIf"],["class","ranking ion-text-center",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"upload"],[1,"ranking","ion-text-center","mt-1"],[1,"my-label","text"],[1,"ranking","ion-text-center"],[1,"row"],[1,"col-10"],["class","my-label text btn btn-dark btn-block mt-1",3,"click",4,"ngIf"],["class","my-label text btn btn-info btn-block mt-1",3,"click",4,"ngIf"],["class","my-label text btn-info btn-block mt-1",3,"click",4,"ngIf"],[1,"col-2"],["expand","full","color","danger",1,"my-label","text","btn","btn-danger","mt-1",2,"float","right",3,"click"],[1,"my-label","text","btn","btn-dark","btn-block","mt-1",3,"click"],[1,"my-label","text","btn","btn-info","btn-block","mt-1",3,"click"],[1,"my-label","text","btn-info","btn-block","mt-1",3,"click"]],template:function(t,e){if(1&t){const t=d.EpF();d.TgZ(0,"ion-header"),d.TgZ(1,"ion-toolbar"),d.TgZ(2,"ion-buttons",0),d._UZ(3,"ion-menu-button"),d.qZA(),d.TgZ(4,"ion-title"),d.TgZ(5,"ion-label"),d._uU(6),d.ALo(7,"translate"),d.qZA(),d.qZA(),d.TgZ(8,"ion-buttons",1),d.TgZ(9,"ion-icon",2),d.NdJ("click",function(t){return e.openLanguagePopover(t)}),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(10,"ion-content",3),d.TgZ(11,"div",4),d.TgZ(12,"div",5),d.TgZ(13,"div",6),d.TgZ(14,"div",7),d.TgZ(15,"div",8),d._UZ(16,"img",9),d.qZA(),d.qZA(),d.qZA(),d.TgZ(17,"div",10),d.TgZ(18,"div",11),d.TgZ(19,"h3",12),d._uU(20),d.qZA(),d.TgZ(21,"h4",12),d._uU(22),d.qZA(),d.TgZ(23,"h6",13),d._uU(24),d.ALo(25,"translate"),d.TgZ(26,"ion-chip"),d.TgZ(27,"ion-label"),d._uU(28),d.qZA(),d.qZA(),d.qZA(),d.TgZ(29,"h6",13),d._uU(30),d.ALo(31,"translate"),d.TgZ(32,"ion-chip"),d.TgZ(33,"ion-label"),d._uU(34),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(35,"button",14),d.NdJ("click",function(){return e.chargeCash()}),d._uU(36),d.ALo(37,"translate"),d.qZA(),d.TgZ(38,"input",15,16),d.NdJ("change",function(){d.CHM(t);const n=d.MAs(39);return e.upload(n.files)}),d.qZA(),d.TgZ(40,"button",17),d.NdJ("click",function(){return d.CHM(t),d.MAs(39).click()}),d._uU(41),d.ALo(42,"translate"),d.qZA(),d.TgZ(43,"div",18),d.YNc(44,Z,2,1,"span",19),d.YNc(45,v,2,1,"span",19),d.qZA(),d.TgZ(46,"button",20),d.NdJ("click",function(){return e.openHistory()}),d._uU(47),d.ALo(48,"translate"),d.qZA(),d.TgZ(49,"button",21),d.NdJ("click",function(){return e.addNewCar()}),d._uU(50),d.ALo(51,"translate"),d.qZA(),d.TgZ(52,"button",21),d.NdJ("click",function(){return e.reservation()}),d._uU(53),d.ALo(54,"translate"),d.qZA(),d.YNc(55,C,5,3,"h6",22),d.YNc(56,x,5,3,"h6",23),d.YNc(57,_,11,7,"div",24),d.qZA(),d.qZA(),d.qZA(),d.qZA()}2&t&&(d.xp6(6),d.Oqu(d.lcZ(7,19,"Profile")),d.xp6(10),d.s9C("src",e.imgPath,d.LSH),d.xp6(4),d.AsE("",e.user.firstName," ",e.user.lastName,""),d.xp6(2),d.Oqu(e.user.phone),d.xp6(2),d.hij(" ",d.lcZ(25,21,"Wallet ballance"),": "),d.xp6(4),d.hij("",e.walletAmount," \u043b\u0432."),d.xp6(2),d.hij(" ",d.lcZ(31,23,"My rating"),": "),d.xp6(4),d.Oqu(e.rating),d.xp6(2),d.Oqu(d.lcZ(37,25,"Click to charge your account")),d.xp6(5),d.Oqu(d.lcZ(42,27,"Upload profile picture")),d.xp6(3),d.Q6J("ngIf",e.progress>0),d.xp6(1),d.Q6J("ngIf",e.message),d.xp6(2),d.Oqu(d.lcZ(48,29,"Drive history")),d.xp6(3),d.Oqu(d.lcZ(51,31,"Add new car")),d.xp6(3),d.Oqu(d.lcZ(54,33,"Suburban reservations")),d.xp6(2),d.Q6J("ngIf",e.carsCount>0),d.xp6(1),d.Q6J("ngIf",0==e.carsCount),d.xp6(1),d.Q6J("ngForOf",e.driverCars))},directives:[r.Gu,r.sr,r.Sm,r.fG,r.wd,r.Q$,r.gu,r.W2,r.hM,i.O5,i.sg],pipes:[m.X$],styles:["ion-content[_ngcontent-%COMP%]{--ion-background-color:#353535}ion-toolbar[_ngcontent-%COMP%]{--ion-background-color:#eee}ion-title[_ngcontent-%COMP%]{text-align:center}#toolbarIcon[_ngcontent-%COMP%]{font-size:1.7em}a[_ngcontent-%COMP%]{text-decoration:none;color:#000}.centered[_ngcontent-%COMP%]{text-align:center}.text[_ngcontent-%COMP%]{font-family:Open Sans Light}hr[_ngcontent-%COMP%]{background:#eee;width:70%!important}.my-label[_ngcontent-%COMP%]{font-family:Open Sans Light}.backIcon[_ngcontent-%COMP%]{font-size:150%}.back[_ngcontent-%COMP%], .backIcon[_ngcontent-%COMP%]{color:#ffae00}.car[_ngcontent-%COMP%]{color:green}.card-transparent[_ngcontent-%COMP%]{margin:0 auto}.card-transparent[_ngcontent-%COMP%]   .header-transparent[_ngcontent-%COMP%]{height:150px}.card-transparent[_ngcontent-%COMP%]   .header-transparent[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{width:160px;height:120px;position:relative;margin:0 auto}.card-transparent[_ngcontent-%COMP%]   .header-transparent[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:130px;display:block;border-radius:50%;position:absolute;bottom:calc(-1*(80px + 8px));background-color:#fff;margin-left:20px}.my-custom-class[_ngcontent-%COMP%]{--background:#e5e5e5}.card-body[_ngcontent-%COMP%]{background-color:#fff;padding:30px;height:100%;overflow:hidden}.card-body[_ngcontent-%COMP%]   .user-meta[_ngcontent-%COMP%]{padding-top:40px}.card-body[_ngcontent-%COMP%]   .user-meta[_ngcontent-%COMP%]   .playername[_ngcontent-%COMP%]{font-size:24px;font-weight:600;color:#303940}.card-body[_ngcontent-%COMP%]   .user-meta[_ngcontent-%COMP%]   .country[_ngcontent-%COMP%]{font-size:90%;color:#949ea6;text-transform:uppercase;margin:0 auto}"]}),t})()}];let M=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.oAB({type:t}),t.\u0275inj=d.cJS({imports:[[c.Bz.forChild(P)],c.Bz]}),t})();var O=n(2472),T=n(3577);function w(t){return new O.w(t)}let N=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.oAB({type:t}),t.\u0275inj=d.cJS({providers:[m.sK],imports:[[i.ez,o.u5,r.Pc,M,m.aw.forChild({loader:{provide:m.Zw,useFactory:w,deps:[l.eN]}}),T.LanguagePopoverPageModule]]}),t})()}}]);