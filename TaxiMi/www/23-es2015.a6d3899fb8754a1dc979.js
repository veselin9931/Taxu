(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{"5O4O":function(t,e,n){"use strict";n.r(e),n.d(e,"HttpLoaderFactory",function(){return A}),n.d(e,"DriverProfilePageModule",function(){return X});var i=n("ofXK"),o=n("3Pt+"),c=n("TEn/"),r=n("tyNb"),s=n("mrSG"),a=n("Gpoy"),b=n("tk/3"),l=n("AytR"),u=n("oXKM"),d=n("fXoL"),p=n("8Xdb"),h=n("exMm"),g=n("Hmjx"),f=n("Jhu6"),m=n("sYmb");function v(t,e){if(1&t&&(d.Nb(0,"span",26),d.pc(1),d.Mb()),2&t){const t=d.Xb();d.zb(1),d.rc(" ",t.progress,"% ")}}function M(t,e){if(1&t&&(d.Nb(0,"span",26),d.pc(1),d.Mb()),2&t){const t=d.Xb();d.zb(1),d.rc(" ",t.message," ")}}function C(t,e){1&t&&(d.Nb(0,"h6",27),d.Nb(1,"ion-chip"),d.Nb(2,"ion-label",15),d.pc(3),d.Yb(4,"translate"),d.Mb(),d.Mb(),d.Mb()),2&t&&(d.zb(3),d.rc("",d.Zb(4,1,"Choose your car for today"),":"))}function y(t,e){1&t&&(d.Nb(0,"h6",27),d.Nb(1,"ion-chip"),d.Nb(2,"ion-label",15),d.pc(3),d.Yb(4,"translate"),d.Mb(),d.Mb(),d.Mb()),2&t&&(d.zb(3),d.qc(d.Zb(4,1,"You must add car")))}function N(t,e){if(1&t){const t=d.Ob();d.Nb(0,"button",35),d.Vb("click",function(){d.jc(t);const e=d.Xb().$implicit;return d.Xb().active(e)}),d.pc(1),d.Mb()}if(2&t){const t=d.Xb().$implicit;d.zb(1),d.rc("",t.model," - Comfort")}}function k(t,e){if(1&t){const t=d.Ob();d.Nb(0,"button",35),d.Vb("click",function(){d.jc(t);const e=d.Xb().$implicit;return d.Xb().active(e)}),d.pc(1),d.Mb()}if(2&t){const t=d.Xb().$implicit;d.zb(1),d.rc("",t.model," - Normal")}}function O(t,e){if(1&t){const t=d.Ob();d.Nb(0,"button",36),d.Vb("click",function(){d.jc(t);const e=d.Xb().$implicit;return d.Xb().active(e)}),d.pc(1),d.Mb()}if(2&t){const t=d.Xb().$implicit;d.zb(1),d.rc("",t.model," - Comfort")}}function P(t,e){if(1&t){const t=d.Ob();d.Nb(0,"button",37),d.Vb("click",function(){d.jc(t);const e=d.Xb().$implicit;return d.Xb().active(e)}),d.pc(1),d.Mb()}if(2&t){const t=d.Xb().$implicit;d.zb(1),d.rc("",t.model," - Normal")}}function x(t,e){if(1&t){const t=d.Ob();d.Nb(0,"div"),d.Nb(1,"div",28),d.Nb(2,"div",29),d.oc(3,N,2,1,"button",30),d.oc(4,k,2,1,"button",30),d.oc(5,O,2,1,"button",31),d.oc(6,P,2,1,"button",32),d.Mb(),d.Nb(7,"div",33),d.Nb(8,"button",34),d.Vb("click",function(){d.jc(t);const n=e.$implicit;return d.Xb().deleteCar(n.id)}),d.pc(9),d.Yb(10,"translate"),d.Mb(),d.Mb(),d.Mb(),d.Mb()}if(2&t){const t=e.$implicit;d.zb(3),d.dc("ngIf",0==t.isActive&&2==t.typeId),d.zb(1),d.dc("ngIf",0==t.isActive&&1==t.typeId),d.zb(1),d.dc("ngIf",1==t.isActive&&2==t.typeId),d.zb(1),d.dc("ngIf",1==t.isActive&&1==t.typeId),d.zb(3),d.rc(" ",d.Zb(10,5,"Delete")," ")}}const z=[{path:"",component:(()=>{class t{constructor(t,e,n,i,o,c,r,s,a){this.accountService=t,this.driverService=e,this.route=n,this.location=i,this.alertController=o,this.walletService=c,this.imageService=r,this.translate=s,this.popoverController=a,this.subscriptions=[],this.user=this.accountService.userValue,this.driverId=this.user.driverId,this.carsCount=0,this.folderName="driverFacePic",this.imgType="profile",this.translate.setDefaultLang(this.accountService.userValue.choosenLanguage)}ngOnInit(){this.getDriver(),this.getProfilePicture(),this.getWalletAmount(),this.getCars();const t=(new a.b).configureLogging(a.c.Information).withUrl(`${l.a.signalRUrl}/orderHub`).build();t.start().then(function(){console.log("signalR Connected in profile")}).catch(function(t){return console.log(t)}),t.on("Voted",t=>{this.driverId==t&&this.getDriver()}),t.on("CarAction",t=>{this.driverId==t&&this.getCars()}),t.on("WalletAction",t=>{this.getWalletAmount()}),t.on("BroadcastMessage",()=>{this.getProfilePicture()})}copy(t){console.log(t)}getProfilePicture(){this.subscriptions.push(this.imageService.getMyPicture(this.user.id).subscribe(t=>{null!=t&&(this.imgPath=t.path)}))}upload(t){if(0===t.length)return;let e=t[0];const n=new FormData;n.append("file",e,e.name),this.subscriptions.push(this.imageService.upload(n,this.folderName,this.user.id,this.imgType).subscribe(t=>{t.type===b.c.UploadProgress?this.progress=Math.round(100*t.loaded/t.total):t.type===b.c.Response&&(this.message="Upload success.")}))}getDriver(){this.subscriptions.push(this.driverService.getDriver(this.driverId).subscribe(t=>{null!=t?(this.driver=t,this.rating=t.rating.toFixed(2),this.driverCommission=t.comission,(Math.round(100*this.driverCommission)/100).toFixed(2),this.referral=this.driver.referal):console.log("No driver")}))}getWalletAmount(){this.subscriptions.push(this.walletService.getMyWallet(this.user.id).subscribe(t=>{this.walletAmount=t.ammount?t.ammount:0}))}getCars(){this.subscriptions.push(this.driverService.getDriverCars(this.driverId).subscribe(t=>{null!=t?(this.driverCars=t,this.carsCount=this.driverCars.length):console.log("No cars")}))}openHistory(){this.route.navigate(["menu/driver-history"])}addNewCar(){this.route.navigate(["menu/car-register"])}active(t){t.isActive||(0!=t.confirmation?this.subscriptions.push(this.driverService.activeCar(t.id,t.driverId).subscribe(t=>{this.isActiveCar=t.isActive,console.log(t)})):this.presentAlert())}deleteCar(t){this.deleteCarConfirmation(t)}goBack(){this.location.back()}openLanguagePopover(t){return Object(s.a)(this,void 0,void 0,function*(){const e=yield this.popoverController.create({component:u.a,event:t});yield e.present()})}presentAlert(){return Object(s.a)(this,void 0,void 0,function*(){this.translate.get(["Confirmation","Your car is not confirmet yet."]).subscribe(t=>Object(s.a)(this,void 0,void 0,function*(){const e=yield this.alertController.create({cssClass:"my-custom-class",header:t.Confirmation,message:t["Your car is not confirmet yet."],buttons:["OK"]});yield e.present()}))})}deleteCarConfirmation(t){return Object(s.a)(this,void 0,void 0,function*(){this.translate.get(["Delete the car?","Yes","No"]).subscribe(e=>Object(s.a)(this,void 0,void 0,function*(){const n=yield this.alertController.create({header:e["Delete the car?"],buttons:[{text:e.Yes,handler:()=>{this.subscriptions.push(this.driverService.deleteCar(t).subscribe(t=>{console.log(t)}))}},{text:e.No}]});yield n.present()}))})}chargeCash(){this.route.navigate(["menu/payments"])}}return t.\u0275fac=function(e){return new(e||t)(d.Kb(p.a),d.Kb(h.a),d.Kb(r.f),d.Kb(i.h),d.Kb(c.a),d.Kb(g.a),d.Kb(f.a),d.Kb(m.d),d.Kb(c.H))},t.\u0275cmp=d.Eb({type:t,selectors:[["app-driver-profile"]],decls:57,vars:32,consts:[["slot","start"],["slot","end"],["id","toolbarIcon","name","language-outline",3,"click"],["padding","",1,"background"],[1,"row","mt-2"],[1,"col"],[1,"card-transparent"],[1,"header-transparent"],[1,"avatar"],["onerror","this.onerror=null; this.src='../assets/default.png'","alt","",3,"src"],[1,"card-body"],[1,"user-meta","ion-text-center"],[1,"playername","my-label","text"],[1,"ranking","my-label","text"],[3,"click"],[1,"my-label","text"],["href","https://taximidrive.netlify.app/#/login"],["type","file","placeholder","Choose file",2,"display","none",3,"change"],["file",""],[1,"my-label","btn","btn-info","btn-block","mb-1",3,"click"],[1,"col-md-4"],["class","upload",4,"ngIf"],[1,"my-label","text","btn","btn-warning","btn-block",3,"click"],[1,"my-label","mt-1","text","btn","btn-info","btn-block",3,"click"],["class","ranking ion-text-center",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"upload"],[1,"ranking","ion-text-center"],[1,"row"],[1,"col-10"],["class","my-label text btn btn-dark btn-block mt-1",3,"click",4,"ngIf"],["class","my-label text btn btn-success btn-block mt-1",3,"click",4,"ngIf"],["class","my-label text btn-success btn-block mt-1",3,"click",4,"ngIf"],[1,"col-2"],["expand","full","color","danger",1,"my-label","text","btn","btn-danger","mt-1",2,"float","right",3,"click"],[1,"my-label","text","btn","btn-dark","btn-block","mt-1",3,"click"],[1,"my-label","text","btn","btn-success","btn-block","mt-1",3,"click"],[1,"my-label","text","btn-success","btn-block","mt-1",3,"click"]],template:function(t,e){if(1&t){const t=d.Ob();d.Nb(0,"ion-header"),d.Nb(1,"ion-toolbar"),d.Nb(2,"ion-buttons",0),d.Lb(3,"ion-menu-button"),d.Mb(),d.Nb(4,"ion-title"),d.Nb(5,"ion-label"),d.pc(6),d.Yb(7,"translate"),d.Mb(),d.Mb(),d.Nb(8,"ion-buttons",1),d.Nb(9,"ion-icon",2),d.Vb("click",function(t){return e.openLanguagePopover(t)}),d.Mb(),d.Mb(),d.Mb(),d.Mb(),d.Nb(10,"ion-content",3),d.Nb(11,"div",4),d.Nb(12,"div",5),d.Nb(13,"div",6),d.Nb(14,"div",7),d.Nb(15,"div",8),d.Lb(16,"img",9),d.Mb(),d.Mb(),d.Mb(),d.Nb(17,"div",10),d.Nb(18,"div",11),d.Nb(19,"h3",12),d.pc(20),d.Mb(),d.Nb(21,"h4",12),d.pc(22),d.Mb(),d.Nb(23,"h6",13),d.pc(24),d.Yb(25,"translate"),d.Nb(26,"ion-chip"),d.Nb(27,"ion-label"),d.pc(28),d.Mb(),d.Mb(),d.Mb(),d.Nb(29,"ion-chip",14),d.Vb("click",function(){return e.chargeCash()}),d.Nb(30,"ion-label",15),d.Nb(31,"a",16),d.pc(32),d.Yb(33,"translate"),d.Mb(),d.Mb(),d.Mb(),d.Nb(34,"h6",13),d.pc(35),d.Yb(36,"translate"),d.Nb(37,"ion-chip"),d.Nb(38,"ion-label"),d.pc(39),d.Mb(),d.Mb(),d.Mb(),d.Mb(),d.Nb(40,"input",17,18),d.Vb("change",function(){d.jc(t);const n=d.ic(41);return e.upload(n.files)}),d.Mb(),d.Nb(42,"button",19),d.Vb("click",function(){return d.jc(t),d.ic(41).click()}),d.pc(43),d.Yb(44,"translate"),d.Mb(),d.Nb(45,"div",20),d.oc(46,v,2,1,"span",21),d.oc(47,M,2,1,"span",21),d.Mb(),d.Nb(48,"button",22),d.Vb("click",function(){return e.openHistory()}),d.pc(49),d.Yb(50,"translate"),d.Mb(),d.Nb(51,"button",23),d.Vb("click",function(){return e.addNewCar()}),d.pc(52),d.Yb(53,"translate"),d.Mb(),d.oc(54,C,5,3,"h6",24),d.oc(55,y,5,3,"h6",24),d.oc(56,x,11,7,"div",25),d.Mb(),d.Mb(),d.Mb(),d.Mb()}2&t&&(d.zb(6),d.qc(d.Zb(7,18,"Profile")),d.zb(10),d.ec("src",e.imgPath,d.lc),d.zb(4),d.sc("",e.user.firstName," ",e.user.lastName,""),d.zb(2),d.qc(e.user.phone),d.zb(2),d.rc("",d.Zb(25,20,"Wallet ballance"),": "),d.zb(4),d.rc("",e.walletAmount," \u043b\u0432."),d.zb(4),d.qc(d.Zb(33,22,"Click to charge your account")),d.zb(3),d.rc("",d.Zb(36,24,"My rating"),": "),d.zb(4),d.qc(e.rating),d.zb(4),d.qc(d.Zb(44,26,"Upload picture")),d.zb(3),d.dc("ngIf",e.progress>0),d.zb(1),d.dc("ngIf",e.message),d.zb(2),d.qc(d.Zb(50,28,"Drive history")),d.zb(3),d.qc(d.Zb(53,30,"Add new car")),d.zb(2),d.dc("ngIf",e.carsCount>0),d.zb(1),d.dc("ngIf",0==e.carsCount),d.zb(1),d.dc("ngForOf",e.driverCars))},directives:[c.l,c.B,c.e,c.s,c.A,c.p,c.m,c.i,c.h,i.l,i.k],pipes:[m.c],styles:["ion-content[_ngcontent-%COMP%]{--ion-background-color:#353535}ion-toolbar[_ngcontent-%COMP%]{--ion-background-color:#eee}ion-title[_ngcontent-%COMP%]{text-align:center}#toolbarIcon[_ngcontent-%COMP%]{font-size:1.7em}a[_ngcontent-%COMP%]{text-decoration:none;color:#000}.centered[_ngcontent-%COMP%]{text-align:center}.text[_ngcontent-%COMP%]{font-family:Open Sans Light}hr[_ngcontent-%COMP%]{background:#eee;width:70%!important}.my-label[_ngcontent-%COMP%]{font-family:Open Sans Light}.backIcon[_ngcontent-%COMP%]{font-size:150%}.back[_ngcontent-%COMP%], .backIcon[_ngcontent-%COMP%]{color:#ffae00}.car[_ngcontent-%COMP%]{color:green}.card-transparent[_ngcontent-%COMP%]{margin:0 auto}.card-transparent[_ngcontent-%COMP%]   .header-transparent[_ngcontent-%COMP%]{height:150px}.card-transparent[_ngcontent-%COMP%]   .header-transparent[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{width:160px;height:120px;position:relative;margin:0 auto}.card-transparent[_ngcontent-%COMP%]   .header-transparent[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:130px;display:block;border-radius:50%;position:absolute;bottom:calc(-1*(80px + 8px));background-color:#fff;margin-left:20px}.my-custom-class[_ngcontent-%COMP%]{--background:#e5e5e5}.card-body[_ngcontent-%COMP%]{background-color:#fff;padding:30px;height:100%;overflow:hidden}.card-body[_ngcontent-%COMP%]   .user-meta[_ngcontent-%COMP%]{padding-top:40px}.card-body[_ngcontent-%COMP%]   .user-meta[_ngcontent-%COMP%]   .playername[_ngcontent-%COMP%]{font-size:24px;font-weight:600;color:#303940}.card-body[_ngcontent-%COMP%]   .user-meta[_ngcontent-%COMP%]   .country[_ngcontent-%COMP%]{font-size:90%;color:#949ea6;text-transform:uppercase;margin:0 auto}"]}),t})()}];let _=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.Ib({type:t}),t.\u0275inj=d.Hb({imports:[[r.h.forChild(z)],r.h]}),t})();var I=n("mqiu"),w=n("QhVT");function A(t){return new I.a(t)}let X=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.Ib({type:t}),t.\u0275inj=d.Hb({providers:[m.d],imports:[[i.b,o.e,c.C,_,m.b.forChild({loader:{provide:m.a,useFactory:A,deps:[b.a]}}),w.LanguagePopoverPageModule]]}),t})()}}]);