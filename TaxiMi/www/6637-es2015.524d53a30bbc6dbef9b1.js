(self.webpackChunkcsharpcornerauthor=self.webpackChunkcsharpcornerauthor||[]).push([[6637],{6637:function(t,e,n){"use strict";n.r(e),n.d(e,{HttpLoaderFactory:function(){return v},ReservationsPageModule:function(){return x}});var i=n(8583),r=n(3679),o=n(4687),s=n(7823),c=n(4481),u=n(4762),a=n(4426),l=n(2340),g=n(6522),d=n(3018),p=n(5056),h=n(3897),b=n(4441),Z=n(7800);function O(t,e){if(1&t){const t=d.EpF();d.TgZ(0,"div",5),d.TgZ(1,"a",6),d.TgZ(2,"div",7),d.TgZ(3,"small"),d._uU(4),d.ALo(5,"date"),d.qZA(),d.TgZ(6,"small"),d._UZ(7,"i",8),d._uU(8),d.qZA(),d.qZA(),d.TgZ(9,"h4",9),d._uU(10),d._UZ(11,"ion-icon",10),d._uU(12),d.qZA(),d.TgZ(13,"h5",9),d._uU(14),d.qZA(),d._UZ(15,"hr"),d.TgZ(16,"div",11),d.TgZ(17,"p"),d._uU(18),d.qZA(),d._UZ(19,"br"),d.qZA(),d.TgZ(20,"div",11),d.TgZ(21,"p"),d._UZ(22,"ion-icon",12),d._uU(23),d.qZA(),d.qZA(),d.TgZ(24,"div",7),d.TgZ(25,"button",13),d.NdJ("click",function(){d.CHM(t);const n=e.$implicit;return d.oxw().cancelOrder(n)}),d._uU(26),d.ALo(27,"translate"),d.qZA(),d.TgZ(28,"button",14),d.NdJ("click",function(){d.CHM(t);const n=e.$implicit;return d.oxw().acceptByUser(n.id)}),d._uU(29),d.ALo(30,"translate"),d.qZA(),d.TgZ(31,"button",15),d.NdJ("click",function(){d.CHM(t);const n=e.$implicit;return d.oxw().callToUser(n.applicationUser.phone)}),d._uU(32),d.ALo(33,"translate"),d.qZA(),d.qZA(),d.qZA(),d.qZA()}if(2&t){const t=e.$implicit;d.xp6(4),d.Oqu(d.xi3(5,11,t.createdOn,"MM/dd/yyyy h:mm")),d.xp6(4),d.hij(" ",t.date,""),d.xp6(2),d.hij("",t.location," "),d.xp6(2),d.hij(" ",t.destination,""),d.xp6(2),d.hij("",t.totalPrice," BGN"),d.xp6(4),d.Oqu(t.info),d.xp6(5),d.AsE(" ",t.applicationUser.firstName," ",t.applicationUser.lastName," "),d.xp6(3),d.Oqu(d.lcZ(27,14,"Cancel")),d.xp6(3),d.Oqu(d.lcZ(30,16,"Accept")),d.xp6(3),d.Oqu(d.lcZ(33,18,"Call passenger"))}}function m(t,e){if(1&t){const t=d.EpF();d.TgZ(0,"div",5),d.TgZ(1,"a",6),d.TgZ(2,"div",7),d.TgZ(3,"small"),d._uU(4),d.ALo(5,"date"),d.qZA(),d.TgZ(6,"small"),d._UZ(7,"i",8),d._uU(8),d.qZA(),d.qZA(),d.TgZ(9,"h4",9),d._uU(10),d._UZ(11,"ion-icon",10),d._uU(12),d.qZA(),d.TgZ(13,"h5",9),d._uU(14),d.qZA(),d._UZ(15,"hr"),d.TgZ(16,"div",11),d.TgZ(17,"p"),d._uU(18),d.qZA(),d._UZ(19,"br"),d.qZA(),d.TgZ(20,"div",11),d.TgZ(21,"p"),d._UZ(22,"ion-icon",12),d._uU(23),d.qZA(),d.qZA(),d.TgZ(24,"div",7),d.TgZ(25,"button",15),d.NdJ("click",function(){d.CHM(t);const n=e.$implicit;return d.oxw().callToUser(n.applicationUser.phone)}),d._uU(26),d.ALo(27,"translate"),d.qZA(),d.TgZ(28,"button",14),d.NdJ("click",function(){d.CHM(t);const n=e.$implicit;return d.oxw().closeOrder(n)}),d._uU(29),d.ALo(30,"translate"),d.qZA(),d.qZA(),d.qZA(),d.qZA()}if(2&t){const t=e.$implicit;d.xp6(4),d.Oqu(d.xi3(5,10,t.createdOn,"MM/dd/yyyy h:mm")),d.xp6(4),d.hij(" ",t.date,""),d.xp6(2),d.hij("",t.location," "),d.xp6(2),d.hij(" ",t.destination,""),d.xp6(2),d.hij("",t.totalPrice," BGN"),d.xp6(4),d.Oqu(t.info),d.xp6(5),d.AsE(" ",t.applicationUser.firstName," ",t.applicationUser.lastName," "),d.xp6(3),d.Oqu(d.lcZ(27,13,"Call passenger")),d.xp6(3),d.Oqu(d.lcZ(30,15,"Finish trip"))}}const f=[{path:"",component:(()=>{class t{constructor(t,e,n,i,r,o){this.popoverController=t,this.accountService=e,this.subOrderService=n,this.optionsService=i,this.callNumber=r,this.route=o,this.subscriptions=[],this.user=this.accountService.userValue,this.isLoggedIn=!1,this.inProgress=!1,this.subOrders=[],this.mySubOrders=[],this.progressOrders=[]}ngOnInit(){this.user.token&&(this.isLoggedIn=!0),this.getSubOrderByStatusAccepted("Accepted"),this.getSubOrderByStatusProgress("InProgress");const t=(new a.su).configureLogging(a.in.Information).withUrl(`${l.N.signalRUrl}/orderHub`).build();t.start().then(function(){console.log("signalR Connected in travelling")}).catch(function(t){return console.log(t)}),t.on("InProgressSubOrder",t=>{this.getSubOrderByStatusAccepted("Accepted"),this.getSubOrderByStatusProgress("InProgress")}),t.on("FinishSubOrder",t=>{this.getSubOrderByStatusAccepted("Accepted"),this.getSubOrderByStatusProgress("InProgress")}),t.on("OrderDeleted",t=>{this.getSubOrderByStatusAccepted("Accepted"),this.getSubOrderByStatusProgress("InProgress")}),t.on("AcceptSubOrder",t=>{this.getSubOrderByStatusAccepted("Accepted"),this.getSubOrderByStatusProgress("InProgress")})}getSubOrderByStatusProgress(t){this.subscriptions.push(this.subOrderService.getAllSubOrders(t).subscribe(t=>{null!=t&&(console.log(t,"Progress"),this.progressOrders=t.filter(t=>t.acceptedBy==this.accountService.userValue.id),this.progressOrders.forEach(t=>{this.optionsService.getOptionById(t.optionsId).subscribe(e=>{let n=e;t.location=n.location,t.destination=n.destination})}))}))}getSubOrderByStatusAccepted(t){this.subscriptions.push(this.subOrderService.getAllSubOrders(t).subscribe(t=>{null!=t&&(console.log(t,"Accepted"),this.mySubOrders=t.filter(t=>t.acceptedBy==this.accountService.userValue.id),this.mySubOrders.forEach(t=>{this.optionsService.getOptionById(t.optionsId).subscribe(e=>{let n=e;t.location=n.location,t.destination=n.destination})}))}))}acceptByUser(t){this.subscriptions.push(this.subOrderService.inProgressSubOrders(t).subscribe(t=>{t&&this.getSubOrderByStatusProgress("InProgress")}))}cancelOrder(t){this.subscriptions.push(this.subOrderService.refuseSubOrder(t.id).subscribe(t=>{t&&this.route.navigate(["menu/categories"])}))}closeOrder(t){this.subscriptions.push(this.subOrderService.closedSubOrder(t.id).subscribe(e=>{e&&this.subOrderService.deleteOrder(t.id).subscribe(t=>{})}))}callToUser(t){let e=t.toString();this.callNumber.callNumber(e,!0).then(t=>console.log("Launched dialer!",t)).catch(t=>console.log("Error launching dialer",t))}openLanguagePopover(t){return(0,u.mG)(this,void 0,void 0,function*(){const e=yield this.popoverController.create({component:g.m,event:t});yield e.present()})}}return t.\u0275fac=function(e){return new(e||t)(d.Y36(s.Dh),d.Y36(p.B),d.Y36(h.g),d.Y36(b.I),d.Y36(o.X),d.Y36(c.F0))},t.\u0275cmp=d.Xpm({type:t,selectors:[["app-reservations"]],decls:14,vars:5,consts:[["slot","start"],["slot","end"],["id","toolbarIcon","name","language-outline",3,"click"],[1,"col-md-10"],["id","orderDiv","class","list-group mt-2",4,"ngFor","ngForOf"],["id","orderDiv",1,"list-group","mt-2"],[1,"text","list-group-item","list-group-item-action","flex-column","align-items-start"],[1,"d-flex","w-100","justify-content-between"],[1,"fa","fa-calendar"],[1,"mt-1","text-center"],["name","arrow-forward-outline",1,"mr-2"],[1,"row","pl-3"],["name","person"],["type","button",1,"fonted","btn","btn-danger",3,"click"],["type","button",1,"fonted","btn","btn-info",3,"click"],["type","button",1,"fonted","btn","btn-warning",3,"click"]],template:function(t,e){1&t&&(d.TgZ(0,"ion-header"),d.TgZ(1,"ion-toolbar"),d.TgZ(2,"ion-buttons",0),d._UZ(3,"ion-menu-button"),d.qZA(),d.TgZ(4,"ion-title"),d.TgZ(5,"ion-label"),d._uU(6),d.ALo(7,"translate"),d.qZA(),d.qZA(),d.TgZ(8,"ion-buttons",1),d.TgZ(9,"ion-icon",2),d.NdJ("click",function(t){return e.openLanguagePopover(t)}),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(10,"ion-content"),d.TgZ(11,"div",3),d.YNc(12,O,34,20,"div",4),d.YNc(13,m,31,17,"div",4),d.qZA(),d.qZA()),2&t&&(d.xp6(6),d.Oqu(d.lcZ(7,3,"Reservations")),d.xp6(6),d.Q6J("ngForOf",e.mySubOrders),d.xp6(1),d.Q6J("ngForOf",e.progressOrders))},directives:[s.Gu,s.sr,s.Sm,s.fG,s.wd,s.Q$,s.gu,s.W2,i.sg],pipes:[Z.X$,i.uU],styles:["ion-content[_ngcontent-%COMP%]{--ion-background-color:#e9e9e9}ion-toolbar[_ngcontent-%COMP%]{--ion-background-color:#eee}#map[_ngcontent-%COMP%]{height:100%;width:100%}ion-title[_ngcontent-%COMP%]{text-align:center}h5[_ngcontent-%COMP%]{font-size:.9em}#toolbarIcon[_ngcontent-%COMP%]{font-size:1.7em}.fonted[_ngcontent-%COMP%]{font-family:Open Sans Light}.centered[_ngcontent-%COMP%]{text-align:center}.text[_ngcontent-%COMP%]{font-family:Open Sans Light}hr[_ngcontent-%COMP%]{background:#eee;width:70%!important}.blink_me[_ngcontent-%COMP%]{-webkit-animation:blinker 1s linear infinite;animation:blinker 1s linear infinite}@-webkit-keyframes blinker{50%{opacity:0}}@keyframes blinker{50%{opacity:0}}.msg-box[_ngcontent-%COMP%]{width:100%;height:140px;padding:10px 30px;font-size:14px;font-family:Open Sans Light;overflow:auto}.msg-box[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:-5px;list-style:none}.msg-box[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   .ex-msg[_ngcontent-%COMP%]{text-align:right}.msg-box[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   .in-msg[_ngcontent-%COMP%]{text-align:left;margin-left:-60px}"]}),t})()}];let A=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.oAB({type:t}),t.\u0275inj=d.cJS({imports:[[c.Bz.forChild(f)],c.Bz]}),t})();var S=n(1841),_=n(2472),y=n(3577);function v(t){return new _.w(t)}let x=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.oAB({type:t}),t.\u0275inj=d.cJS({providers:[o.X],imports:[[i.ez,r.u5,s.Pc,A,Z.aw.forChild({loader:{provide:Z.Zw,useFactory:v,deps:[S.eN]}}),y.LanguagePopoverPageModule]]}),t})()}}]);