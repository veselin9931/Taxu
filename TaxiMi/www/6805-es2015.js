(self.webpackChunkcsharpcornerauthor=self.webpackChunkcsharpcornerauthor||[]).push([[6805],{297:function(e,t,r){"use strict";r.d(t,{p:function(){return l}});var i=r(205),o=r(5304),n=r(3342),s=r(2340),a=r(3018),c=r(1841),d=r(728);let l=(()=>{class e{constructor(e,t){this.http=e,this.sharedService=t,this.orders=[],this.completedOrder=!1}createOrder(e){const t=this.sharedService.headerGerneration();return this.http.post(`${s.N.apiUrl}/api/order`,e,{headers:t,responseType:"text"}).pipe((0,o.K)(this.handleError))}addToFavourites(e){const t=this.sharedService.headerGerneration();return this.http.post(`${s.N.apiUrl}/api/order/favourites`,e,{headers:t,responseType:"text"}).pipe((0,o.K)(this.handleError))}getMyFavourites(e){const t=this.sharedService.headerGerneration();return this.http.get(`${s.N.apiUrl}/api/order/favourites/${e}`,{headers:t}).pipe((0,o.K)(this.handleError))}deleteFavouriteOrder(e){const t=this.sharedService.headerGerneration();return this.http.delete(`${s.N.apiUrl}/api/order/favourites/${e}`,{headers:t}).pipe((0,n.b)(e=>console.log("deleted favourite order: ",JSON.stringify(e))),(0,o.K)(this.handleError))}getDirections(e,t,r,i){const n=this.sharedService.headerGerneration();return this.http.post(`https://maps.googleapis.com/maps/api/distancematrix/json?units=imperial&origins=${e},${t}&destinations=${r}%2C${i}%7C&key=AIzaSyAEvlXdM4joG4bNVT5l-tJSk9lUSGhxMNw`,{headers:n,responseType:"text"}).pipe((0,o.K)(this.handleError))}getOrderById(e){const t=this.sharedService.headerGerneration();return this.http.get(`${s.N.apiUrl}/api/order/id/${e}`,{headers:t}).pipe((0,n.b)(e=>this.order=e))}getCanceledOrderById(e){const t=this.sharedService.headerGerneration();return this.http.get(`${s.N.apiUrl}/api/order/canceled/${e}`,{headers:t}).pipe((0,n.b)(e=>this.order=e))}getLastCompletedOrder(e){const t=this.sharedService.headerGerneration();return this.http.get(`${s.N.apiUrl}/api/order/completed/${e}`,{headers:t}).pipe((0,o.K)(this.handleError))}getMyOrder(e){const t=this.sharedService.headerGerneration();return this.http.get(`${s.N.apiUrl}/api/order/${e}`,{headers:t}).pipe((0,o.K)(this.handleError))}getOrderForChat(e){const t=this.sharedService.headerGerneration();return this.http.get(`${s.N.apiUrl}/api/order/chat/${e}`,{headers:t}).pipe((0,o.K)(this.handleError))}getAllOrders(){const e=this.sharedService.headerGerneration();return this.http.get(`${s.N.apiUrl}/api/order`,{headers:e}).pipe((0,o.K)(this.handleError))}getNormalOrders(){const e=this.sharedService.headerGerneration();return this.http.get(`${s.N.apiUrl}/api/order/normal`,{headers:e}).pipe((0,o.K)(this.handleError))}getComfortOrders(){const e=this.sharedService.headerGerneration();return this.http.get(`${s.N.apiUrl}/api/order/comfort`,{headers:e}).pipe((0,o.K)(this.handleError))}acceptOrder(e,t){const r=this.sharedService.headerGerneration();return this.http.put(`${s.N.apiUrl}/api/order/${e}/${t}`,{headers:r,responseType:"json"}).pipe((0,n.b)(e=>this.driverId=t),(0,o.K)(this.handleError))}updateOrderEta(e,t){const r=this.sharedService.headerGerneration();return this.http.put(`${s.N.apiUrl}/api/order/eta/${e}/${t}`,{headers:r,responseType:"json"}).pipe((0,o.K)(this.handleError))}updateDriverArrived(e){const t=this.sharedService.headerGerneration();return this.http.put(`${s.N.apiUrl}/api/order/arrived/${e}`,{headers:t,responseType:"json"}).pipe((0,o.K)(this.handleError))}rateOrder(e){const t=this.sharedService.headerGerneration();return this.http.put(`${s.N.apiUrl}/api/order/rate/${e}`,{headers:t,responseType:"json"}).pipe((0,o.K)(this.handleError))}increaseOrderPrice(e,t){const r=this.sharedService.headerGerneration();return this.http.put(`${s.N.apiUrl}/api/order/increase/${e}/${t}`,{headers:r,responseType:"json"}).pipe((0,o.K)(this.handleError))}completeOrder(e){const t=this.sharedService.headerGerneration();return this.http.put(`${s.N.apiUrl}/api/order/${e}`,{headers:t,responseType:"json"}).pipe((0,o.K)(this.handleError))}deleteOrder(e){const t=this.sharedService.headerGerneration();return this.http.delete(`${s.N.apiUrl}/api/order/${e}`,{headers:t}).pipe((0,n.b)(e=>console.log("deleted order: ",JSON.stringify(e))),(0,o.K)(this.handleError))}driverIncreaseOrderPrice(e,t,r){const i=this.sharedService.headerGerneration();return this.http.put(`${s.N.apiUrl}/api/order/increased/${e}/${t}/${r}`,{headers:i,responseType:"json"}).pipe((0,o.K)(this.handleError))}resetIncreasing(e){const t=this.sharedService.headerGerneration();return this.http.put(`${s.N.apiUrl}/api/order/reset/${e}`,{headers:t,responseType:"json"}).pipe((0,o.K)(this.handleError))}increasedOrderAccept(e,t){const r=this.sharedService.headerGerneration();return this.http.put(`${s.N.apiUrl}/api/order/accepted/increase/${e}/${t}`,{headers:r,responseType:"json"}).pipe((0,o.K)(this.handleError))}incrementOrderPrice(e){const t=this.sharedService.headerGerneration();return this.http.put(`${s.N.apiUrl}/api/order/increment/${e}`,{headers:t,responseType:"json"}).pipe((0,o.K)(this.handleError))}decrementOrderPrice(e){const t=this.sharedService.headerGerneration();return this.http.put(`${s.N.apiUrl}/api/order/decrement/${e}`,{headers:t,responseType:"json"}).pipe((0,o.K)(this.handleError))}handleError(e){let t="";return e.error instanceof ErrorEvent?(console.log("Client side error."),t=`Error: ${e.error.message}`):(console.log("Server side error."),t=`Error Code: ${e.status}\nMessage: ${e.message}`),console.log(t),(0,i._)(t)}}return e.\u0275fac=function(t){return new(t||e)(a.LFG(c.eN),a.LFG(d.F))},e.\u0275prov=a.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},6805:function(e,t,r){"use strict";r.r(t),r.d(t,{HttpLoaderFactory:function(){return V},TravellingPageModule:function(){return j}});var i=r(8583),o=r(3679),n=r(7823),s=r(4481),a=r(4762),c=r(4426),d=r(2340),l=r(6522),h=r(5435),u=r(7393);class p{call(e,t){return t.subscribe(new g(e))}}class g extends u.L{constructor(e){super(e),this.hasPrev=!1}_next(e){let t;this.hasPrev?t=[this.prev,e]:this.hasPrev=!0,this.prev=e,t&&this.destination.next(t)}}var m=r(3018),f=r(297),v=r(5056),b=r(7800),Z=r(7324);const x=["mydt"];function S(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"p",21),m.NdJ("click",function(){return m.CHM(e),m.oxw(2).locationMap()}),m._UZ(1,"ion-icon",22),m._uU(2),m.qZA()}if(2&e){const e=m.oxw(2);m.xp6(2),m.hij(" ",e.orderService.chosenLocation," ")}}function T(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"p",21),m.NdJ("click",function(){return m.CHM(e),m.oxw(2).locationMap()}),m._UZ(1,"ion-icon",22),m._uU(2),m.ALo(3,"translate"),m.qZA()}2&e&&(m.xp6(2),m.hij("",m.lcZ(3,1,"Take me from here")," "))}function A(e,t){if(1&e&&(m.TgZ(0,"div",19),m.YNc(1,S,3,1,"p",20),m.YNc(2,T,4,3,"p",20),m._UZ(3,"hr"),m.qZA()),2&e){const e=m.oxw();m.xp6(1),m.Q6J("ngIf",null!=e.orderService.chosenLocation),m.xp6(1),m.Q6J("ngIf",null==e.orderService.chosenLocation)}}function L(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"p",21),m.NdJ("click",function(){return m.CHM(e),m.oxw(2).destinationMap()}),m._UZ(1,"ion-icon",24),m._uU(2),m.qZA()}if(2&e){const e=m.oxw(2);m.xp6(2),m.hij(" ",e.orderService.chosenDestination," ")}}function C(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"p",21),m.NdJ("click",function(){return m.CHM(e),m.oxw(2).destinationMap()}),m._UZ(1,"ion-icon",24),m._uU(2),m.ALo(3,"translate"),m.qZA()}2&e&&(m.xp6(2),m.hij("",m.lcZ(3,1,"Choose destination")," "))}function O(e,t){if(1&e&&(m.TgZ(0,"div",23),m.YNc(1,L,3,1,"p",20),m.YNc(2,C,4,3,"p",20),m.qZA()),2&e){const e=m.oxw();m.xp6(1),m.Q6J("ngIf",null!=e.orderService.chosenDestination),m.xp6(1),m.Q6J("ngIf",null==e.orderService.chosenDestination)}}function P(e,t){if(1&e&&(m.TgZ(0,"div",19),m.TgZ(1,"p"),m._UZ(2,"ion-icon",25),m._uU(3),m.qZA(),m._UZ(4,"hr"),m.TgZ(5,"p"),m._UZ(6,"ion-icon",24),m._uU(7),m.qZA(),m.qZA()),2&e){const e=m.oxw();m.xp6(3),m.hij("",e.order.location," "),m.xp6(4),m.hij("",e.order.destination," ")}}function y(e,t){1&e&&(m.TgZ(0,"div",26),m._UZ(1,"hr"),m.TgZ(2,"ion-label"),m._uU(3),m.ALo(4,"translate"),m.qZA(),m._UZ(5,"br"),m.qZA()),2&e&&(m.xp6(3),m.Oqu(m.lcZ(4,1,"Additional options")))}function U(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"div",27),m.TgZ(1,"ion-checkbox",28),m.NdJ("click",function(){return m.CHM(e),m.oxw().priceUpdate()}),m.qZA(),m.TgZ(2,"ion-label",29),m._UZ(3,"ion-icon",30),m._uU(4),m.ALo(5,"translate"),m.qZA(),m._UZ(6,"br"),m._UZ(7,"ion-checkbox",31),m.TgZ(8,"ion-label",29),m._UZ(9,"ion-icon",32),m._uU(10),m.ALo(11,"translate"),m.qZA(),m._UZ(12,"br"),m._UZ(13,"ion-checkbox",33),m.TgZ(14,"ion-label",29),m._UZ(15,"ion-icon",34),m._uU(16),m.ALo(17,"translate"),m.qZA(),m.qZA()}2&e&&(m.xp6(4),m.hij(" ",m.lcZ(5,3,"Pets")," + 2.20 \u043b\u0432. "),m.xp6(6),m.hij(" ",m.lcZ(11,5,"Baggage")," "),m.xp6(6),m.hij(" ",m.lcZ(17,7,"Special needs")," "))}const k=function(e){return{border:e}};function N(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"div",14),m.TgZ(1,"div",35),m.TgZ(2,"ion-label"),m._uU(3),m.ALo(4,"translate"),m.qZA(),m.qZA(),m.TgZ(5,"div",36),m.NdJ("click",function(){return m.CHM(e),m.oxw().onSelectCar("normal")}),m._UZ(6,"img",37),m.qZA(),m.TgZ(7,"div",36),m.NdJ("click",function(){return m.CHM(e),m.oxw().onSelectCar("comfort")}),m._UZ(8,"img",38),m.qZA(),m.qZA()}if(2&e){const e=m.oxw();m.xp6(3),m.Oqu(m.lcZ(4,3,"Car type (optional)")),m.xp6(3),m.Q6J("ngStyle",m.VKq(5,k,"normal"==e.carValue?"3px solid rgb(255, 208, 0)":"3px solid rgb(109, 109, 109)")),m.xp6(2),m.Q6J("ngStyle",m.VKq(7,k,"comfort"==e.carValue?"3px solid rgb(255, 208, 0)":"3px solid rgb(109, 109, 109)"))}}function w(e,t){if(1&e&&(m.TgZ(0,"div",39),m.TgZ(1,"div",6),m.TgZ(2,"button",40),m.TgZ(3,"div",41),m._UZ(4,"ion-datetime",42,43),m.ALo(6,"translate"),m.TgZ(7,"ion-label"),m._UZ(8,"ion-icon",44),m.qZA(),m.qZA(),m.qZA(),m.TgZ(9,"div",19),m._UZ(10,"ion-input",45),m.ALo(11,"translate"),m.qZA(),m.qZA(),m.qZA()),2&e){const e=m.oxw();m.xp6(4),m.s9C("placeholder",m.lcZ(6,3,"Time")),m.Q6J("pickerOptions",e.customPickerOptions),m.xp6(6),m.Q6J("placeholder",m.lcZ(11,5,"Additional requirements"))}}function _(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"div",23),m.TgZ(1,"div",41),m.TgZ(2,"h5",46),m._uU(3),m.ALo(4,"translate"),m.qZA(),m.TgZ(5,"a",47),m.TgZ(6,"button",48),m._uU(7),m.ALo(8,"number"),m.qZA(),m.TgZ(9,"button",49),m.NdJ("click",function(){return m.CHM(e),m.oxw().increment()}),m._uU(10,"+"),m.qZA(),m.qZA(),m.qZA(),m._UZ(11,"hr"),m.qZA()}if(2&e){const e=m.oxw();m.xp6(3),m.Oqu(m.lcZ(4,2,"Increase amount")),m.xp6(4),m.hij("",m.xi3(8,4,e.order.totalPrice,"1.2-2")," \u043b\u0432.")}}function q(e,t){1&e&&m._UZ(0,"span",52)}function $(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"button",50),m.NdJ("click",function(){return m.CHM(e),m.oxw().onSubmit()}),m._uU(1),m.ALo(2,"number"),m.ALo(3,"translate"),m.YNc(4,q,1,0,"span",51),m.qZA()}if(2&e){const e=m.oxw();m.Q6J("disabled",e.isSubmitted),m.xp6(1),m.AsE(" ",m.xi3(2,4,e.orderTotalPrice,"1.2-2")," \u043b\u0432. | ",m.lcZ(3,7,"Make a order")," "),m.xp6(3),m.Q6J("ngIf",e.isSubmitted)}}function M(e,t){1&e&&(m.TgZ(0,"div",53),m.TgZ(1,"button",54),m._uU(2),m.ALo(3,"translate"),m.qZA(),m.qZA()),2&e&&(m.xp6(2),m.Oqu(m.lcZ(3,1,"Looking for a driver")))}function I(e,t){if(1&e&&(m.TgZ(0,"button",58),m._uU(1),m.ALo(2,"translate"),m.ALo(3,"number"),m.qZA()),2&e){const e=m.oxw(2);m.xp6(1),m.AsE("",m.lcZ(2,2,"Cost")," : ",m.xi3(3,4,e.order.totalPrice,"1.2-2")," \u043b\u0432.")}}function D(e,t){if(1&e){const e=m.EpF();m.TgZ(0,"button",59),m.NdJ("click",function(){return m.CHM(e),m.oxw(2).cancelOrder()}),m._uU(1),m.ALo(2,"translate"),m.qZA()}2&e&&(m.xp6(1),m.Oqu(m.lcZ(2,1,"Cancel")))}function E(e,t){if(1&e&&(m.TgZ(0,"ion-footer",55),m.TgZ(1,"ion-toolbar"),m.TgZ(2,"div",6),m.TgZ(3,"div",5),m.TgZ(4,"div",41),m.YNc(5,I,4,7,"button",56),m.YNc(6,D,3,3,"button",57),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA()),2&e){const e=m.oxw();m.xp6(5),m.Q6J("ngIf",1==e.isCompleted),m.xp6(1),m.Q6J("ngIf",1==e.isCompleted)}}const J=[{path:"",component:(()=>{class e{constructor(e,t,r,i,o,n,a,c,d){this.formBuilder=e,this.route=t,this.orderService=r,this.accountService=i,this.translate=o,this.popoverController=n,this.alertController=a,this.localNotifications=c,this.plt=d,this.user=this.accountService.userValue,this.choosedLocDest=!1,this.carModel="",this.carColor="",this.firstName="",this.lastName="",this.carValue="normal",this.isSubmitted=!1,this.isCompleted=!1,this.subscriptions=[],this.pushes=[],this.translate.setDefaultLang(this.accountService.userValue.choosenLanguage),this.dateAndTimePicker(),this.route.events.pipe((0,h.h)(e=>e instanceof s.R9),e=>e.lift(new p)).subscribe(e=>{console.log("previous url",e[0].urlAfterRedirects),"/menu/travel-mode"!=e[0].urlAfterRedirects&&"/menu/travelling"!=e[0].urlAfterRedirects||(this.backFromTravel(),console.log("gay"))})}ngOnInit(){this.loading=!0,this.form=this.formBuilder.group({applicationUserId:[""],location:this.orderService.chosenLocation,locationLat:this.orderService.userLocationLat,locationLong:this.orderService.userLocationLong,destination:this.orderService.chosenDestination,destinationLat:this.orderService.userDestinationLat,destinationLong:this.orderService.userDestinationLong,totalPrice:this.orderTotalPrice,tripDistance:0,userDistance:0,increasePrice:[0],status:"Waiting",eta:"",withPets:!1,withStroller:!1,special:!1,carType:this.carValue,description:"",pickUpTime:""});const e=(new c.su).configureLogging(c.in.Information).withUrl(`${d.N.signalRUrl}/orderHub`).build();e.start().then(function(){console.log("signalR Connected in travelling")}).catch(function(e){return console.log(e)}),e.on("CreatedOrder",()=>{this.checkorder()}),e.on("IncrementDecrement",e=>{this.subscriptions.push(this.orderService.getOrderById(e).subscribe(e=>{Math.round(100*this.orderTotalPrice),this.order.totalPrice=e.totalPrice}))}),e.on("OfferMorePrice",e=>{this.subscriptions.push(this.orderService.getOrderById(e).subscribe(e=>{e.id==this.order.id&&e.increasedByDriver>=.5&&(this.driverPrice=e.increasedByDriver,this.driverIncreased=e.increasedByDriver+this.orderTotalPrice,this.increasedOrder())}))}),e.on("OrderAccepted",()=>{this.subscriptions.push(this.orderService.getMyOrder(this.user.id).subscribe(e=>{"Accepted"==e.status&&(this.presentOrderAcceptedNotification(),this.checkorder())}))}),e.on("LocateDriver",e=>{})}presentOrderAcceptedNotification(){this.translate.get(["Order","Your order is accepted"]).subscribe(e=>{this.localNotifications.schedule({id:1,title:e.Order,text:e["Your order is accepted"],data:{secret:"secret"}})})}ionViewDidEnter(){this.form.value.carType="normal",this.carValue="normal",this.orderService.chosenDestination&&this.orderService.chosenLocation&&(this.choosedLocDest=!0),this.checkorder(),this.orderService.selectedFavourite?(this.orderService.chosenLocation=this.orderService.selectedFavourite.location,this.form.get("location").setValue(this.orderService.selectedFavourite.location),this.form.get("locationLat").setValue(+this.orderService.selectedFavourite.locationLat),this.form.get("locationLong").setValue(+this.orderService.selectedFavourite.locationLong),this.orderService.chosenDestination=this.orderService.selectedFavourite.destination,this.form.get("destination").setValue(this.orderService.selectedFavourite.destination),this.form.get("destinationLat").setValue(+this.orderService.selectedFavourite.destinationLat),this.form.get("destinationLong").setValue(+this.orderService.selectedFavourite.destinationLong)):(this.form.get("location").setValue(this.orderService.chosenLocation),this.form.get("locationLat").setValue(this.orderService.userLocationLat),this.form.get("locationLong").setValue(this.orderService.userLocationLong),this.form.get("destination").setValue(this.orderService.chosenDestination),this.form.get("destinationLat").setValue(this.orderService.userDestinationLat),this.form.get("destinationLong").setValue(this.orderService.userDestinationLong)),this.isCompleted&&(this.form.get("location").setValue(this.order.location),this.form.get("destination").setValue(this.order.destination))}get f(){return this.form.controls}locationMap(){this.route.navigate(["menu/location"])}destinationMap(){this.route.navigate(["menu/destination"])}onSubmit(){this.isSubmitted=!0,this.form.value.carType=this.carValue,null==this.form.value.location&&(this.locationError(),this.isSubmitted=!1),null==this.form.value.destination&&(this.destinationError(),this.isSubmitted=!1),this.form.valid&&(new google.maps.DirectionsService).route({origin:{lat:this.form.value.locationLat,lng:this.form.value.locationLong},destination:{lat:this.form.value.destinationLat,lng:this.form.value.destinationLong},travelMode:google.maps.TravelMode.DRIVING},(e,t)=>{if("OK"===t){if(this.estimatedDuration=e.routes[0].legs[0].duration.text,this.orderTotalDestination=e.routes[0].legs[0].distance.value/1e3,this.orderTotalPrice=.9*this.orderTotalDestination,1==this.form.value.withPets&&(this.orderTotalPrice+=2.2),"comfort"==this.form.value.carType&&(this.orderTotalPrice+=1),this.form.value.totalPrice=this.orderTotalPrice,this.form.value.tripDistance=this.orderTotalDestination,this.form.value.increasePrice=+this.form.value.increasePrice,this.form.value.eta=this.estimatedDuration,this.form.value.applicationUserId=this.user.id,this.isSubmitted=!0,!this.form.valid)return!1;this.subscriptions.push(this.orderService.createOrder(this.form.value).subscribe(e=>{this.form.value.locationLat=this.form.value.locationLat.toString(),this.form.value.locationLong=this.form.value.locationLong.toString(),this.orderStatus=this.form.value.status,this.subscriptions.push(this.orderService.getMyOrder(this.user.id).subscribe())})),console.log(this.order)}else this.isSubmitted=!1})}dateAndTimePicker(){this.translate.get(["Now","Cancel","Choose"]).subscribe(e=>{this.customPickerOptions={buttons:[{text:e.Now,handler:()=>{let e=new Date;this.mydt.value=`${e.getHours()}:${e.getMinutes()}`,console.log(this.mydt.value)}},{text:e.Cancel},{text:e.Choose,handler:e=>{this.mydt.value=`${e.hour.text}:${e.minute.text}`,console.log(e.hour.text),console.log(e.minute.text)}}]}})}offer(e){this.form.value.increasePrice=e}selector(e){let t=+e;0==t&&""==e||this.subscriptions.push(this.orderService.increaseOrderPrice(this.order.id,t).subscribe())}increment(){this.subscriptions.push(this.orderService.incrementOrderPrice(this.order.id).subscribe(()=>{}))}decrement(){this.orderTotalPrice>=1&&this.subscriptions.push(this.orderService.decrementOrderPrice(this.order.id).subscribe(()=>{}))}priceUpdate(){0==this.form.value.withPets&&(this.orderTotalPrice=this.orderTotalPrice+2.2,console.log(this.form.value)),1==this.form.value.withPets&&(this.orderTotalPrice=this.orderTotalPrice-2.2)}onSelectCar(e){this.form.value.carType=this.carValue,this.carValue=e,"normal"==e&&"comfort"==this.form.value.carType&&(this.orderTotalPrice=this.orderTotalPrice-1),"comfort"==e&&"normal"==this.form.value.carType&&(this.orderTotalPrice=this.orderTotalPrice+1),this.form.value.carType=e}checkorder(){this.orderService.userLocationLat&&(new google.maps.DirectionsService).route({origin:{lat:this.orderService.userLocationLat,lng:this.orderService.userLocationLong},destination:{lat:this.orderService.userDestinationLat,lng:this.orderService.userDestinationLong},travelMode:google.maps.TravelMode.DRIVING},(e,t)=>{"OK"===t&&(this.orderTotalDestination=e.routes[0].legs[0].distance.value/1e3,this.orderTotalPrice=.9*this.orderTotalDestination)}),this.subscriptions.push(this.orderService.getMyOrder(this.user.id).subscribe(e=>{"Canceled"!=e.status?(this.orderService.currentOrderId=e.id,this.location=e.location,this.destination=e.destination,(Math.round(100*this.orderTotalPrice)/100).toFixed(2),this.orderTotalPrice=e.totalPrice,this.order=e,this.estimatedDuration=e.eta,"Waiting"==e.status&&null!=e&&(this.orderStatus=e.status,this.isCompleted=!0),"Accepted"==e.status&&null!=e&&(this.isSubmitted=!1,this.route.navigate(["menu/travel-mode"]),this.isCompleted=!1)):this.orderTotalPrice=0},e=>{console.log(e)}))}cancelOrder(){this.subscriptions.push(this.orderService.getMyOrder(this.user.id).subscribe(e=>{this.subscriptions.push(this.orderService.deleteOrder(e.id).subscribe(()=>{this.choosedLocDest=!1,this.isCompleted=!1,this.orderStatus=null,this.orderTotalPrice=0,this.clearForm(),this.isSubmitted=!1}))}))}openLanguagePopover(e){return(0,a.mG)(this,void 0,void 0,function*(){const t=yield this.popoverController.create({component:l.m,event:e});yield t.present()})}locationError(){return(0,a.mG)(this,void 0,void 0,function*(){this.translate.get(["Location field is required!"]).subscribe(e=>(0,a.mG)(this,void 0,void 0,function*(){const t=yield this.alertController.create({header:e["Location field is required!"],buttons:[{text:"Ok",role:"Ok"}]});yield t.present()}))})}destinationError(){return(0,a.mG)(this,void 0,void 0,function*(){this.translate.get(["Destination field is required!"]).subscribe(e=>(0,a.mG)(this,void 0,void 0,function*(){const t=yield this.alertController.create({header:e["Destination field is required!"],buttons:[{text:"Ok",role:"Ok"}]});yield t.present()}))})}increasedOrder(){return(0,a.mG)(this,void 0,void 0,function*(){let e={};e.first=this.translate.instant("Driver offers you"),e.second=this.translate.instant("\u043b\u0432. for the order"),this.translate.get(["Accept","Cancel"]).subscribe(t=>(0,a.mG)(this,void 0,void 0,function*(){const r=yield this.alertController.create({header:`${e.first} ${this.driverIncreased.toFixed(2)} ${e.second}`,buttons:[{text:t.Accept,handler:()=>{this.subscriptions.push(this.orderService.getMyOrder(this.user.id).subscribe(e=>{this.subscriptions.push(this.orderService.increasedOrderAccept(e.id,!0).subscribe(()=>{this.subscriptions.push(this.orderService.increaseOrderPrice(e.id,this.driverPrice).subscribe(()=>{}))}))}))}},{text:t.Cancel,handler:()=>{this.subscriptions.push(this.orderService.getMyOrder(this.user.id).subscribe(e=>{this.subscriptions.push(this.orderService.increasedOrderAccept(e.id,!1).subscribe(()=>{})),this.subscriptions.push(this.orderService.resetIncreasing(this.order.id).subscribe(()=>{}))}))}}]});yield r.present()}))})}backFromTravel(){this.choosedLocDest=!1,this.isCompleted=!1,this.orderStatus=null,this.orderTotalPrice=0,this.clearForm(),this.isSubmitted=!1}clearForm(){this.translate.get(["Take me from here","Choose destination"]).subscribe(e=>{this.orderService.chosenLocation=e["Take me from here"],this.orderService.chosenDestination=e["Choose destination"]}),this.form.reset({location:void 0,destination:void 0,increaseAmount:"",applicationUserId:"",locationLat:0,locationLong:0,destinationLat:0,destinationLong:0,totalPrice:0,tripDistance:0,userDistance:0,increasePrice:0,status:"Waiting",eta:"",withPets:!1,withStroller:!1,special:!1,carType:"normal"})}}return e.\u0275fac=function(t){return new(t||e)(m.Y36(o.qu),m.Y36(s.F0),m.Y36(f.p),m.Y36(v.B),m.Y36(b.sK),m.Y36(n.Dh),m.Y36(n.Br),m.Y36(Z.sn),m.Y36(n.t4))},e.\u0275cmp=m.Xpm({type:e,selectors:[["app-travelling"]],viewQuery:function(e,t){if(1&e&&m.Gf(x,1),2&e){let e;m.iGM(e=m.CRH())&&(t.mydt=e.first)}},decls:30,vars:15,consts:[["padding",""],["slot","start"],["slot","end"],["id","toolbarIcon","name","language-outline",3,"click"],[1,"row","mt-2"],[1,"col"],[1,"row"],["novalidate","",1,"col",3,"formGroup"],["class","form-group col mt-2",4,"ngIf"],["class","form-group col mt-3",4,"ngIf"],["class","text-center mb-2",4,"ngIf"],["class","col-md-12 text-left",4,"ngIf"],["class","row text-center",4,"ngIf"],["class","col mt-2",4,"ngIf"],[1,"row","text-center"],[1,"col-md-12"],["type","button","class","mt-1 btn btn-warning fonted",3,"disabled","click",4,"ngIf"],["class","blink_me col-md-12 mt-3 text-center fonted",4,"ngIf"],["class","ion-no-border",4,"ngIf"],[1,"form-group","col","mt-2"],[3,"click",4,"ngIf"],[3,"click"],["name","location-outline",1,"mr-2"],[1,"form-group","col","mt-3"],["name","arrow-forward-outline",1,"mr-2"],["name","analytics-outline",1,"mr-2"],[1,"text-center","mb-2"],[1,"col-md-12","text-left"],["color","dark","value","With pets","formControlName","withPets",3,"click"],[1,"ml-2"],["name","paw"],["color","dark","value","With stroller","formControlName","withStroller"],["name","bag-handle"],["color","dark","value","Special needs","formControlName","special"],["name","information-circle"],[1,"col-md-12","mb-2"],[1,"col",3,"click"],["id","normal","src","../../assets/normtext.png","width","100","height","100",3,"ngStyle"],["id","comfort","src","../../assets/comftext.png","width","100","height","100",3,"ngStyle"],[1,"col","mt-2"],[1,"btn","btn-light","btn-sm","timebtn"],[1,"d-flex","w-100","justify-content-between"],["formControlName","pickUpTime","displayFormat","HH:mm",1,"date",3,"placeholder","pickerOptions"],["mydt",""],["name","time-outline",1,"icn"],["formControlName","description","type","text",1,"form-control",3,"placeholder"],[1,"fonted"],[1,"mr-1"],[1,"btn","btn-light","btn-sm"],[1,"btn","btn-light","btn-sm","ml-1",3,"click"],["type","button",1,"mt-1","btn","btn-warning","fonted",3,"disabled","click"],["class","spinner-border spinner-border-sm mr-1",4,"ngIf"],[1,"spinner-border","spinner-border-sm","mr-1"],[1,"blink_me","col-md-12","mt-3","text-center","fonted"],[1,"btn","btn-warning","fonted"],[1,"ion-no-border"],["class","ml-3 btn btn-info fonted",4,"ngIf"],["class","mr-3 btn btn-danger fonted",3,"click",4,"ngIf"],[1,"ml-3","btn","btn-info","fonted"],[1,"mr-3","btn","btn-danger","fonted",3,"click"]],template:function(e,t){1&e&&(m.TgZ(0,"ion-content",0),m.TgZ(1,"ion-header"),m.TgZ(2,"ion-toolbar"),m.TgZ(3,"ion-buttons",1),m._UZ(4,"ion-menu-button"),m.qZA(),m.TgZ(5,"ion-title"),m.TgZ(6,"ion-label"),m._uU(7),m.ALo(8,"translate"),m.qZA(),m.qZA(),m.TgZ(9,"ion-buttons",2),m.TgZ(10,"ion-icon",3),m.NdJ("click",function(e){return t.openLanguagePopover(e)}),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(11,"div",4),m.TgZ(12,"div",5),m.TgZ(13,"ion-text"),m.TgZ(14,"div",6),m.TgZ(15,"form",7),m.YNc(16,A,4,2,"div",8),m.YNc(17,O,3,2,"div",9),m.YNc(18,P,8,2,"div",8),m.YNc(19,y,6,3,"div",10),m.YNc(20,U,18,9,"div",11),m._UZ(21,"hr"),m.YNc(22,N,9,9,"div",12),m.YNc(23,w,12,7,"div",13),m.YNc(24,_,12,7,"div",9),m.TgZ(25,"div",14),m.TgZ(26,"div",15),m.YNc(27,$,5,9,"button",16),m.qZA(),m.qZA(),m.qZA(),m.YNc(28,M,4,3,"div",17),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.YNc(29,E,7,2,"ion-footer",18)),2&e&&(m.xp6(7),m.Oqu(m.lcZ(8,13,"Travel")),m.xp6(8),m.Q6J("formGroup",t.form),m.xp6(1),m.Q6J("ngIf",0==t.isCompleted),m.xp6(1),m.Q6J("ngIf",0==t.isCompleted),m.xp6(1),m.Q6J("ngIf",1==t.isCompleted),m.xp6(1),m.Q6J("ngIf",0==t.isCompleted&&1==t.choosedLocDest),m.xp6(1),m.Q6J("ngIf",0==t.isCompleted&&1==t.choosedLocDest),m.xp6(2),m.Q6J("ngIf",0==t.isCompleted&&1==t.choosedLocDest),m.xp6(1),m.Q6J("ngIf",0==t.isCompleted&&1==t.choosedLocDest),m.xp6(1),m.Q6J("ngIf","Waiting"==t.orderStatus),m.xp6(3),m.Q6J("ngIf",0==t.isCompleted),m.xp6(1),m.Q6J("ngIf",1==t.isCompleted),m.xp6(1),m.Q6J("ngIf",1==t.isCompleted))},directives:[n.W2,n.Gu,n.sr,n.Sm,n.fG,n.wd,n.Q$,n.gu,n.yW,o.Y7,o.JL,o.sg,i.O5,n.nz,n.w,o.JJ,o.u,i.PC,n.x4,n.QI,n.pK,n.j9,n.fr],pipes:[b.X$,i.JJ],styles:["ion-content[_ngcontent-%COMP%]{--ion-background-color:#e9e9e9}ion-toolbar[_ngcontent-%COMP%]{--ion-background-color:#eee}ion-title[_ngcontent-%COMP%]{text-align:center}#normal[_ngcontent-%COMP%]{border-radius:20px}#comfort[_ngcontent-%COMP%]{border:3px solid #6d6d6d;border-radius:20px}.noScroll[_ngcontent-%COMP%]{overflow:hidden}#marker[_ngcontent-%COMP%]{position:absolute;background:url(http://maps.gstatic.com/mapfiles/markers2/marker.png) no-repeat;top:50%;left:50%;z-index:1;margin-left:-10px;margin-top:-34px;height:34px;width:20px;cursor:pointer}#map[_ngcontent-%COMP%]{height:100%;width:100%}#toolbarIcon[_ngcontent-%COMP%]{font-size:1.7em}.centered[_ngcontent-%COMP%]{text-align:center}.textTravel[_ngcontent-%COMP%]{font-size:1.5em}.text[_ngcontent-%COMP%], .textTravel[_ngcontent-%COMP%]{font-family:Open Sans Light}.text[_ngcontent-%COMP%]{font-size:1.4em}.checkbox-icon[_ngcontent-%COMP%]{color:#fff}ion-select[_ngcontent-%COMP%]{color:#383838;background-color:#fff;border-radius:10px;border:3px solid #eee}.blink_me[_ngcontent-%COMP%]{-webkit-animation:blinker 1s linear infinite;animation:blinker 1s linear infinite}@-webkit-keyframes blinker{50%{opacity:0}}@keyframes blinker{50%{opacity:0}}.backIcon[_ngcontent-%COMP%]{font-size:150%}.back[_ngcontent-%COMP%], .backIcon[_ngcontent-%COMP%]{color:#ffae00}.fonted[_ngcontent-%COMP%]{font-family:Open Sans Light}.icn[_ngcontent-%COMP%]{font-size:20px;margin-top:4px}.date[_ngcontent-%COMP%]{line-height:10px}.timebtn[_ngcontent-%COMP%]{margin-left:3%;margin-top:8px;width:110px;height:38px}"]}),e})()}];let G=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=m.oAB({type:e}),e.\u0275inj=m.cJS({imports:[[s.Bz.forChild(J)],s.Bz]}),e})();var F=r(1841),Y=r(2472),K=r(3577);function V(e){return new Y.w(e)}let j=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=m.oAB({type:e}),e.\u0275inj=m.cJS({providers:[b.sK],imports:[[i.ez,o.u5,n.Pc,G,o.UX,b.aw.forChild({loader:{provide:b.Zw,useFactory:V,deps:[F.eN]}}),K.LanguagePopoverPageModule]]}),e})()}}]);