!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(self.webpackChunkcsharpcornerauthor=self.webpackChunkcsharpcornerauthor||[]).push([[6637],{6637:function(n,r,i){"use strict";i.r(r),i.d(r,{HttpLoaderFactory:function(){return P},ReservationsPageModule:function(){return T}});var o=i(8583),s=i(3679),c=i(4687),u=i(7823),a=i(4481),l=i(4762),g=i(4426),d=i(2340),p=i(6522),f=i(3018),b=i(5056),h=i(3897),Z=i(4441),O=i(7800);function v(e,t){if(1&e){var n=f.EpF();f.TgZ(0,"div",5),f.TgZ(1,"a",6),f.TgZ(2,"div",7),f.TgZ(3,"small"),f._uU(4),f.ALo(5,"date"),f.qZA(),f.TgZ(6,"small"),f._UZ(7,"i",8),f._uU(8),f.qZA(),f.qZA(),f.TgZ(9,"h4",9),f._uU(10),f._UZ(11,"ion-icon",10),f._uU(12),f.qZA(),f.TgZ(13,"h5",9),f._uU(14),f.qZA(),f._UZ(15,"hr"),f.TgZ(16,"div",11),f.TgZ(17,"p"),f._uU(18),f.qZA(),f._UZ(19,"br"),f.qZA(),f.TgZ(20,"div",11),f.TgZ(21,"p"),f._UZ(22,"ion-icon",12),f._uU(23),f.qZA(),f.qZA(),f.TgZ(24,"div",7),f.TgZ(25,"button",13),f.NdJ("click",function(){f.CHM(n);var e=t.$implicit;return f.oxw().cancelOrder(e)}),f._uU(26),f.ALo(27,"translate"),f.qZA(),f.TgZ(28,"button",14),f.NdJ("click",function(){f.CHM(n);var e=t.$implicit;return f.oxw().acceptByUser(e.id)}),f._uU(29),f.ALo(30,"translate"),f.qZA(),f.TgZ(31,"button",15),f.NdJ("click",function(){f.CHM(n);var e=t.$implicit;return f.oxw().callToUser(e.applicationUser.phone)}),f._uU(32),f.ALo(33,"translate"),f.qZA(),f.qZA(),f.qZA(),f.qZA()}if(2&e){var r=t.$implicit;f.xp6(4),f.Oqu(f.xi3(5,11,r.createdOn,"MM/dd/yyyy h:mm")),f.xp6(4),f.hij(" ",r.date,""),f.xp6(2),f.hij("",r.location," "),f.xp6(2),f.hij(" ",r.destination,""),f.xp6(2),f.hij("",r.totalPrice," BGN"),f.xp6(4),f.Oqu(r.info),f.xp6(5),f.AsE(" ",r.applicationUser.firstName," ",r.applicationUser.lastName," "),f.xp6(3),f.Oqu(f.lcZ(27,14,"Cancel")),f.xp6(3),f.Oqu(f.lcZ(30,16,"Accept")),f.xp6(3),f.Oqu(f.lcZ(33,18,"Call passenger"))}}function m(e,t){if(1&e){var n=f.EpF();f.TgZ(0,"div",5),f.TgZ(1,"a",6),f.TgZ(2,"div",7),f.TgZ(3,"small"),f._uU(4),f.ALo(5,"date"),f.qZA(),f.TgZ(6,"small"),f._UZ(7,"i",8),f._uU(8),f.qZA(),f.qZA(),f.TgZ(9,"h4",9),f._uU(10),f._UZ(11,"ion-icon",10),f._uU(12),f.qZA(),f.TgZ(13,"h5",9),f._uU(14),f.qZA(),f._UZ(15,"hr"),f.TgZ(16,"div",11),f.TgZ(17,"p"),f._uU(18),f.qZA(),f._UZ(19,"br"),f.qZA(),f.TgZ(20,"div",11),f.TgZ(21,"p"),f._UZ(22,"ion-icon",12),f._uU(23),f.qZA(),f.qZA(),f.TgZ(24,"div",7),f.TgZ(25,"button",15),f.NdJ("click",function(){f.CHM(n);var e=t.$implicit;return f.oxw().callToUser(e.applicationUser.phone)}),f._uU(26),f.ALo(27,"translate"),f.qZA(),f.TgZ(28,"button",14),f.NdJ("click",function(){f.CHM(n);var e=t.$implicit;return f.oxw().closeOrder(e)}),f._uU(29),f.ALo(30,"translate"),f.qZA(),f.qZA(),f.qZA(),f.qZA()}if(2&e){var r=t.$implicit;f.xp6(4),f.Oqu(f.xi3(5,10,r.createdOn,"MM/dd/yyyy h:mm")),f.xp6(4),f.hij(" ",r.date,""),f.xp6(2),f.hij("",r.location," "),f.xp6(2),f.hij(" ",r.destination,""),f.xp6(2),f.hij("",r.totalPrice," BGN"),f.xp6(4),f.Oqu(r.info),f.xp6(5),f.AsE(" ",r.applicationUser.firstName," ",r.applicationUser.lastName," "),f.xp6(3),f.Oqu(f.lcZ(27,13,"Call passenger")),f.xp6(3),f.Oqu(f.lcZ(30,15,"Finish trip"))}}var A,y=[{path:"",component:(A=function(){function n(t,r,i,o,s,c){e(this,n),this.popoverController=t,this.accountService=r,this.subOrderService=i,this.optionsService=o,this.callNumber=s,this.route=c,this.subscriptions=[],this.user=this.accountService.userValue,this.isLoggedIn=!1,this.inProgress=!1,this.subOrders=[],this.mySubOrders=[],this.progressOrders=[]}var r,i,o;return r=n,(i=[{key:"ngOnInit",value:function(){var e=this;this.user.token&&(this.isLoggedIn=!0),this.getSubOrderByStatusAccepted("Accepted"),this.getSubOrderByStatusProgress("InProgress");var t=(new g.su).configureLogging(g.in.Information).withUrl("".concat(d.N.signalRUrl,"/orderHub")).build();t.start().then(function(){console.log("signalR Connected in travelling")}).catch(function(e){return console.log(e)}),t.on("InProgressSubOrder",function(t){e.getSubOrderByStatusAccepted("Accepted"),e.getSubOrderByStatusProgress("InProgress")}),t.on("FinishSubOrder",function(t){e.getSubOrderByStatusAccepted("Accepted"),e.getSubOrderByStatusProgress("InProgress")}),t.on("OrderDeleted",function(t){e.getSubOrderByStatusAccepted("Accepted"),e.getSubOrderByStatusProgress("InProgress")}),t.on("AcceptSubOrder",function(t){e.getSubOrderByStatusAccepted("Accepted"),e.getSubOrderByStatusProgress("InProgress")})}},{key:"getSubOrderByStatusProgress",value:function(e){var t=this;this.subscriptions.push(this.subOrderService.getAllSubOrders(e).subscribe(function(e){null!=e&&(console.log(e,"Progress"),t.progressOrders=e.filter(function(e){return e.acceptedBy==t.accountService.userValue.id}),t.progressOrders.forEach(function(e){t.optionsService.getOptionById(e.optionsId).subscribe(function(t){var n=t;e.location=n.location,e.destination=n.destination})}))}))}},{key:"getSubOrderByStatusAccepted",value:function(e){var t=this;this.subscriptions.push(this.subOrderService.getAllSubOrders(e).subscribe(function(e){null!=e&&(console.log(e,"Accepted"),t.mySubOrders=e.filter(function(e){return e.acceptedBy==t.accountService.userValue.id}),t.mySubOrders.forEach(function(e){t.optionsService.getOptionById(e.optionsId).subscribe(function(t){var n=t;e.location=n.location,e.destination=n.destination})}))}))}},{key:"acceptByUser",value:function(e){var t=this;this.subscriptions.push(this.subOrderService.inProgressSubOrders(e).subscribe(function(e){e&&t.getSubOrderByStatusProgress("InProgress")}))}},{key:"cancelOrder",value:function(e){var t=this;this.subscriptions.push(this.subOrderService.refuseSubOrder(e.id).subscribe(function(e){e&&t.route.navigate(["menu/categories"])}))}},{key:"closeOrder",value:function(e){var t=this;this.subscriptions.push(this.subOrderService.closedSubOrder(e.id).subscribe(function(n){n&&t.subOrderService.deleteOrder(e.id).subscribe(function(e){})}))}},{key:"callToUser",value:function(e){var t=e.toString();this.callNumber.callNumber(t,!0).then(function(e){return console.log("Launched dialer!",e)}).catch(function(e){return console.log("Error launching dialer",e)})}},{key:"openLanguagePopover",value:function(e){return(0,l.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.popoverController.create({component:p.m,event:e});case 2:return n=t.sent,t.next=5,n.present();case 5:case"end":return t.stop()}},t,this)}))}}])&&t(r.prototype,i),o&&t(r,o),n}(),A.\u0275fac=function(e){return new(e||A)(f.Y36(u.Dh),f.Y36(b.B),f.Y36(h.g),f.Y36(Z.I),f.Y36(c.X),f.Y36(a.F0))},A.\u0275cmp=f.Xpm({type:A,selectors:[["app-reservations"]],decls:14,vars:5,consts:[["slot","start"],["slot","end"],["id","toolbarIcon","name","language-outline",3,"click"],[1,"col-md-10"],["id","orderDiv","class","list-group mt-2",4,"ngFor","ngForOf"],["id","orderDiv",1,"list-group","mt-2"],[1,"text","list-group-item","list-group-item-action","flex-column","align-items-start"],[1,"d-flex","w-100","justify-content-between"],[1,"fa","fa-calendar"],[1,"mt-1","text-center"],["name","arrow-forward-outline",1,"mr-2"],[1,"row","pl-3"],["name","person"],["type","button",1,"fonted","btn","btn-danger",3,"click"],["type","button",1,"fonted","btn","btn-info",3,"click"],["type","button",1,"fonted","btn","btn-warning",3,"click"]],template:function(e,t){1&e&&(f.TgZ(0,"ion-header"),f.TgZ(1,"ion-toolbar"),f.TgZ(2,"ion-buttons",0),f._UZ(3,"ion-menu-button"),f.qZA(),f.TgZ(4,"ion-title"),f.TgZ(5,"ion-label"),f._uU(6),f.ALo(7,"translate"),f.qZA(),f.qZA(),f.TgZ(8,"ion-buttons",1),f.TgZ(9,"ion-icon",2),f.NdJ("click",function(e){return t.openLanguagePopover(e)}),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(10,"ion-content"),f.TgZ(11,"div",3),f.YNc(12,v,34,20,"div",4),f.YNc(13,m,31,17,"div",4),f.qZA(),f.qZA()),2&e&&(f.xp6(6),f.Oqu(f.lcZ(7,3,"Reservations")),f.xp6(6),f.Q6J("ngForOf",t.mySubOrders),f.xp6(1),f.Q6J("ngForOf",t.progressOrders))},directives:[u.Gu,u.sr,u.Sm,u.fG,u.wd,u.Q$,u.gu,u.W2,o.sg],pipes:[O.X$,o.uU],styles:["ion-content[_ngcontent-%COMP%]{--ion-background-color:#e9e9e9}ion-toolbar[_ngcontent-%COMP%]{--ion-background-color:#eee}#map[_ngcontent-%COMP%]{height:100%;width:100%}ion-title[_ngcontent-%COMP%]{text-align:center}h5[_ngcontent-%COMP%]{font-size:.9em}#toolbarIcon[_ngcontent-%COMP%]{font-size:1.7em}.fonted[_ngcontent-%COMP%]{font-family:Open Sans Light}.centered[_ngcontent-%COMP%]{text-align:center}.text[_ngcontent-%COMP%]{font-family:Open Sans Light}hr[_ngcontent-%COMP%]{background:#eee;width:70%!important}.blink_me[_ngcontent-%COMP%]{-webkit-animation:blinker 1s linear infinite;animation:blinker 1s linear infinite}@-webkit-keyframes blinker{50%{opacity:0}}@keyframes blinker{50%{opacity:0}}.msg-box[_ngcontent-%COMP%]{width:100%;height:140px;padding:10px 30px;font-size:14px;font-family:Open Sans Light;overflow:auto}.msg-box[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:-5px;list-style:none}.msg-box[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   .ex-msg[_ngcontent-%COMP%]{text-align:right}.msg-box[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   .in-msg[_ngcontent-%COMP%]{text-align:left;margin-left:-60px}"]}),A)}],S=function(){var t=function t(){e(this,t)};return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=f.oAB({type:t}),t.\u0275inj=f.cJS({imports:[[a.Bz.forChild(y)],a.Bz]}),t}(),x=i(1841),_=i(2472),q=i(3577);function P(e){return new _.w(e)}var U,T=((U=function t(){e(this,t)}).\u0275fac=function(e){return new(e||U)},U.\u0275mod=f.oAB({type:U}),U.\u0275inj=f.cJS({providers:[c.X],imports:[[o.ez,s.u5,u.Pc,S,O.aw.forChild({loader:{provide:O.Zw,useFactory:P,deps:[x.eN]}}),q.LanguagePopoverPageModule]]}),U)}}])}();