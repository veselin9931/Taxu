(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{vqOf:function(e,t,o){"use strict";o.r(t),o.d(t,"HttpLoaderFactory",function(){return w}),o.d(t,"CarRegisterPageModule",function(){return S});var i=o("ofXK"),r=o("3Pt+"),n=o("TEn/"),c=o("tyNb"),b=o("mrSG"),s=o("tk/3"),a=o("Gpoy"),l=o("AytR"),u=o("oXKM"),d=o("fXoL"),p=o("exMm"),f=o("8Xdb"),m=o("Jhu6"),g=o("sYmb");function h(e,t){1&e&&(d.Nb(0,"div"),d.pc(1),d.Yb(2,"translate"),d.Mb()),2&e&&(d.zb(1),d.rc("",d.Zb(2,1,"The field is required"),"!"))}function v(e,t){if(1&e&&(d.Nb(0,"div",35),d.oc(1,h,3,3,"div",36),d.Mb()),2&e){const e=d.Xb();d.zb(1),d.dc("ngIf",e.f.model.errors.required)}}function M(e,t){1&e&&(d.Nb(0,"div"),d.pc(1),d.Yb(2,"translate"),d.Mb()),2&e&&(d.zb(1),d.rc("",d.Zb(2,1,"The field is required"),"!"))}function N(e,t){if(1&e&&(d.Nb(0,"div",35),d.oc(1,M,3,3,"div",36),d.Mb()),2&e){const e=d.Xb();d.zb(1),d.dc("ngIf",e.f.color.errors.required)}}function C(e,t){1&e&&(d.Nb(0,"div"),d.pc(1),d.Yb(2,"translate"),d.Mb()),2&e&&(d.zb(1),d.rc("",d.Zb(2,1,"The field is required"),"!"))}function y(e,t){if(1&e&&(d.Nb(0,"div",35),d.oc(1,C,3,3,"div",36),d.Mb()),2&e){const e=d.Xb();d.zb(1),d.dc("ngIf",e.f.capacity.errors.required)}}function k(e,t){1&e&&(d.Nb(0,"div"),d.pc(1),d.Yb(2,"translate"),d.Mb()),2&e&&(d.zb(1),d.rc("",d.Zb(2,1,"The field is required"),"!"))}function I(e,t){if(1&e&&(d.Nb(0,"div",35),d.oc(1,k,3,3,"div",36),d.Mb()),2&e){const e=d.Xb();d.zb(1),d.dc("ngIf",e.f.registrationNumber.errors.required)}}function z(e,t){if(1&e){const e=d.Ob();d.Nb(0,"ion-item"),d.Nb(1,"a",37),d.Nb(2,"p"),d.Lb(3,"img",38),d.Mb(),d.Nb(4,"div",39),d.Lb(5,"h5",40),d.Nb(6,"button",41),d.Vb("click",function(){d.jc(e);const o=t.$implicit;return d.Xb().removePicture(o.id)}),d.pc(7),d.Yb(8,"translate"),d.Mb(),d.Mb(),d.Mb(),d.Mb()}if(2&e){const e=t.$implicit;d.zb(3),d.ec("src",e.path,d.lc),d.zb(4),d.rc(" ",d.Zb(8,2,"Delete"),"")}}const O=function(e){return{"is-invalid":e}},P=[{path:"",component:(()=>{class e{constructor(e,t,o,i,r,n,c,b,s){this.route=e,this.formBuilder=t,this.driverService=o,this.accountService=i,this.location=r,this.imageService=n,this.alertController=c,this.popoverController=b,this.translate=s,this.submitted=!1,this.loading=!1,this.folderName="driverFacePic",this.imgType="carImg",this.translate.setDefaultLang(this.accountService.userValue.choosenLanguage),this.userId=this.accountService.userValue.id}ngOnInit(){this.getDocs(),this.form=this.formBuilder.group({model:["",r.n.required],registrationNumber:["",r.n.required],color:["",r.n.required],capacity:["",r.n.required],driverId:[""],type:[""]});const e=(new a.b).configureLogging(a.c.Information).withUrl(`${l.a.signalRUrl}/orderHub`).build();e.start().then(function(){console.log("signalR Connected in menu")}).catch(function(t){console.log("Reconnecting in 1 sec."),setTimeout(()=>e.start(),1e3)}),e.on("OnUpload",e=>{this.getDocs()})}ionViewDidEnter(){this.clearCarImages()}get f(){return this.form.controls}getDocs(){this.imageService.getUserCarPictures(this.userId).subscribe(e=>{this.pics=e,console.log(this.pics)})}removePicture(e){this.picDelete(e)}clearCarImages(){this.imageService.getUserCarPictures(this.userId).subscribe(e=>{this.pics=e,this.pics.length>0&&this.pics.forEach(e=>{this.imageService.removeDocument(e.id).subscribe(e=>{console.log("Image removed sucessfully")})})})}onSubmit(){this.submitted=!0,this.form.valid&&(4!=this.pics.length?this.notEnoughImages():this.accountService.getById(this.userId).subscribe(e=>{this.form.value.driverId=e.driverId,this.form.value.type=+this.form.value.type,this.driverService.createCar(this.form.value).subscribe(t=>{this.clearForm(),this.driverService.getDriverCars(e.driverId).subscribe(e=>{this.route.navigateByUrl("menu/verifying")})})}))}upload(e){if(0===e.length)return;let t=e[0];const o=new FormData;o.append("file",t,t.name),this.imageService.upload(o,this.folderName,this.userId,this.imgType).subscribe(e=>{switch(e.type===s.c.UploadProgress?this.progress=Math.round(100*e.loaded/e.total):e.type===s.c.Response&&(this.message="Documents uploaded successfully."),e.type){case s.c.Sent:console.log("Request has been made!");break;case s.c.ResponseHeader:console.log("Response header has been received!");break;case s.c.UploadProgress:this.progress=Math.round(e.loaded/e.total*100);break;case s.c.Response:setTimeout(()=>{this.progress=0},1500)}})}goBack(){this.location.back()}openLanguagePopover(e){return Object(b.a)(this,void 0,void 0,function*(){const t=yield this.popoverController.create({component:u.a,event:e});yield t.present()})}notEnoughImages(){return Object(b.a)(this,void 0,void 0,function*(){this.translate.get(["You have to upload 4 document pictures."]).subscribe(e=>Object(b.a)(this,void 0,void 0,function*(){const t=yield this.alertController.create({header:e["You have to upload 4 document pictures."],buttons:[{text:"Ok",role:"Ok"}]});yield t.present()}))})}picDelete(e){return Object(b.a)(this,void 0,void 0,function*(){this.translate.get(["Delete the picture?","Yes","No"]).subscribe(t=>Object(b.a)(this,void 0,void 0,function*(){const o=yield this.alertController.create({header:t["Delete the picture?"],buttons:[{text:t.Yes,handler:()=>{this.imageService.removeDocument(e).subscribe(e=>{console.log("Image removed sucessfully")})}},{text:t.No,role:"no"}]});yield o.present()}))})}clearForm(){this.form.reset({model:"",tehnicalReview:"",registrationNumber:"",color:"",capacity:""})}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(c.f),d.Kb(r.b),d.Kb(p.a),d.Kb(f.a),d.Kb(i.h),d.Kb(m.a),d.Kb(n.a),d.Kb(n.H),d.Kb(g.d))},e.\u0275cmp=d.Eb({type:e,selectors:[["app-car-register"]],decls:97,vars:60,consts:[["slot","start"],["slot","end"],["id","toolbarIcon","name","language-outline",3,"click"],["padding","",1,"background"],[1,"row","mt-2"],[1,"col"],[1,"row"],[1,"col","text-center"],["color","dark",1,"centered"],[1,"text"],["novalidate","",1,"col-md-6","mt-1",3,"formGroup"],[1,"form-group","col","text-center"],["formControlName","model","type","text",1,"form-control",3,"placeholder","ngClass"],["class","invalid-feedback",4,"ngIf"],["formControlName","type","id","exampleFormControlSelect1",1,"form-control"],["value","","disabled","","selected","","hidden",""],["value","1"],["value","2"],["formControlName","color","type","text",1,"form-control",3,"placeholder","ngClass"],["formControlName","capacity","type","number",1,"form-control",3,"placeholder","ngClass"],["formControlName","registrationNumber","type","text",1,"form-control",3,"placeholder","ngClass"],[1,"text","mb-3"],[1,"input-group","text-left"],[1,"input-group","mb-1"],["type","text",1,"form-control"],[1,"input-group-append"],["type","file","placeholder","Choose file",2,"display","none",3,"change"],["file1",""],["name","add-outline","color","dark",3,"click"],["file2",""],["file3",""],["file4",""],[4,"ngFor","ngForOf"],[1,"col-md-12","mt-3"],["type","submit",1,"btn","btn-info",3,"click"],[1,"invalid-feedback"],[4,"ngIf"],[1,"text","list-group-item","list-group-item-action","flex-column","align-items-start"],[3,"src"],[1,"text-center"],[1,"mb-1","fonted"],[1,"btn","btn-danger",3,"click"]],template:function(e,t){if(1&e){const e=d.Ob();d.Nb(0,"ion-header"),d.Nb(1,"ion-toolbar"),d.Nb(2,"ion-buttons",0),d.Lb(3,"ion-menu-button"),d.Mb(),d.Nb(4,"ion-title"),d.Nb(5,"ion-label"),d.pc(6,"Cyber"),d.Mb(),d.Mb(),d.Nb(7,"ion-buttons",1),d.Nb(8,"ion-icon",2),d.Vb("click",function(e){return t.openLanguagePopover(e)}),d.Mb(),d.Mb(),d.Mb(),d.Mb(),d.Nb(9,"ion-content",3),d.Nb(10,"div",4),d.Nb(11,"div",5),d.Nb(12,"div",6),d.Nb(13,"div",7),d.Nb(14,"ion-text",8),d.Nb(15,"h3",9),d.pc(16),d.Yb(17,"translate"),d.Mb(),d.Lb(18,"hr"),d.Mb(),d.Nb(19,"form",10),d.Nb(20,"div",11),d.Lb(21,"ion-input",12),d.Yb(22,"translate"),d.oc(23,v,2,1,"div",13),d.Mb(),d.Nb(24,"div",11),d.Nb(25,"select",14),d.Nb(26,"option",15),d.pc(27),d.Yb(28,"translate"),d.Mb(),d.Nb(29,"option",16),d.pc(30),d.Yb(31,"translate"),d.Mb(),d.Nb(32,"option",17),d.pc(33),d.Yb(34,"translate"),d.Mb(),d.Mb(),d.Mb(),d.Nb(35,"div",11),d.Lb(36,"ion-input",18),d.Yb(37,"translate"),d.oc(38,N,2,1,"div",13),d.Mb(),d.Nb(39,"div",11),d.Lb(40,"ion-input",19),d.Yb(41,"translate"),d.oc(42,y,2,1,"div",13),d.Mb(),d.Nb(43,"div",11),d.Lb(44,"ion-input",20),d.Yb(45,"translate"),d.oc(46,I,2,1,"div",13),d.Mb(),d.Nb(47,"h5",21),d.pc(48),d.Yb(49,"translate"),d.Mb(),d.Nb(50,"div",22),d.Nb(51,"div",23),d.Nb(52,"label",24),d.pc(53),d.Yb(54,"translate"),d.Mb(),d.Nb(55,"div",25),d.Nb(56,"span"),d.Nb(57,"input",26,27),d.Vb("change",function(){d.jc(e);const o=d.ic(58);return t.upload(o.files)}),d.Mb(),d.Nb(59,"label"),d.Nb(60,"ion-icon",28),d.Vb("click",function(){return d.jc(e),d.ic(58).click()}),d.Mb(),d.Mb(),d.Mb(),d.Mb(),d.Mb(),d.Nb(61,"div",23),d.Nb(62,"label",24),d.pc(63),d.Yb(64,"translate"),d.Mb(),d.Nb(65,"div",25),d.Nb(66,"span"),d.Nb(67,"input",26,29),d.Vb("change",function(){d.jc(e);const o=d.ic(68);return t.upload(o.files)}),d.Mb(),d.Nb(69,"label"),d.Nb(70,"ion-icon",28),d.Vb("click",function(){return d.jc(e),d.ic(68).click()}),d.Mb(),d.Mb(),d.Mb(),d.Mb(),d.Mb(),d.Nb(71,"div",23),d.Nb(72,"label",24),d.pc(73),d.Yb(74,"translate"),d.Mb(),d.Nb(75,"div",25),d.Nb(76,"span"),d.Nb(77,"input",26,30),d.Vb("change",function(){d.jc(e);const o=d.ic(78);return t.upload(o.files)}),d.Mb(),d.Nb(79,"label"),d.Nb(80,"ion-icon",28),d.Vb("click",function(){return d.jc(e),d.ic(78).click()}),d.Mb(),d.Mb(),d.Mb(),d.Mb(),d.Mb(),d.Nb(81,"div",23),d.Nb(82,"label",24),d.pc(83),d.Yb(84,"translate"),d.Mb(),d.Nb(85,"div",25),d.Nb(86,"span"),d.Nb(87,"input",26,31),d.Vb("change",function(){d.jc(e);const o=d.ic(88);return t.upload(o.files)}),d.Mb(),d.Nb(89,"label"),d.Nb(90,"ion-icon",28),d.Vb("click",function(){return d.jc(e),d.ic(88).click()}),d.Mb(),d.Mb(),d.Mb(),d.Mb(),d.Mb(),d.Mb(),d.Nb(91,"ion-list"),d.oc(92,z,9,4,"ion-item",32),d.Mb(),d.Nb(93,"div",33),d.Nb(94,"button",34),d.Vb("click",function(){return t.onSubmit()}),d.pc(95),d.Yb(96,"translate"),d.Mb(),d.Mb(),d.Mb(),d.Mb(),d.Mb(),d.Mb(),d.Mb(),d.Mb()}2&e&&(d.zb(16),d.qc(d.Zb(17,24,"Car information")),d.zb(3),d.dc("formGroup",t.form),d.zb(2),d.dc("placeholder",d.Zb(22,26,"Model"))("ngClass",d.gc(52,O,t.submitted&&t.f.model.errors)),d.zb(2),d.dc("ngIf",t.submitted&&t.f.model.errors),d.zb(4),d.qc(d.Zb(28,28,"Click to choose car type")),d.zb(3),d.qc(d.Zb(31,30,"Normal")),d.zb(3),d.qc(d.Zb(34,32,"Comfort")),d.zb(3),d.dc("placeholder",d.Zb(37,34,"Color"))("ngClass",d.gc(54,O,t.submitted&&t.f.color.errors)),d.zb(2),d.dc("ngIf",t.submitted&&t.f.color.errors),d.zb(2),d.dc("placeholder",d.Zb(41,36,"Capacity"))("ngClass",d.gc(56,O,t.submitted&&t.f.capacity.errors)),d.zb(2),d.dc("ngIf",t.submitted&&t.f.capacity.errors),d.zb(2),d.dc("placeholder",d.Zb(45,38,"Registration Number"))("ngClass",d.gc(58,O,t.submitted&&t.f.registrationNumber.errors)),d.zb(2),d.dc("ngIf",t.submitted&&t.f.registrationNumber.errors),d.zb(2),d.rc("",d.Zb(49,40,"Please upload pictures of the following documents"),":"),d.zb(5),d.rc("1. ",d.Zb(54,42,"Front car picture"),""),d.zb(10),d.rc("2. ",d.Zb(64,44,"Rear car picture"),""),d.zb(10),d.rc("3. ",d.Zb(74,46,"Car insurance picture"),""),d.zb(10),d.rc("4. ",d.Zb(84,48,"Technical review picture"),""),d.zb(9),d.dc("ngForOf",t.pics),d.zb(3),d.qc(d.Zb(96,50,"Submit")))},directives:[n.l,n.B,n.e,n.s,n.A,n.p,n.m,n.i,n.z,r.o,r.i,r.d,n.n,n.K,r.h,r.c,i.j,i.l,r.m,r.k,r.p,n.F,n.q,i.k,n.o],pipes:[g.c],styles:["ion-content[_ngcontent-%COMP%]{--ion-background-color:#e9e9e9}ion-toolbar[_ngcontent-%COMP%]{--ion-background-color:#eee}ion-title[_ngcontent-%COMP%]{text-align:center}#toolbarIcon[_ngcontent-%COMP%]{font-size:1.7em}.text[_ngcontent-%COMP%]{font-family:Open Sans Light}.centered[_ngcontent-%COMP%]{text-align:center}hr[_ngcontent-%COMP%]{width:70%!important}label[_ngcontent-%COMP%]{border:1px solid #ccc;padding:8px 15px;cursor:pointer}.backIcon[_ngcontent-%COMP%]{font-size:150%}.back[_ngcontent-%COMP%], .backIcon[_ngcontent-%COMP%]{color:#ffae00}"]}),e})()}];let x=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.Ib({type:e}),e.\u0275inj=d.Hb({imports:[[c.h.forChild(P)],c.h]}),e})();var Y=o("mqiu"),q=o("QhVT");function w(e){return new Y.a(e)}let S=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.Ib({type:e}),e.\u0275inj=d.Hb({imports:[[i.b,r.e,n.C,x,r.l,g.b.forChild({loader:{provide:g.a,useFactory:w,deps:[s.a]}}),q.LanguagePopoverPageModule]]}),e})()}}]);