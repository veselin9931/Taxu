{"version":3,"sources":["./src/app/driver-history/driver-history.page.html","./src/app/driver-history/driver-history.page.ts","./src/app/driver-history/driver-history.page.scss","./src/app/driver-history/driver-history.module.ts","./src/app/driver-history/driver-history-routing.module.ts"],"names":[],"mappings":"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","file":"driver-history-driver-history-module-es2015.js","sourcesContent":["export default \"<ion-header>\\r\\n  <ion-toolbar>\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <ion-menu-button></ion-menu-button>\\r\\n    </ion-buttons>\\r\\n\\r\\n    <ion-title>\\r\\n        <ion-label>Cyber</ion-label>\\r\\n    </ion-title>\\r\\n\\r\\n    <ion-buttons slot=\\\"end\\\">\\r\\n      <ion-icon (click)='openLanguagePopover($event)' id=\\\"toolbarIcon\\\" name=\\\"language-outline\\\"></ion-icon>\\r\\n\\r\\n    </ion-buttons>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n<ion-content padding class=\\\"background\\\">\\r\\n  <div class=\\\"row mt-2\\\">\\r\\n    <div class=\\\"col\\\">\\r\\n      <div class=\\\"row\\\">\\r\\n        <div class=\\\"col-md-12 text-center\\\">\\r\\n          <ion-text class=\\\"centered\\\">\\r\\n            <h2 class=\\\"text\\\">{{'My history' | translate}}</h2>\\r\\n            <hr>\\r\\n          </ion-text>\\r\\n        </div>\\r\\n        <div class=\\\"col-md-10\\\">\\r\\n        <div class=\\\"list-group mt-2\\\">\\r\\n\\r\\n          <a class=\\\"text list-group-item list-group-item-action flex-column align-items-start\\\">\\r\\n            <div class=\\\"d-flex w-100 justify-content-between\\\">\\r\\n              <h5 class=\\\"text mb-1\\\">{{'Daily earnings' | translate}}</h5>\\r\\n              <small>{{'Today' | translate}}: {{currentDate |  date:'MM/dd/yyyy h:mm'}}</small>\\r\\n\\r\\n            </div>\\r\\n\\r\\n            <div class=\\\"row\\\">\\r\\n              <div class=\\\"col-md-12 text-center\\\">\\r\\n                <h5 class=\\\"text\\\">{{'Total' | translate}}: {{dailyProfit}} лв.</h5>\\r\\n              </div>\\r\\n            </div>\\r\\n          </a>\\r\\n        </div>\\r\\n      </div>\\r\\n        <div class=\\\"col-md-10\\\">\\r\\n          <div *ngFor=\\\"let order of orders\\\" class=\\\"list-group mt-2\\\">\\r\\n\\r\\n            <a class=\\\"text list-group-item list-group-item-action flex-column align-items-start\\\">\\r\\n              <div class=\\\"d-flex w-100 justify-content-between\\\">\\r\\n                <h5 class=\\\"text mb-1\\\">{{'Order details' | translate}}</h5>\\r\\n                <small>{{order.createdOn |  date:'MM/dd/yyyy h:mm'}}</small>\\r\\n              </div>\\r\\n              <p class=\\\"mb-1 text\\\">{{'Passenger' | translate}}: {{order.applicationUser.firstName}} {{order.applicationUser.lastName}}</p>\\r\\n              <p class=\\\"mb-1 text\\\">{{'Phone number' | translate}}: {{order.applicationUser.phone}}</p>\\r\\n              <p class=\\\"mb-1 text\\\">{{'Location' | translate}}: {{order.location}}</p>\\r\\n              <p class=\\\"mb-1 text\\\">{{'Destination' | translate}}: {{order.destination}}</p>\\r\\n\\r\\n              <div class=\\\"row\\\">\\r\\n                <div class=\\\"col-md-12\\\">\\r\\n                  <small class=\\\"text\\\">{{'Profit' | translate}}: {{order.totalPrice}} лв.</small>\\r\\n                </div>\\r\\n              </div>\\r\\n            </a>\\r\\n          </div>\\r\\n        </div>\\r\\n      </div>\\r\\n    </div>\\r\\n  </div>\\r\\n\\r\\n\\r\\n</ion-content>\";","import { Component, OnInit } from '@angular/core';\r\nimport { Order, User } from 'src/_models';\r\nimport { AccountService } from 'src/_services';\r\nimport { DriverService } from 'src/_services/driver/driver.service';\r\nimport * as signalR from '@aspnet/signalr';\r\nimport { environment } from 'src/environments/environment';\r\nimport { Subscription } from 'rxjs';\r\nimport { PopoverController } from '@ionic/angular';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { LanguagePopoverPage } from '../language-popover/language-popover.page';\r\n@Component({\r\n  selector: 'app-driver-history',\r\n  templateUrl: './driver-history.page.html',\r\n  styleUrls: ['./driver-history.page.scss'],\r\n})\r\nexport class DriverHistoryPage implements OnInit {\r\n  private subscriptions: Subscription[] = [];\r\n\r\n  orders: Order[] = [];\r\n  userId = this.accountService.userValue.id;\r\n  orderer : User;\r\n  dailyProfit: string;\r\n  currentDate = new Date();\r\n  constructor(private driverService: DriverService,\r\n    private accountService: AccountService,\r\n    private popoverController: PopoverController,\r\n    private translate: TranslateService) {\r\n    this.translate.setDefaultLang(this.accountService.userValue.choosenLanguage);\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.getHistory();\r\n\r\n    const connection = new signalR.HubConnectionBuilder()\r\n      .configureLogging(signalR.LogLevel.Information)\r\n      .withUrl(`${environment.signalRUrl}/orderHub`)\r\n      .build();\r\n\r\n    connection.start().then(function () {\r\n      console.log('signalR Connected in history');\r\n    }).catch(function (err) {\r\n      return console.log(err.toString());\r\n    });\r\n\r\n    connection.on('BroadcastMessage', () => {\r\n      this.getHistory();\r\n    });\r\n  }\r\n\r\n  ionViewDidLeave() {\r\n    for (const subscription of this.subscriptions) {\r\n      console.log(subscription)\r\n      subscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  getHistory(){\r\n    this.subscriptions.push(this.driverService.getDriverHistory(this.userId)\r\n    .subscribe((x: Order[]) => {\r\n      if(this.orders == null){\r\n        console.log(\"No orders\");\r\n        return;\r\n      }\r\n      this.orders = x;\r\n      let sum: number = 0;\r\n      x.forEach(order => {\r\n        sum += order.totalPrice;\r\n      });\r\n      this.dailyProfit = sum.toFixed(2);\r\n    }))\r\n  }\r\n\r\n  async openLanguagePopover(ev) {\r\n    const popover = await this.popoverController.create({\r\n      component: LanguagePopoverPage,\r\n      event: ev\r\n    });\r\n    await popover.present();\r\n  }\r\n  \r\n}\r\n","export default \"ion-content {\\n  --ion-background-color:#e9e9e9;\\n}\\n\\nion-toolbar {\\n  --ion-background-color:#eeeeee;\\n}\\n\\nion-title {\\n  text-align: center;\\n}\\n\\n#toolbarIcon {\\n  font-size: 1.7em;\\n}\\n\\n.text {\\n  font-family: Open Sans Light;\\n}\\n\\n.centered {\\n  text-align: center;\\n}\\n\\nhr {\\n  background: #eeeeee;\\n  width: 70% !important;\\n}\\n\\n.backIcon {\\n  color: #ffae00;\\n  font-size: 150%;\\n}\\n\\n.back {\\n  color: #ffae00;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uXFwuLlxcLi5cXGRyaXZlci1oaXN0b3J5LnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUVJLDhCQUFBO0FBQUo7O0FBSUE7RUFDSSw4QkFBQTtBQURKOztBQUlBO0VBQ0ksa0JBQUE7QUFESjs7QUFJQTtFQUNJLGdCQUFBO0FBREo7O0FBSUE7RUFDSSw0QkFBQTtBQURKOztBQUlBO0VBQ0ksa0JBQUE7QUFESjs7QUFLQTtFQUNJLG1CQUFBO0VBQ0EscUJBQUE7QUFGSjs7QUFNQTtFQUNJLGNBQUE7RUFDQSxlQUFBO0FBSEo7O0FBTUE7RUFDSSxjQUFBO0FBSEoiLCJmaWxlIjoiZHJpdmVyLWhpc3RvcnkucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiaW9uLWNvbnRlbnR7XHJcbiAgICAvLy0tYmFja2dyb3VuZDogdXJsKC4uLy4uL2Fzc2V0cy93cDQ3OTI3ODAtZGFyay1waG9uZS13YWxscGFwZXJzLmpwZykgMCAwLzEwMCUgMTAwJSBuby1yZXBlYXQ7XHJcbiAgICAtLWlvbi1iYWNrZ3JvdW5kLWNvbG9yOiNlOWU5ZTk7XHJcblxyXG59XHJcblxyXG5pb24tdG9vbGJhcntcclxuICAgIC0taW9uLWJhY2tncm91bmQtY29sb3I6I2VlZWVlZTtcclxufVxyXG5cclxuaW9uLXRpdGxlIHtcclxuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcclxufVxyXG5cclxuI3Rvb2xiYXJJY29ue1xyXG4gICAgZm9udC1zaXplOiAxLjdlbTtcclxufVxyXG5cclxuLnRleHQge1xyXG4gICAgZm9udC1mYW1pbHk6IE9wZW4gU2FucyBMaWdodDtcclxufVxyXG5cclxuLmNlbnRlcmVke1xyXG4gICAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG59XHJcblxyXG5cclxuaHJ7XHJcbiAgICBiYWNrZ3JvdW5kOiNlZWVlZWU7XHJcbiAgICB3aWR0aDogNzAlICFpbXBvcnRhbnQ7XHJcbn1cclxuXHJcblxyXG4uYmFja0ljb24ge1xyXG4gICAgY29sb3I6IHJnYigyNTUsIDE3NCwgMCk7XHJcbiAgICBmb250LXNpemU6IDE1MCU7XHJcbn1cclxuXHJcbi5iYWNrIHtcclxuICAgIGNvbG9yOiByZ2IoMjU1LCAxNzQsIDApO1xyXG59Il19 */\";","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { DriverHistoryPageRoutingModule } from './driver-history-routing.module';\r\n\r\nimport { DriverHistoryPage } from './driver-history.page';\r\nimport { HttpClient } from '@angular/common/http';\r\n\r\nimport { TranslateHttpLoader } from '@ngx-translate/http-loader';\r\nimport { LanguagePopoverPageModule } from '../language-popover/language-popover.module';\r\nimport { TranslateLoader, TranslateModule } from '@ngx-translate/core';\r\n\r\nexport function HttpLoaderFactory(http: HttpClient) {\r\n  return new TranslateHttpLoader(http);\r\n}\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    DriverHistoryPageRoutingModule,\r\n    TranslateModule.forChild({\r\n      loader: {\r\n        provide: TranslateLoader,\r\n        useFactory: HttpLoaderFactory,\r\n        deps: [HttpClient]\r\n      }\r\n    }),\r\n    LanguagePopoverPageModule\r\n  ],\r\n  declarations: [DriverHistoryPage]\r\n})\r\nexport class DriverHistoryPageModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { DriverHistoryPage } from './driver-history.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: DriverHistoryPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class DriverHistoryPageRoutingModule {}\r\n"],"sourceRoot":"webpack:///"}